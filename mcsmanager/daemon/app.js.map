{"version":3,"file":"app.js","mappings":";;;;;;;AAAa;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAe;AACf;AACA;;;;;;;ACpBa;AACb;AACA,6CAA6C;AAC7C;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,kBAAkB,GAAG,oBAAoB,GAAG,eAAe,GAAG,gBAAgB,GAAG,iBAAiB,GAAG,cAAc,GAAG,6BAA6B,GAAG,mBAAmB,GAAG,oBAAoB,GAAG,uBAAuB,GAAG,mBAAmB,GAAG,uBAAuB,GAAG,sBAAsB,GAAG,8BAA8B,GAAG,sBAAsB,GAAG,wBAAwB,GAAG,sBAAsB,GAAG,mBAAmB;AACva,yCAAyC,mBAAO,CAAC,kCAAkB;AACnE,wBAAwB;AACxB,0CAA0C,mBAAO,CAAC,mCAAmB;AACrE,sBAAsB;AACtB,0CAA0C,mBAAO,CAAC,mCAAmB;AACrE,8BAA8B;AAC9B,wBAAwB,mBAAO,CAAC,iCAAiB;AACjD,kDAAiD,EAAE,qCAAqC,0CAA0C,EAAC;AACnI,+CAA8C,EAAE,qCAAqC,uCAAuC,EAAC;AAC7H,sBAAsB,mBAAO,CAAC,+BAAe;AAC7C,8CAA6C,EAAE,qCAAqC,oCAAoC,EAAC;AACzH,iCAAiC,mBAAO,CAAC,0BAAU;AACnD,sBAAsB;AACtB,wBAAwB,mBAAO,CAAC,iCAAiB;AACjD,mDAAkD,EAAE,qCAAqC,2CAA2C,EAAC;AACrI,+CAA8C,EAAE,qCAAqC,uCAAuC,EAAC;AAC7H,mDAAkD,EAAE,qCAAqC,2CAA2C,EAAC;AACrI,gDAA+C,EAAE,qCAAqC,wCAAwC,EAAC;AAC/H,oBAAoB,mBAAO,CAAC,6BAAa;AACzC,yDAAwD,EAAE,qCAAqC,6CAA6C,EAAC;AAC7I,0CAAyC,EAAE,qCAAqC,8BAA8B,EAAC;AAC/G,6CAA4C,EAAE,qCAAqC,iCAAiC,EAAC;AACrH,4CAA2C,EAAE,qCAAqC,gCAAgC,EAAC;AACnH,2CAA0C,EAAE,qCAAqC,+BAA+B,EAAC;AACjH,gDAA+C,EAAE,qCAAqC,oCAAoC,EAAC;AAC3H,qBAAqB,mBAAO,CAAC,gCAAgB;AAC7C,+CAA8C,EAAE,qCAAqC,sCAAsC,EAAC;AAC5H;;;;;;;ACjCa;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,WAAW;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,cAAc;AAC3D;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAe;AACf;;;;;;;ACpDa;AACb;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,8BAA8B,mBAAO,CAAC,KAAK;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,kBAAe;AACf;;;;;;;ACzEa;AACb;AACA,6CAA6C;AAC7C;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,mBAAmB,GAAG,sBAAsB,GAAG,kBAAkB;AACjE,wBAAwB,mBAAO,CAAC,eAAe;AAC/C,6BAA6B,mBAAO,CAAC,IAAI;AACzC,wCAAwC,mBAAO,CAAC,eAAe;AAC/D,+BAA+B,mBAAO,CAAC,MAAM;AAC7C,iCAAiC,mBAAO,CAAC,QAAQ;AACjD,qCAAqC,mBAAO,CAAC,YAAY;AACzD;AACA;AACA,kBAAkB;AAClB;AACA,yEAAyE;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA,2DAA2D,KAAK;AAChE;AACA;AACA;AACA,uDAAuD,IAAI;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;;;;;;;AC/Ia;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,oBAAoB,GAAG,uBAAuB,GAAG,mBAAmB,GAAG,uBAAuB;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;;;;;;;ACnHa;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;;;;;;;ACZa;AACb;AACA,6CAA6C;AAC7C;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,kBAAkB;AAClB,6BAA6B,mBAAO,CAAC,IAAI;AACzC,mCAAmC,mBAAO,CAAC,UAAU;AACrD,6BAA6B,mBAAO,CAAC,IAAI;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,mBAAmB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;;;;;;;AClFa;AACb;AACA,6CAA6C;AAC7C;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,+BAA+B,mBAAO,CAAC,MAAM;AAC7C,mCAAmC,mBAAO,CAAC,UAAU;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,mBAAmB;AAChF;AACA;AACA;AACA,6DAA6D,mBAAmB;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,MAAM;AAC1C,yDAAyD,KAAK;AAC9D;AACA,2DAA2D,mBAAmB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,MAAM;AAC1C,yDAAyD,KAAK;AAC9D;AACA;AACA,iEAAiE,mBAAmB;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,sFAAsF,KAAK;AAC3F;AACA;AACA;AACA;AACA;AACA,kBAAe;AACf;AACA;AACA;;;;;;;ACpHa;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,oBAAoB,GAAG,eAAe,GAAG,iBAAiB,GAAG,gBAAgB,GAAG,cAAc,GAAG,6BAA6B;AAC9H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oGAAoG,SAAS;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1EA,6CAA+B;AAC/B,4DAAwB;AACxB,oEAA0B;AAC1B,mGAAuD;AACvD,4EAA2D;AAC3D,0DAAqC;AACrC,kEAAmE;AACnE,+DAAsD;AACtD,qDAA2C;AAC3C,sDAAiD;AACjD,2EAAmC;AACnC,sDAAoD;AACpD,4EAA2C;AAC3C,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","sources":["webpack://mcsmanager-daemon/../common/dist/global_variable.js","webpack://mcsmanager-daemon/../common/dist/index.js","webpack://mcsmanager-daemon/../common/dist/instance_stream.js","webpack://mcsmanager-daemon/../common/dist/mcping.js","webpack://mcsmanager-daemon/../common/dist/process_tools.js","webpack://mcsmanager-daemon/../common/dist/query_wrapper.js","webpack://mcsmanager-daemon/../common/dist/string_utils.js","webpack://mcsmanager-daemon/../common/dist/system_info.js","webpack://mcsmanager-daemon/../common/dist/system_storage.js","webpack://mcsmanager-daemon/../common/dist/typecheck.js","webpack://mcsmanager-daemon/./src/app.ts","webpack://mcsmanager-daemon/./src/common/compress.ts","webpack://mcsmanager-daemon/./src/common/system_storage.ts","webpack://mcsmanager-daemon/./src/const.ts","webpack://mcsmanager-daemon/./src/entity/commands/base/command.ts","webpack://mcsmanager-daemon/./src/entity/commands/base/command_parser.ts","webpack://mcsmanager-daemon/./src/entity/commands/cmd.ts","webpack://mcsmanager-daemon/./src/entity/commands/dispatcher.ts","webpack://mcsmanager-daemon/./src/entity/commands/docker/docker_pty_resize.ts","webpack://mcsmanager-daemon/./src/entity/commands/docker/docker_pull.ts","webpack://mcsmanager-daemon/./src/entity/commands/docker/docker_start.ts","webpack://mcsmanager-daemon/./src/entity/commands/general/general_command.ts","webpack://mcsmanager-daemon/./src/entity/commands/general/general_install.ts","webpack://mcsmanager-daemon/./src/entity/commands/general/general_kill.ts","webpack://mcsmanager-daemon/./src/entity/commands/general/general_restart.ts","webpack://mcsmanager-daemon/./src/entity/commands/general/general_start.ts","webpack://mcsmanager-daemon/./src/entity/commands/general/general_stop.ts","webpack://mcsmanager-daemon/./src/entity/commands/general/general_update.ts","webpack://mcsmanager-daemon/./src/entity/commands/kill.ts","webpack://mcsmanager-daemon/./src/entity/commands/nullfunc.ts","webpack://mcsmanager-daemon/./src/entity/commands/process_info.ts","webpack://mcsmanager-daemon/./src/entity/commands/pty/pty_resize.ts","webpack://mcsmanager-daemon/./src/entity/commands/pty/pty_start.ts","webpack://mcsmanager-daemon/./src/entity/commands/pty/pty_stop.ts","webpack://mcsmanager-daemon/./src/entity/commands/restart.ts","webpack://mcsmanager-daemon/./src/entity/commands/start.ts","webpack://mcsmanager-daemon/./src/entity/commands/steam/rcon_command.ts","webpack://mcsmanager-daemon/./src/entity/commands/stop.ts","webpack://mcsmanager-daemon/./src/entity/commands/task/openfrp.ts","webpack://mcsmanager-daemon/./src/entity/commands/task/time.ts","webpack://mcsmanager-daemon/./src/entity/config.ts","webpack://mcsmanager-daemon/./src/entity/ctx.ts","webpack://mcsmanager-daemon/./src/entity/instance/Instance_config.ts","webpack://mcsmanager-daemon/./src/entity/instance/instance.ts","webpack://mcsmanager-daemon/./src/entity/instance/life_cycle.ts","webpack://mcsmanager-daemon/./src/entity/instance/preset.ts","webpack://mcsmanager-daemon/./src/entity/instance/process_config.ts","webpack://mcsmanager-daemon/./src/i18n/index.ts","webpack://mcsmanager-daemon/./src/routers/Instance_router.ts","webpack://mcsmanager-daemon/./src/routers/auth_router.ts","webpack://mcsmanager-daemon/./src/routers/environment_router.ts","webpack://mcsmanager-daemon/./src/routers/file_router.ts","webpack://mcsmanager-daemon/./src/routers/http_router.ts","webpack://mcsmanager-daemon/./src/routers/info_router.ts","webpack://mcsmanager-daemon/./src/routers/instance_event_router.ts","webpack://mcsmanager-daemon/./src/routers/passport_router.ts","webpack://mcsmanager-daemon/./src/routers/schedule_router.ts","webpack://mcsmanager-daemon/./src/routers/stream_router.ts","webpack://mcsmanager-daemon/./src/service/async_task_service/index.ts","webpack://mcsmanager-daemon/./src/service/async_task_service/quick_install.ts","webpack://mcsmanager-daemon/./src/service/dependencies.ts","webpack://mcsmanager-daemon/./src/service/docker_process_service.ts","webpack://mcsmanager-daemon/./src/service/docker_service.ts","webpack://mcsmanager-daemon/./src/service/download.ts","webpack://mcsmanager-daemon/./src/service/file_router_service.ts","webpack://mcsmanager-daemon/./src/service/http.ts","webpack://mcsmanager-daemon/./src/service/instance_update_action.ts","webpack://mcsmanager-daemon/./src/service/log.ts","webpack://mcsmanager-daemon/./src/service/mission_passport.ts","webpack://mcsmanager-daemon/./src/service/protocol.ts","webpack://mcsmanager-daemon/./src/service/router.ts","webpack://mcsmanager-daemon/./src/service/system_file.ts","webpack://mcsmanager-daemon/./src/service/system_instance.ts","webpack://mcsmanager-daemon/./src/service/system_instance_control.ts","webpack://mcsmanager-daemon/./src/service/system_visual_data.ts","webpack://mcsmanager-daemon/./src/service/version.ts","webpack://mcsmanager-daemon/./src/service/version_adapter.ts","webpack://mcsmanager-daemon/./src/tools/filepath.ts","webpack://mcsmanager-daemon/external commonjs \"@iarna/toml\"","webpack://mcsmanager-daemon/external commonjs \"@koa/router\"","webpack://mcsmanager-daemon/external commonjs \"axios\"","webpack://mcsmanager-daemon/external commonjs \"dockerode\"","webpack://mcsmanager-daemon/external commonjs \"events\"","webpack://mcsmanager-daemon/external commonjs \"fs-extra\"","webpack://mcsmanager-daemon/external commonjs \"i18next\"","webpack://mcsmanager-daemon/external commonjs \"iconv-lite\"","webpack://mcsmanager-daemon/external commonjs \"koa\"","webpack://mcsmanager-daemon/external commonjs \"koa-body-patch\"","webpack://mcsmanager-daemon/external commonjs \"koa-send\"","webpack://mcsmanager-daemon/external commonjs \"log4js\"","webpack://mcsmanager-daemon/external commonjs \"module-alias/register\"","webpack://mcsmanager-daemon/external commonjs \"node-disk-info\"","webpack://mcsmanager-daemon/external commonjs \"node-schedule\"","webpack://mcsmanager-daemon/external commonjs \"os-utils\"","webpack://mcsmanager-daemon/external commonjs \"pidusage\"","webpack://mcsmanager-daemon/external commonjs \"properties\"","webpack://mcsmanager-daemon/external commonjs \"rcon-srcds\"","webpack://mcsmanager-daemon/external commonjs \"socket.io\"","webpack://mcsmanager-daemon/external commonjs \"uuid\"","webpack://mcsmanager-daemon/external commonjs \"yaml\"","webpack://mcsmanager-daemon/external node-commonjs \"child_process\"","webpack://mcsmanager-daemon/external node-commonjs \"fs\"","webpack://mcsmanager-daemon/external node-commonjs \"http\"","webpack://mcsmanager-daemon/external node-commonjs \"net\"","webpack://mcsmanager-daemon/external node-commonjs \"os\"","webpack://mcsmanager-daemon/external node-commonjs \"path\"","webpack://mcsmanager-daemon/external node-commonjs \"readline\"","webpack://mcsmanager-daemon/external node-commonjs \"stream\"","webpack://mcsmanager-daemon/webpack/bootstrap","webpack://mcsmanager-daemon/webpack/before-startup","webpack://mcsmanager-daemon/webpack/startup","webpack://mcsmanager-daemon/webpack/after-startup"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass GlobalVariable {\r\n    static set(k, v) {\r\n        GlobalVariable.map.set(k, v);\r\n    }\r\n    static get(k, def) {\r\n        if (GlobalVariable.map.has(k)) {\r\n            return GlobalVariable.map.get(k);\r\n        }\r\n        else {\r\n            return def;\r\n        }\r\n    }\r\n    static del(k) {\r\n        return GlobalVariable.map.delete(k);\r\n    }\r\n}\r\nexports.default = GlobalVariable;\r\nGlobalVariable.map = new Map();\r\n//# sourceMappingURL=global_variable.js.map","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.systemInfo = exports.supposeValue = exports.isEmpty = exports.toNumber = exports.toBoolean = exports.toText = exports.configureEntityParams = exports.killProcess = exports.QueryWrapper = exports.LocalFileSource = exports.MySqlSource = exports.QueryMapWrapper = exports.ProcessWrapper = exports.InstanceStreamListener = exports.GlobalVariable = exports.StorageSubsystem = exports.MCServerStatus = exports.removeTrail = void 0;\r\nconst system_storage_1 = __importDefault(require(\"./system_storage\"));\r\nexports.StorageSubsystem = system_storage_1.default;\r\nconst global_variable_1 = __importDefault(require(\"./global_variable\"));\r\nexports.GlobalVariable = global_variable_1.default;\r\nconst instance_stream_1 = __importDefault(require(\"./instance_stream\"));\r\nexports.InstanceStreamListener = instance_stream_1.default;\r\nconst process_tools_1 = require(\"./process_tools\");\r\nObject.defineProperty(exports, \"ProcessWrapper\", { enumerable: true, get: function () { return process_tools_1.ProcessWrapper; } });\r\nObject.defineProperty(exports, \"killProcess\", { enumerable: true, get: function () { return process_tools_1.killProcess; } });\r\nconst system_info_1 = require(\"./system_info\");\r\nObject.defineProperty(exports, \"systemInfo\", { enumerable: true, get: function () { return system_info_1.systemInfo; } });\r\nconst mcping_1 = __importDefault(require(\"./mcping\"));\r\nexports.MCServerStatus = mcping_1.default;\r\nconst query_wrapper_1 = require(\"./query_wrapper\");\r\nObject.defineProperty(exports, \"QueryMapWrapper\", { enumerable: true, get: function () { return query_wrapper_1.QueryMapWrapper; } });\r\nObject.defineProperty(exports, \"MySqlSource\", { enumerable: true, get: function () { return query_wrapper_1.MySqlSource; } });\r\nObject.defineProperty(exports, \"LocalFileSource\", { enumerable: true, get: function () { return query_wrapper_1.LocalFileSource; } });\r\nObject.defineProperty(exports, \"QueryWrapper\", { enumerable: true, get: function () { return query_wrapper_1.QueryWrapper; } });\r\nconst typecheck_1 = require(\"./typecheck\");\r\nObject.defineProperty(exports, \"configureEntityParams\", { enumerable: true, get: function () { return typecheck_1.configureEntityParams; } });\r\nObject.defineProperty(exports, \"toText\", { enumerable: true, get: function () { return typecheck_1.toText; } });\r\nObject.defineProperty(exports, \"toBoolean\", { enumerable: true, get: function () { return typecheck_1.toBoolean; } });\r\nObject.defineProperty(exports, \"toNumber\", { enumerable: true, get: function () { return typecheck_1.toNumber; } });\r\nObject.defineProperty(exports, \"isEmpty\", { enumerable: true, get: function () { return typecheck_1.isEmpty; } });\r\nObject.defineProperty(exports, \"supposeValue\", { enumerable: true, get: function () { return typecheck_1.supposeValue; } });\r\nvar string_utils_1 = require(\"./string_utils\");\r\nObject.defineProperty(exports, \"removeTrail\", { enumerable: true, get: function () { return string_utils_1.removeTrail; } });\r\n//# sourceMappingURL=index.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n// Application instance data stream forwarding adapter\r\nclass InstanceStreamListener {\r\n    constructor() {\r\n        this.listenMap = new Map();\r\n    }\r\n    requestForward(socket, instanceUuid) {\r\n        if (this.listenMap.has(instanceUuid)) {\r\n            const sockets = this.listenMap.get(instanceUuid);\r\n            if (!sockets)\r\n                return;\r\n            for (const iterator of sockets)\r\n                if (iterator.id === socket.id)\r\n                    throw new Error(`This Socket ${socket.id} already exists in the specified instance listening table`);\r\n            sockets.push(socket);\r\n        }\r\n        else {\r\n            this.listenMap.set(instanceUuid, [socket]);\r\n        }\r\n    }\r\n    cannelForward(socket, instanceUuid) {\r\n        if (!this.listenMap.has(instanceUuid))\r\n            throw new Error(`The specified ${instanceUuid} does not exist in the listening table`);\r\n        const socketList = this.listenMap.get(instanceUuid);\r\n        socketList === null || socketList === void 0 ? void 0 : socketList.forEach((v, index) => {\r\n            if (v.id === socket.id)\r\n                socketList === null || socketList === void 0 ? void 0 : socketList.splice(index, 1);\r\n        });\r\n    }\r\n    forward(instanceUuid, data) {\r\n        const sockets = this.listenMap.get(instanceUuid);\r\n        sockets === null || sockets === void 0 ? void 0 : sockets.forEach((socket) => {\r\n            if (socket && socket.connected)\r\n                socket.emit(\"instance/stdout\", data);\r\n        });\r\n    }\r\n    forwardViaCallback(instanceUuid, callback) {\r\n        if (this.listenMap.has(instanceUuid)) {\r\n            const sockets = this.listenMap.get(instanceUuid);\r\n            sockets === null || sockets === void 0 ? void 0 : sockets.forEach((socket) => {\r\n                if (socket && socket.connected)\r\n                    callback(socket);\r\n            });\r\n        }\r\n    }\r\n    hasListenInstance(instanceUuid) {\r\n        var _a;\r\n        return this.listenMap.has(instanceUuid) && ((_a = this.listenMap) === null || _a === void 0 ? void 0 : _a.get(instanceUuid).length) > 0;\r\n    }\r\n}\r\nexports.default = InstanceStreamListener;\r\n//# sourceMappingURL=instance_stream.js.map","\"use strict\";\r\n// Using SLT (Server List Ping) provided by Minecraft.\r\n// Since it is part of the protocol it is always enabled contrary to Query\r\n// More information at: https://wiki.vg/Server_List_Ping#Response\r\n// Github: https://github.com/Vaksty/mcping\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst net_1 = __importDefault(require(\"net\"));\r\nfunction formatMotd(motd) {\r\n    let noSpaces = motd.replace(/\\u0000/g, \"\");\r\n    Buffer.from(noSpaces);\r\n    // let noColor = noSpaces.toString().replace(/[^\\x00-\\x7F]/g, '');\r\n    // console.log(Buffer.from(motd, 'utf8').toString('hex'));\r\n    // console.log(noColor);\r\n}\r\nclass MCServStatus {\r\n    constructor(port, host) {\r\n        this.port = port;\r\n        this.host = host;\r\n        this.status = {\r\n            online: null,\r\n            version: null,\r\n            motd: null,\r\n            current_players: null,\r\n            max_players: null,\r\n            latency: null\r\n        };\r\n    }\r\n    getStatus() {\r\n        return new Promise((resolve, reject) => {\r\n            var start_time = new Date().getTime();\r\n            const client = net_1.default.connect(this.port, this.host, () => {\r\n                this.status.latency = Math.round(new Date().getTime() - start_time);\r\n                // 0xFE packet identifier for a server list ping\r\n                // 0x01 server list ping's payload (always 1)\r\n                let data = Buffer.from([0xfe, 0x01]);\r\n                client.write(data);\r\n            });\r\n            // The client can also receive data from the server by reading from its socket.\r\n            client.on(\"data\", (response) => {\r\n                // Check the readme for a simple explanation\r\n                var server_info = response.toString().split(\"\\x00\\x00\");\r\n                this.status = {\r\n                    host: this.host,\r\n                    port: this.port,\r\n                    status: true,\r\n                    version: server_info[2].replace(/\\u0000/g, \"\"),\r\n                    motd: server_info[3].replace(/\\u0000/g, \"\"),\r\n                    current_players: server_info[4].replace(/\\u0000/g, \"\"),\r\n                    max_players: server_info[5].replace(/\\u0000/g, \"\"),\r\n                    latency: this.status.latency\r\n                };\r\n                formatMotd(server_info[3]);\r\n                // Request an end to the connection after the data has been received.\r\n                client.end();\r\n                resolve(this.status);\r\n            });\r\n            client.on(\"end\", () => {\r\n                // console.log('Requested an end to the TCP connection');\r\n            });\r\n            client.on(\"error\", (err) => {\r\n                reject(err);\r\n            });\r\n        });\r\n    }\r\n    async asyncStatus() {\r\n        let status = await this.getStatus();\r\n        return status;\r\n    }\r\n}\r\nexports.default = MCServStatus;\r\n//# sourceMappingURL=mcping.js.map","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.killProcess = exports.ProcessWrapper = exports.StartError = void 0;\r\nconst child_process_1 = require(\"child_process\");\r\nconst os_1 = __importDefault(require(\"os\"));\r\nconst child_process_2 = __importDefault(require(\"child_process\"));\r\nconst path_1 = __importDefault(require(\"path\"));\r\nconst events_1 = __importDefault(require(\"events\"));\r\nconst iconv_lite_1 = __importDefault(require(\"iconv-lite\"));\r\nclass StartError extends Error {\r\n}\r\nexports.StartError = StartError;\r\nclass ProcessWrapper extends events_1.default {\r\n    constructor(file, args, cwd, timeout = 0, code = \"utf-8\", option = {}) {\r\n        super();\r\n        this.file = file;\r\n        this.args = args;\r\n        this.cwd = cwd;\r\n        this.timeout = timeout;\r\n        this.code = code;\r\n        this.option = option;\r\n        this.errMsg = {\r\n            timeoutErr: \"task timeout!\",\r\n            exitErr: \"task error!\",\r\n            startErr: \"task start error!\"\r\n        };\r\n    }\r\n    setErrMsg(errMsg) {\r\n        this.errMsg = errMsg;\r\n    }\r\n    start() {\r\n        return new Promise((resolve, reject) => {\r\n            let timeTask;\r\n            const subProcess = child_process_2.default.spawn(this.file, this.args, {\r\n                stdio: \"pipe\",\r\n                windowsHide: true,\r\n                cwd: path_1.default.normalize(this.cwd),\r\n                ...this.option\r\n            });\r\n            this.process = subProcess;\r\n            this.pid = subProcess.pid;\r\n            this.emit(\"start\", subProcess.pid);\r\n            if (!subProcess || !subProcess.pid)\r\n                return reject(new Error(this.errMsg.startErr));\r\n            subProcess.stdout.on(\"data\", (text) => this.emit(\"data\", iconv_lite_1.default.decode(text, this.code)));\r\n            subProcess.stderr.on(\"data\", (text) => this.emit(\"data\", iconv_lite_1.default.decode(text, this.code)));\r\n            subProcess.on(\"exit\", (code) => {\r\n                try {\r\n                    this.emit(\"exit\", code);\r\n                    this.destroy();\r\n                }\r\n                catch (error) { }\r\n                if (timeTask)\r\n                    clearTimeout(timeTask);\r\n                if (code !== 0)\r\n                    return reject(new Error(this.errMsg.exitErr));\r\n                return resolve(true);\r\n            });\r\n            // timeout, terminate the task\r\n            if (this.timeout) {\r\n                timeTask = setTimeout(() => {\r\n                    if ((subProcess === null || subProcess === void 0 ? void 0 : subProcess.pid) && !subProcess.exitCode && subProcess.exitCode !== 0) {\r\n                        killProcess(subProcess.pid, subProcess);\r\n                        reject(new Error(this.errMsg.timeoutErr));\r\n                    }\r\n                    else {\r\n                        reject(new Error(this.errMsg.exitErr));\r\n                    }\r\n                }, 1000 * this.timeout);\r\n            }\r\n        });\r\n    }\r\n    getPid() {\r\n        var _a;\r\n        return (_a = this.process) === null || _a === void 0 ? void 0 : _a.pid;\r\n    }\r\n    write(data) {\r\n        var _a, _b;\r\n        return (_b = (_a = this.process) === null || _a === void 0 ? void 0 : _a.stdin) === null || _b === void 0 ? void 0 : _b.write(iconv_lite_1.default.encode(data, this.code));\r\n    }\r\n    kill() {\r\n        var _a, _b;\r\n        if ((_a = this.process) === null || _a === void 0 ? void 0 : _a.pid)\r\n            killProcess((_b = this.process) === null || _b === void 0 ? void 0 : _b.pid, this.process);\r\n    }\r\n    status() {\r\n        var _a;\r\n        return !!((_a = this.process) === null || _a === void 0 ? void 0 : _a.exitCode);\r\n    }\r\n    exitCode() {\r\n        var _a;\r\n        return (_a = this.process) === null || _a === void 0 ? void 0 : _a.exitCode;\r\n    }\r\n    async destroy() {\r\n        var _a, _b, _c, _d, _e, _f, _g;\r\n        try {\r\n            for (const n of this.eventNames())\r\n                this.removeAllListeners(n);\r\n            if ((_a = this.process) === null || _a === void 0 ? void 0 : _a.stdout)\r\n                for (const eventName of this.process.stdout.eventNames())\r\n                    this.process.stdout.removeAllListeners(eventName);\r\n            if ((_b = this.process) === null || _b === void 0 ? void 0 : _b.stderr)\r\n                for (const eventName of this.process.stderr.eventNames())\r\n                    this.process.stderr.removeAllListeners(eventName);\r\n            if (this.process)\r\n                for (const eventName of this.process.eventNames())\r\n                    this.process.removeAllListeners(eventName);\r\n            (_d = (_c = this.process) === null || _c === void 0 ? void 0 : _c.stdout) === null || _d === void 0 ? void 0 : _d.destroy();\r\n            (_f = (_e = this.process) === null || _e === void 0 ? void 0 : _e.stderr) === null || _f === void 0 ? void 0 : _f.destroy();\r\n            if (((_g = this.process) === null || _g === void 0 ? void 0 : _g.exitCode) === null) {\r\n                this.process.kill(\"SIGTERM\");\r\n                this.process.kill(\"SIGKILL\");\r\n            }\r\n        }\r\n        catch (error) {\r\n            console.log(\"[ProcessWrapper destroy() Error]\", error);\r\n        }\r\n        finally {\r\n            this.process = undefined;\r\n        }\r\n    }\r\n}\r\nexports.ProcessWrapper = ProcessWrapper;\r\nfunction killProcess(pid, process, signal) {\r\n    try {\r\n        if (os_1.default.platform() === \"win32\") {\r\n            (0, child_process_1.execSync)(`taskkill /PID ${pid} /T /F`);\r\n            return true;\r\n        }\r\n        if (os_1.default.platform() === \"linux\") {\r\n            (0, child_process_1.execSync)(`kill -s 9 ${pid}`);\r\n            return true;\r\n        }\r\n    }\r\n    catch (err) {\r\n        return signal ? process.kill(signal) : process.kill(\"SIGKILL\");\r\n    }\r\n    return signal ? process.kill(signal) : process.kill(\"SIGKILL\");\r\n}\r\nexports.killProcess = killProcess;\r\n//# sourceMappingURL=process_tools.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.QueryWrapper = exports.LocalFileSource = exports.MySqlSource = exports.QueryMapWrapper = void 0;\r\n// Provide the MAP query interface used by the routing layer\r\nclass QueryMapWrapper {\r\n    constructor(map) {\r\n        this.map = map;\r\n    }\r\n    select(condition) {\r\n        const result = [];\r\n        this.map.forEach((v) => {\r\n            if (condition(v))\r\n                result.push(v);\r\n        });\r\n        return result;\r\n    }\r\n    page(data, page = 1, pageSize = 10) {\r\n        const start = (page - 1) * pageSize;\r\n        const end = start + pageSize;\r\n        let size = data.length;\r\n        let maxPage = 0;\r\n        while (size > 0) {\r\n            size -= pageSize;\r\n            maxPage++;\r\n        }\r\n        return {\r\n            page,\r\n            pageSize,\r\n            maxPage,\r\n            data: data.slice(start, end)\r\n        };\r\n    }\r\n}\r\nexports.QueryMapWrapper = QueryMapWrapper;\r\n// MYSQL data source\r\nclass MySqlSource {\r\n    constructor(data) {\r\n        this.data = data;\r\n    }\r\n    selectPage(condition, page, pageSize) {\r\n        return {\r\n            page,\r\n            pageSize,\r\n            maxPage: 0,\r\n            total: 0,\r\n            data: []\r\n        };\r\n    }\r\n    select(condition) {\r\n        return [];\r\n    }\r\n    update(condition, data) { }\r\n    delete(condition) { }\r\n    insert(data) { }\r\n}\r\nexports.MySqlSource = MySqlSource;\r\n// local file data source (embedded microdatabase)\r\nclass LocalFileSource {\r\n    constructor(data) {\r\n        this.data = data;\r\n    }\r\n    selectPage(condition, page = 1, pageSize = 10) {\r\n        const result = [];\r\n        this.data.forEach((v) => {\r\n            for (const key in condition) {\r\n                const dataValue = v[key];\r\n                const targetValue = condition[key];\r\n                if (targetValue[0] == \"%\") {\r\n                    if (!dataValue.includes(targetValue.slice(1, targetValue.length - 1)))\r\n                        return false;\r\n                }\r\n                else {\r\n                    if (targetValue !== dataValue)\r\n                        return false;\r\n                }\r\n            }\r\n            result.push(v);\r\n        });\r\n        return this.page(result, page, pageSize);\r\n    }\r\n    page(data, page = 1, pageSize = 10) {\r\n        const start = (page - 1) * pageSize;\r\n        const end = start + pageSize;\r\n        let size = data.length;\r\n        let maxPage = 0;\r\n        while (size > 0) {\r\n            size -= pageSize;\r\n            maxPage++;\r\n        }\r\n        return {\r\n            page,\r\n            pageSize,\r\n            maxPage,\r\n            total: data.length,\r\n            data: data.slice(start, end)\r\n        };\r\n    }\r\n    select(condition) {\r\n        return [];\r\n    }\r\n    update(condition, data) { }\r\n    delete(condition) { }\r\n    insert(data) { }\r\n}\r\nexports.LocalFileSource = LocalFileSource;\r\n// Provide the unified data query interface used by the routing layer\r\nclass QueryWrapper {\r\n    constructor(dataSource) {\r\n        this.dataSource = dataSource;\r\n    }\r\n    selectPage(condition, page = 1, pageSize = 10) {\r\n        return this.dataSource.selectPage(condition, page, pageSize);\r\n    }\r\n}\r\nexports.QueryWrapper = QueryWrapper;\r\n//# sourceMappingURL=query_wrapper.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.removeTrail = void 0;\r\nfunction removeTrail(origin, trail) {\r\n    if (origin.endsWith(trail)) {\r\n        return origin.slice(0, origin.length - trail.length);\r\n    }\r\n    else {\r\n        return origin;\r\n    }\r\n}\r\nexports.removeTrail = removeTrail;\r\n//# sourceMappingURL=string_utils.js.map","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.systemInfo = void 0;\r\nconst os_1 = __importDefault(require(\"os\"));\r\nconst os_utils_1 = __importDefault(require(\"os-utils\"));\r\nconst fs_1 = __importDefault(require(\"fs\"));\r\n// System details are updated every time\r\nconst info = {\r\n    type: os_1.default.type(),\r\n    hostname: os_1.default.hostname(),\r\n    platform: os_1.default.platform(),\r\n    release: os_1.default.release(),\r\n    uptime: os_1.default.uptime(),\r\n    cwd: process.cwd(),\r\n    loadavg: os_1.default.loadavg(),\r\n    freemem: 0,\r\n    cpuUsage: 0,\r\n    memUsage: 0,\r\n    totalmem: 0,\r\n    processCpu: 0,\r\n    processMem: 0\r\n};\r\n// periodically refresh the cache\r\nsetInterval(() => {\r\n    if (os_1.default.platform() === \"linux\") {\r\n        return setLinuxSystemInfo();\r\n    }\r\n    if (os_1.default.platform() === \"win32\") {\r\n        return setWindowsSystemInfo();\r\n    }\r\n    return otherSystemInfo();\r\n}, 3000);\r\nfunction otherSystemInfo() {\r\n    info.freemem = os_1.default.freemem();\r\n    info.totalmem = os_1.default.totalmem();\r\n    info.memUsage = (os_1.default.totalmem() - os_1.default.freemem()) / os_1.default.totalmem();\r\n    os_utils_1.default.cpuUsage((p) => (info.cpuUsage = p));\r\n}\r\nfunction setWindowsSystemInfo() {\r\n    info.freemem = os_1.default.freemem();\r\n    info.totalmem = os_1.default.totalmem();\r\n    info.memUsage = (os_1.default.totalmem() - os_1.default.freemem()) / os_1.default.totalmem();\r\n    os_utils_1.default.cpuUsage((p) => (info.cpuUsage = p));\r\n}\r\nfunction setLinuxSystemInfo() {\r\n    var _a;\r\n    try {\r\n        // read memory data based on /proc/meminfo\r\n        const data = fs_1.default.readFileSync(\"/proc/meminfo\", { encoding: \"utf-8\" });\r\n        const list = data.split(\"\\n\");\r\n        const infoTable = {};\r\n        list.forEach((line) => {\r\n            const kv = line.split(\":\");\r\n            if (kv.length === 2) {\r\n                const k = kv[0].replace(/ /gim, \"\").replace(/\\t/gim, \"\").trim().toLowerCase();\r\n                let v = kv[1].replace(/ /gim, \"\").replace(/\\t/gim, \"\").trim().toLowerCase();\r\n                v = v.replace(/kb/gim, \"\").replace(/mb/gim, \"\").replace(/gb/gim, \"\");\r\n                let vNumber = parseInt(v);\r\n                if (isNaN(vNumber))\r\n                    vNumber = 0;\r\n                infoTable[k] = vNumber;\r\n            }\r\n        });\r\n        const memAvailable = (_a = infoTable[\"memavailable\"]) !== null && _a !== void 0 ? _a : infoTable[\"memfree\"];\r\n        const memTotal = infoTable[\"memtotal\"];\r\n        info.freemem = memAvailable * 1024;\r\n        info.totalmem = memTotal * 1024;\r\n        info.memUsage = (info.totalmem - info.freemem) / info.totalmem;\r\n        os_utils_1.default.cpuUsage((p) => (info.cpuUsage = p));\r\n    }\r\n    catch (error) {\r\n        // If the reading is wrong, the default general reading method is automatically used\r\n        otherSystemInfo();\r\n    }\r\n}\r\nfunction systemInfo() {\r\n    return info;\r\n}\r\nexports.systemInfo = systemInfo;\r\n//# sourceMappingURL=system_info.js.map","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst path_1 = __importDefault(require(\"path\"));\r\nconst fs_extra_1 = __importDefault(require(\"fs-extra\"));\r\nclass StorageSubsystem {\r\n    checkFileName(name) {\r\n        const blackList = [\"\\\\\", \"/\", \"..\"];\r\n        for (const ch of blackList) {\r\n            if (name.includes(ch))\r\n                return false;\r\n        }\r\n        return true;\r\n    }\r\n    writeFile(name, data) {\r\n        const targetPath = path_1.default.normalize(path_1.default.join(StorageSubsystem.DATA_PATH, name));\r\n        fs_extra_1.default.writeFileSync(targetPath, data, { encoding: \"utf-8\" });\r\n    }\r\n    readFile(name) {\r\n        const targetPath = path_1.default.normalize(path_1.default.join(StorageSubsystem.DATA_PATH, name));\r\n        return fs_extra_1.default.readFileSync(targetPath, { encoding: \"utf-8\" });\r\n    }\r\n    readDir(dirName) {\r\n        const targetPath = path_1.default.normalize(path_1.default.join(StorageSubsystem.DATA_PATH, dirName));\r\n        if (!fs_extra_1.default.existsSync(targetPath))\r\n            return [];\r\n        const files = fs_extra_1.default.readdirSync(targetPath).map((v) => path_1.default.normalize(path_1.default.join(dirName, v)));\r\n        return files;\r\n    }\r\n    deleteFile(name) {\r\n        const targetPath = path_1.default.normalize(path_1.default.join(StorageSubsystem.DATA_PATH, name));\r\n        fs_extra_1.default.removeSync(targetPath);\r\n    }\r\n    fileExists(name) {\r\n        const targetPath = path_1.default.normalize(path_1.default.join(StorageSubsystem.DATA_PATH, name));\r\n        return fs_extra_1.default.existsSync(targetPath);\r\n    }\r\n    // Stored in local file based on class definition and identifier\r\n    store(category, uuid, object) {\r\n        const dirPath = path_1.default.join(StorageSubsystem.DATA_PATH, category);\r\n        if (!fs_extra_1.default.existsSync(dirPath))\r\n            fs_extra_1.default.mkdirsSync(dirPath);\r\n        if (!this.checkFileName(uuid))\r\n            throw new Error(`UUID ${uuid} does not conform to specification`);\r\n        const filePath = path_1.default.join(dirPath, `${uuid}.json`);\r\n        const data = JSON.stringify(object, null, 4);\r\n        fs_extra_1.default.writeFileSync(filePath, data, { encoding: \"utf-8\" });\r\n    }\r\n    // deep copy of the primitive type with the copy target as the prototype\r\n    defineAttr(target, object) {\r\n        for (const v of Object.keys(target)) {\r\n            const objectValue = object[v];\r\n            if (objectValue === undefined)\r\n                continue;\r\n            if (objectValue instanceof Array) {\r\n                target[v] = objectValue;\r\n                continue;\r\n            }\r\n            if (objectValue instanceof Object && typeof objectValue === \"object\") {\r\n                this.defineAttr(target[v], objectValue);\r\n                continue;\r\n            }\r\n            target[v] = objectValue;\r\n        }\r\n        return target;\r\n    }\r\n    /**\r\n     * Instantiate an object based on the class definition and identifier\r\n     */\r\n    load(category, classz, uuid) {\r\n        const dirPath = path_1.default.join(StorageSubsystem.DATA_PATH, category);\r\n        if (!fs_extra_1.default.existsSync(dirPath))\r\n            fs_extra_1.default.mkdirsSync(dirPath);\r\n        if (!this.checkFileName(uuid))\r\n            throw new Error(`UUID ${uuid} does not conform to specification`);\r\n        const filePath = path_1.default.join(dirPath, `${uuid}.json`);\r\n        if (!fs_extra_1.default.existsSync(filePath))\r\n            return null;\r\n        const data = fs_extra_1.default.readFileSync(filePath, { encoding: \"utf-8\" });\r\n        const dataObject = JSON.parse(data);\r\n        const target = new classz();\r\n        // for (const v of Object. keys(target)) {\r\n        // if (dataObject[v] !== undefined) target[v] = dataObject[v];\r\n        // }\r\n        // deep object copy\r\n        return this.defineAttr(target, dataObject);\r\n    }\r\n    /**\r\n     * Return all identifiers related to this class through the class definition\r\n     */\r\n    list(category) {\r\n        const dirPath = path_1.default.join(StorageSubsystem.DATA_PATH, category);\r\n        if (!fs_extra_1.default.existsSync(dirPath))\r\n            fs_extra_1.default.mkdirsSync(dirPath);\r\n        const files = fs_extra_1.default.readdirSync(dirPath);\r\n        const result = new Array();\r\n        files.forEach((name) => {\r\n            result.push(name.replace(path_1.default.extname(name), \"\"));\r\n        });\r\n        return result;\r\n    }\r\n    /**\r\n     * Delete an identifier instance of the specified type through the class definition\r\n     */\r\n    delete(category, uuid) {\r\n        const filePath = path_1.default.join(StorageSubsystem.DATA_PATH, category, `${uuid}.json`);\r\n        if (!fs_extra_1.default.existsSync(filePath))\r\n            return;\r\n        fs_extra_1.default.removeSync(filePath);\r\n    }\r\n}\r\nexports.default = StorageSubsystem;\r\nStorageSubsystem.DATA_PATH = path_1.default.normalize(path_1.default.join(process.cwd(), \"data\"));\r\nStorageSubsystem.INDEX_PATH = path_1.default.normalize(path_1.default.join(process.cwd(), \"data\", \"index\"));\r\n//# sourceMappingURL=system_storage.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.supposeValue = exports.isEmpty = exports.toBoolean = exports.toNumber = exports.toText = exports.configureEntityParams = void 0;\r\nfunction configureEntityParams(self, args, key, typeFn) {\r\n    var _a;\r\n    const selfDefaultValue = (_a = self[key]) !== null && _a !== void 0 ? _a : null;\r\n    const v = args[key] != null ? args[key] : selfDefaultValue;\r\n    if (typeFn === Number) {\r\n        if (v === \"\" || v == null) {\r\n            self[key] = null;\r\n        }\r\n        else {\r\n            if (isNaN(Number(v)))\r\n                throw new Error(`ConfigureEntityParams Error: Expected type to be Number, but got ${typeof v}`);\r\n            self[key] = Number(v);\r\n        }\r\n        return;\r\n    }\r\n    if (typeFn === String) {\r\n        if (v == null) {\r\n            self[key] = null;\r\n        }\r\n        else {\r\n            self[key] = String(v);\r\n        }\r\n        return;\r\n    }\r\n    if (typeFn === Boolean) {\r\n        if (v == null) {\r\n            self[key] = false;\r\n        }\r\n        else {\r\n            self[key] = Boolean(v);\r\n        }\r\n        return;\r\n    }\r\n    if (typeFn) {\r\n        self[key] = typeFn(v);\r\n    }\r\n    else {\r\n        self[key] = v;\r\n    }\r\n}\r\nexports.configureEntityParams = configureEntityParams;\r\nfunction toText(v) {\r\n    if (isEmpty(v))\r\n        return null;\r\n    return String(v);\r\n}\r\nexports.toText = toText;\r\nfunction toNumber(v) {\r\n    if (isEmpty(v))\r\n        return null;\r\n    if (isNaN(Number(v)))\r\n        return null;\r\n    return Number(v);\r\n}\r\nexports.toNumber = toNumber;\r\nfunction toBoolean(v) {\r\n    if (isEmpty(v))\r\n        return null;\r\n    return Boolean(v);\r\n}\r\nexports.toBoolean = toBoolean;\r\nfunction isEmpty(v) {\r\n    return v === null || v === undefined;\r\n}\r\nexports.isEmpty = isEmpty;\r\nfunction supposeValue(v, def) {\r\n    if (isEmpty(v))\r\n        return def;\r\n    return v;\r\n}\r\nexports.supposeValue = supposeValue;\r\n//# sourceMappingURL=typecheck.js.map","import \"module-alias/register\";\r\nimport http from \"http\";\r\nimport fs from \"fs-extra\";\r\nimport versionAdapter from \"./service/version_adapter\";\r\nimport { checkDependencies } from \"./service/dependencies\";\r\nimport { $t, i18next } from \"./i18n\";\r\nimport { getVersion, initVersionManager } from \"./service/version\";\r\nimport { globalConfiguration } from \"./entity/config\";\r\nimport { Server, Socket } from \"socket.io\";\r\nimport { LOCAL_PRESET_LANG_PATH } from \"./const\";\r\nimport logger from \"./service/log\";\r\nimport { GOLANG_ZIP_PATH, PTY_PATH } from \"./const\";\r\nimport * as router from \"./service/router\";\r\nimport * as koa from \"./service/http\";\r\nimport * as protocol from \"./service/protocol\";\r\nimport InstanceSubsystem from \"./service/system_instance\";\r\nimport \"./service/async_task_service\";\r\nimport \"./service/async_task_service/quick_install\";\r\nimport \"./service/system_visual_data\";\r\nimport { removeTrail } from \"common\";\r\n\r\ninitVersionManager();\r\nconst VERSION = getVersion();\r\n\r\nconsole.log(`\r\n______  _______________________  ___                                         \r\n___   |/  /_  ____/_  ___/__   |/  /_____ _____________ _______ _____________\r\n__  /|_/ /_  /    _____ \\\\__  /|_/ /_  __ \\`/_  __ \\\\  __ \\`/_  __ \\`/  _ \\\\_  ___/\r\n_  /  / / / /___  ____/ /_  /  / / / /_/ /_  / / / /_/ /_  /_/ //  __/  /    \r\n/_/  /_/  \\\\____/  /____/ /_/  /_/  \\\\__,_/ /_/ /_/\\\\__,_/ _\\\\__, / \\\\___//_/     \r\n                                                        /____/               \r\n________                                                                     \r\n___  __ \\\\_____ ____________ ________________                                 \r\n__  / / /  __ \\`/  _ \\\\_  __ \\`__ \\\\  __ \\\\_  __ \\\\                                \r\n_  /_/ // /_/ //  __/  / / / / / /_/ /  / / /                                \r\n/_____/ \\\\__,_/ \\\\___//_/ /_/ /_/\\\\____//_/ /_/                                 \r\n                                                                             \r\n\r\n + Copyright ${new Date().getFullYear()} MCSManager Dev <https://github.com/MCSManager>\r\n + Version ${VERSION}\r\n`);\r\n\r\n// Initialize the global configuration service\r\nglobalConfiguration.load();\r\nconst config = globalConfiguration.config;\r\n\r\n// Detect whether the configuration file is from an older version and update it if so.\r\nversionAdapter.detectConfig();\r\n\r\ncheckDependencies();\r\n\r\n// Set language\r\nif (fs.existsSync(LOCAL_PRESET_LANG_PATH)) {\r\n  i18next.changeLanguage(fs.readFileSync(LOCAL_PRESET_LANG_PATH, \"utf-8\"));\r\n} else {\r\n  const lang = config.language || \"en_us\";\r\n  logger.info(`LANGUAGE: ${lang}`);\r\n  i18next.changeLanguage(lang);\r\n}\r\nlogger.info($t(\"TXT_CODE_app.welcome\"));\r\n\r\n// Initialize HTTP service\r\nconst koaApp = koa.initKoa();\r\n\r\n// Listen for Koa errors\r\nkoaApp.on(\"error\", (error) => {\r\n  // Block all Koa framework error\r\n  // When Koa is attacked by a short connection flood, it is easy for error messages to swipe the screen, which may indirectly affect the operation of some applications\r\n});\r\n\r\nconst httpServer = http.createServer(koaApp.callback());\r\nhttpServer.on(\"error\", (err) => {\r\n  logger.error($t(\"TXT_CODE_app.httpSetupError\"));\r\n  logger.error(err);\r\n  process.exit(1);\r\n});\r\nhttpServer.listen(config.port, config.ip);\r\n\r\n// Initialize Websocket service to HTTP service\r\nconst io = new Server(httpServer, {\r\n  serveClient: false,\r\n  pingInterval: 5000,\r\n  pingTimeout: 5000,\r\n  cookie: false,\r\n  path: removeTrail(config.prefix, \"/\") + \"/socket.io\",\r\n  cors: {\r\n    origin: \"*\",\r\n    methods: [\"GET\", \"POST\", \"PUT\", \"DELETE\"]\r\n  },\r\n  maxHttpBufferSize: 1e8\r\n});\r\n\r\n// Initialize application instance system\r\ntry {\r\n  InstanceSubsystem.loadInstances();\r\n  logger.info($t(\"TXT_CODE_app.instanceLoad\", { n: InstanceSubsystem.getInstances().length }));\r\n} catch (err) {\r\n  logger.error($t(\"TXT_CODE_app.instanceLoadError\"), err);\r\n  process.exit(-1);\r\n}\r\n\r\n(function initCompressModule() {\r\n  try {\r\n    fs.chmodSync(GOLANG_ZIP_PATH, 0o755);\r\n    fs.chmodSync(PTY_PATH, 0o755);\r\n  } catch (error: any) {\r\n    logger.error(error?.message);\r\n    logger.error($t(\"TXT_CODE_a8b245fa\"));\r\n  }\r\n})();\r\n\r\n// Initialize Websocket server\r\nio.on(\"connection\", (socket: Socket) => {\r\n  protocol.addGlobalSocket(socket);\r\n  router.navigation(socket);\r\n\r\n  socket.on(\"disconnect\", () => {\r\n    protocol.delGlobalSocket(socket);\r\n    for (const name of socket.eventNames()) socket.removeAllListeners(name);\r\n  });\r\n});\r\n\r\nprocess.on(\"uncaughtException\", function (err) {\r\n  logger.error(`Error: UncaughtException:`, err);\r\n});\r\n\r\nprocess.on(\"unhandledRejection\", (reason, p) => {\r\n  logger.error(`Error: UnhandledRejection:`, reason, p);\r\n});\r\n\r\nlogger.info(\"----------------------------\");\r\nlogger.info($t(\"TXT_CODE_app.started\"));\r\nlogger.info($t(\"TXT_CODE_app.doc\"));\r\nlogger.info($t(\"TXT_CODE_app.addr\", { port: config.port }));\r\nlogger.info($t(\"TXT_CODE_app.configPathTip\", { path: \"\" }));\r\nlogger.info($t(\"TXT_CODE_app.password\", { key: config.key }));\r\nlogger.info($t(\"TXT_CODE_app.passwordTip\"));\r\nlogger.info($t(\"TXT_CODE_app.exitTip\"));\r\nlogger.info(\"----------------------------\");\r\nconsole.log(\"\");\r\n\r\nasync function processExit() {\r\n  try {\r\n    console.log(\"\");\r\n    logger.warn(\"Program received EXIT command.\");\r\n    await InstanceSubsystem.exit();\r\n    logger.info(\"Exit.\");\r\n  } catch (err) {\r\n    logger.error(\"ERROR:\", err);\r\n  } finally {\r\n    process.exit(0);\r\n  }\r\n}\r\n\r\n[\"SIGTERM\", \"SIGINT\", \"SIGQUIT\"].forEach(function (sig) {\r\n  process.on(sig, () => {\r\n    logger.warn(`${sig} close process signal detected.`);\r\n    processExit();\r\n  });\r\n});\r\n\r\nprocess.stdin.on(\"data\", (v) => {\r\n  const command = v.toString().replace(\"\\n\", \"\").replace(\"\\r\", \"\").trim().toLowerCase();\r\n  if (command === \"exit\") processExit();\r\n});\r\n","import path from \"path\";\r\nimport { t } from \"i18next\";\r\nimport logger from \"../service/log\";\r\nimport { ProcessWrapper } from \"common\";\r\nimport fs from \"fs-extra\";\r\nimport { GOLANG_ZIP_PATH } from \"../const\";\r\nimport { ZIP_TIMEOUT_SECONDS } from \"../const\";\r\n\r\nconst COMPRESS_ERROR_MSG = {\r\n  invalidName: t(\"TXT_CODE_3aa9f36\"),\r\n  exitErr: t(\"TXT_CODE_2be83d36\"),\r\n  startErr: t(\"TXT_CODE_37d839a4\"),\r\n  timeoutErr: t(\"TXT_CODE_15c07350\")\r\n};\r\n\r\nfunction checkFileName(fileName: string) {\r\n  const disableList = ['\"', \"'\", \"?\", \"|\", \"&\"];\r\n  for (const iterator of disableList) {\r\n    if (fileName.includes(iterator)) return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nexport async function compress(\r\n  sourceZip: string,\r\n  files: string[],\r\n  fileCode?: string\r\n): Promise<boolean> {\r\n  if (!checkFileName(sourceZip) || files.some((v) => !checkFileName(v)))\r\n    throw new Error(COMPRESS_ERROR_MSG.invalidName);\r\n  return await useZip(sourceZip, files, fileCode);\r\n}\r\n\r\nexport async function decompress(\r\n  zipPath: string,\r\n  dest: string,\r\n  fileCode?: string\r\n): Promise<boolean> {\r\n  if (!checkFileName(zipPath) || !checkFileName(dest))\r\n    throw new Error(COMPRESS_ERROR_MSG.invalidName);\r\n  return await useUnzip(zipPath, dest, fileCode || \"utf-8\");\r\n}\r\n\r\n// ./file-zip -mode 2 --zipPath aaa.zip --DistDirPath 123412124 --code GBK\r\nasync function useUnzip(sourceZip: string, destDir: string, code = \"utf-8\"): Promise<boolean> {\r\n  const params = [\r\n    \"--mode=2\",\r\n    `--zipPath=${path.basename(sourceZip)}`,\r\n    `--distDirPath=${path.normalize(destDir)}`,\r\n    `--code=${code}`\r\n  ];\r\n  logger.info(`Function useUnzip(): Command: ${GOLANG_ZIP_PATH} ${params.join(\" \")}`);\r\n  const subProcess = new ProcessWrapper(\r\n    GOLANG_ZIP_PATH,\r\n    params,\r\n    path.dirname(sourceZip),\r\n    ZIP_TIMEOUT_SECONDS,\r\n    code\r\n  );\r\n  subProcess.setErrMsg(COMPRESS_ERROR_MSG);\r\n  return subProcess.start();\r\n}\r\n\r\n// ./file-zip -mode 1 --file main.go --file file-zip --file 123 --file README.md --zipPath aaabb.zip\r\nasync function useZip(distZip: string, files: string[], code = \"utf-8\"): Promise<boolean> {\r\n  if (!files || files.length == 0) throw new Error(t(\"TXT_CODE_2038ec2c\"));\r\n  const params = [\"--mode=1\", `--code=${code}`, `--zipPath=${path.basename(distZip)}`];\r\n  files.forEach((v) => {\r\n    params.push(`--file=${path.basename(v)}`);\r\n  });\r\n  logger.info(\r\n    `Function useZip(): Command: ${GOLANG_ZIP_PATH} ${params.join(\" \")}, CWD: ${path.dirname(\r\n      distZip\r\n    )}`\r\n  );\r\n  const subProcess = new ProcessWrapper(\r\n    GOLANG_ZIP_PATH,\r\n    params,\r\n    path.dirname(distZip),\r\n    ZIP_TIMEOUT_SECONDS,\r\n    code\r\n  );\r\n  subProcess.setErrMsg(COMPRESS_ERROR_MSG);\r\n  return subProcess.start();\r\n}\r\n","import { StorageSubsystem } from \"common\";\r\nexport default new StorageSubsystem();\r\n","import os from \"os\";\r\nimport path from \"path\";\r\n\r\nconst SYS_INFO = `${os.platform()}_${os.arch()}${os.platform() === \"win32\" ? \".exe\" : \"\"}`;\r\nconst ptyName = `pty_${SYS_INFO}`;\r\nconst frpcName = `frpc_${SYS_INFO}`;\r\nconst PTY_PATH = path.normalize(path.join(process.cwd(), \"lib\", ptyName));\r\nconst FRPC_PATH = path.normalize(path.join(process.cwd(), \"lib\", frpcName));\r\nconst FILENAME_BLACKLIST = [\"\\\\\", \"/\", \".\", \"'\", '\"', \"?\", \"*\", \"<\", \">\"];\r\nconst LOCAL_PRESET_LANG_PATH = path.normalize(path.join(process.cwd(), \"language\"));\r\nconst IGNORE = \"[IGNORE_LOG]\";\r\nconst SYSTEM_TYPE = os.platform();\r\nconst ZIP_TIMEOUT_SECONDS = 60 * 40;\r\nconst GOLANG_ZIP_NAME = `file_zip_${SYSTEM_TYPE}_${os.arch()}${\r\n  SYSTEM_TYPE === \"win32\" ? \".exe\" : \"\"\r\n}`;\r\nconst GOLANG_ZIP_PATH = path.normalize(path.join(process.cwd(), \"lib\", GOLANG_ZIP_NAME));\r\n\r\nexport {\r\n  GOLANG_ZIP_PATH,\r\n  FILENAME_BLACKLIST,\r\n  PTY_PATH,\r\n  LOCAL_PRESET_LANG_PATH,\r\n  FRPC_PATH,\r\n  IGNORE,\r\n  ZIP_TIMEOUT_SECONDS\r\n};\r\n","export default class InstanceCommand {\r\n  constructor(public info?: string) {}\r\n  async exec(instance: any): Promise<any> {}\r\n  async stop(instance: any) {}\r\n}\r\n","import { $t } from \"../../../i18n\";\r\n\r\nexport function commandStringToArray(cmd: string) {\r\n  const QUOTES_KEY = \"{quotes}\";\r\n  let start = 0;\r\n  let len = cmd.length;\r\n  const cmdArray: string[] = [];\r\n  function _analyze() {\r\n    for (let index = start; index < len; index++) {\r\n      const ch = cmd[index];\r\n      if (ch === \" \") {\r\n        findSpace(index);\r\n        start++;\r\n        continue;\r\n      }\r\n      if (ch === '\"') {\r\n        index = findQuotes(index);\r\n      }\r\n      if (index + 1 >= len) {\r\n        findEnd();\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  function findEnd() {\r\n    return cmdArray.push(cmd.slice(start));\r\n  }\r\n\r\n  function findSpace(endPoint: number) {\r\n    if (endPoint != start) {\r\n      const elem = cmd.slice(start, endPoint);\r\n      start = endPoint;\r\n      return cmdArray.push(elem);\r\n    }\r\n  }\r\n\r\n  function findQuotes(p: number) {\r\n    for (let index = p + 1; index < len; index++) {\r\n      const ch = cmd[index];\r\n      if (ch === '\"') return index;\r\n    }\r\n    throw new Error($t(\"TXT_CODE_command.quotes\"));\r\n  }\r\n\r\n  _analyze();\r\n\r\n  if (cmdArray.length == 0) {\r\n    return [];\r\n  }\r\n\r\n  for (const index in cmdArray) {\r\n    const element = cmdArray[index];\r\n    if (element[0] === '\"' && element[element.length - 1] === '\"')\r\n      cmdArray[index] = element.slice(1, element.length - 1);\r\n    while (cmdArray[index].indexOf(QUOTES_KEY) != -1)\r\n      cmdArray[index] = cmdArray[index].replace(QUOTES_KEY, '\"');\r\n  }\r\n\r\n  return cmdArray;\r\n}\r\n","import Instance from \"../instance/instance\";\r\nimport InstanceCommand from \"./base/command\";\r\n\r\nexport default class SendCommand extends InstanceCommand {\r\n  public cmd: string;\r\n\r\n  constructor(cmd: string) {\r\n    super(\"SendCommand\");\r\n    this.cmd = cmd;\r\n  }\r\n\r\n  async exec(instance: Instance) {\r\n    return await instance.execPreset(\"command\", this.cmd);\r\n  }\r\n}\r\n","import Instance from \"../instance/instance\";\r\nimport InstanceCommand from \"./base/command\";\r\nimport NullCommand from \"./nullfunc\";\r\nimport GeneralStartCommand from \"./general/general_start\";\r\nimport GeneralStopCommand from \"./general/general_stop\";\r\nimport GeneralKillCommand from \"./general/general_kill\";\r\nimport GeneralSendCommand from \"./general/general_command\";\r\nimport GeneralRestartCommand from \"./general/general_restart\";\r\nimport DockerStartCommand from \"./docker/docker_start\";\r\nimport TimeCheck from \"./task/time\";\r\nimport GeneralUpdateCommand from \"./general/general_update\";\r\nimport PtyStartCommand from \"./pty/pty_start\";\r\nimport PtyStopCommand from \"./pty/pty_stop\";\r\nimport OpenFrpTask from \"./task/openfrp\";\r\nimport RconCommand from \"./steam/rcon_command\";\r\nimport DockerResizeCommand from \"./docker/docker_pty_resize\";\r\nimport PtyResizeCommand from \"./pty/pty_resize\";\r\nimport GeneralInstallCommand from \"./general/general_install\";\r\n\r\n// If you add a new \"Preset\", Please add the definition here.\r\nexport type IPresetCommand =\r\n  | \"start\"\r\n  | \"stop\"\r\n  | \"restart\"\r\n  | \"kill\"\r\n  | \"update\"\r\n  | \"getPlayer\"\r\n  | \"command\"\r\n  | \"resize\"\r\n  | \"install\";\r\n\r\n// Instance function dispatcher\r\n// Dispatch and assign different functions according to different types\r\nexport default class FunctionDispatcher extends InstanceCommand {\r\n  constructor() {\r\n    super(\"FunctionDispatcher\");\r\n  }\r\n\r\n  async exec(instance: Instance) {\r\n    // initialize all modules\r\n    instance.lifeCycleTaskManager.clearLifeCycleTask();\r\n    instance.clearPreset();\r\n\r\n    // the component that the instance must mount\r\n    instance.lifeCycleTaskManager.registerLifeCycleTask(new TimeCheck());\r\n    instance.lifeCycleTaskManager.registerLifeCycleTask(new OpenFrpTask());\r\n\r\n    // Instance general preset capabilities\r\n    instance.setPreset(\"command\", new GeneralSendCommand());\r\n    instance.setPreset(\"stop\", new GeneralStopCommand());\r\n    instance.setPreset(\"kill\", new GeneralKillCommand());\r\n    instance.setPreset(\"restart\", new GeneralRestartCommand());\r\n    instance.setPreset(\"update\", new GeneralUpdateCommand());\r\n    instance.setPreset(\"getPlayer\", new NullCommand());\r\n    instance.setPreset(\"install\", new GeneralInstallCommand());\r\n\r\n    // Preset the basic operation mode according to the instance startup type\r\n    if (!instance.config.processType || instance.config.processType === \"general\") {\r\n      instance.setPreset(\"start\", new GeneralStartCommand());\r\n    }\r\n\r\n    // Enable emulated terminal mode\r\n    if (instance.config.terminalOption.pty && instance.config.processType === \"general\") {\r\n      instance.setPreset(\"start\", new PtyStartCommand());\r\n      instance.setPreset(\"stop\", new PtyStopCommand());\r\n      instance.setPreset(\"resize\", new PtyResizeCommand());\r\n    }\r\n    // Whether to enable Docker PTY mode\r\n    if (instance.config.processType === \"docker\") {\r\n      instance.setPreset(\"start\", new DockerStartCommand());\r\n      instance.setPreset(\"resize\", new DockerResizeCommand());\r\n    }\r\n    if (instance.config.enableRcon) {\r\n      instance.setPreset(\"command\", new RconCommand());\r\n    }\r\n\r\n    // Set different preset functions and functions according to different types\r\n    // No suitable implementation solution found, not supported for the time being.\r\n    // if (instance.config.type.includes(Instance.TYPE_UNIVERSAL)) {\r\n    //   instance.setPreset(\"getPlayer\", new NullCommand());\r\n    // }\r\n    // if (instance.config.type.includes(Instance.TYPE_MINECRAFT_JAVA)) {\r\n    //   instance.setPreset(\"getPlayer\", new MinecraftGetPlayersCommand());\r\n    //   instance.lifeCycleTaskManager.registerLifeCycleTask(new RefreshPlayer());\r\n    // }\r\n    // if (instance.config.type.includes(Instance.TYPE_MINECRAFT_BEDROCK)) {\r\n    //   instance.setPreset(\"getPlayer\", new MinecraftBedrockGetPlayersCommand());\r\n    //   instance.lifeCycleTaskManager.registerLifeCycleTask(new RefreshPlayer());\r\n    // }\r\n  }\r\n}\r\n","import Instance from \"../../instance/instance\";\r\nimport InstanceCommand from \"../base/command\";\r\nimport { DockerProcessAdapter } from \"../../../service/docker_process_service\";\r\n\r\nexport default class DockerResizeCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"ResizeTTY\");\r\n  }\r\n\r\n  async exec(instance: Instance): Promise<any> {\r\n    const dockerProcess = instance?.process as Partial<DockerProcessAdapter>;\r\n    if (typeof dockerProcess?.container?.resize === \"function\") {\r\n      const { w, h } = instance.computeTerminalSize();\r\n      await dockerProcess?.container?.resize({\r\n        h,\r\n        w\r\n      });\r\n    }\r\n  }\r\n}\r\n","import Docker from \"dockerode\";\r\nimport Instance from \"../../instance/instance\";\r\nimport InstanceCommand from \"../base/command\";\r\nimport { t } from \"i18next\";\r\n\r\nexport async function checkImage(name: string) {\r\n  const docker = new Docker();\r\n  try {\r\n    const image = docker.getImage(name);\r\n    const info = await image.inspect();\r\n    return info.Size > 0 ? true : false;\r\n  } catch (error: any) {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport default class DockerPullCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"DockerPullCommand\");\r\n  }\r\n\r\n  private stopFlag = false;\r\n\r\n  private stopped(instance: Instance) {\r\n    this.stopFlag = true;\r\n    instance.asynchronousTask = undefined;\r\n  }\r\n\r\n  private awaitImageDone(instance: Instance, name: string) {\r\n    return new Promise((resolve, reject) => {\r\n      let count = 0;\r\n      const task = setInterval(async () => {\r\n        count++;\r\n        instance.println(\"CONTAINER\", t(\"TXT_CODE_977cb449\"));\r\n        if (await checkImage(name)) {\r\n          clearInterval(task);\r\n          resolve(true);\r\n        }\r\n        if (count >= 20 * 15) {\r\n          clearInterval(task);\r\n          reject(new Error(t(\"TXT_CODE_9cae6f92\")));\r\n        }\r\n        if (this.stopFlag) {\r\n          clearInterval(task);\r\n          reject(new Error(t(\"TXT_CODE_361a79c6\")));\r\n        }\r\n      }, 3 * 1000);\r\n    });\r\n  }\r\n\r\n  async exec(instance: Instance) {\r\n    const imageName = instance.config.docker.image;\r\n    if (!imageName) throw new Error(t(\"TXT_CODE_17be5f70\"));\r\n    const cachedStartCount = instance.startCount;\r\n    // If the image exists, there is no need to pull again.\r\n    if (await checkImage(imageName)) return;\r\n\r\n    try {\r\n      const docker = new Docker();\r\n      instance.println(\"CONTAINER\", t(\"TXT_CODE_2fa46b8c\") + imageName);\r\n      instance.asynchronousTask = this;\r\n\r\n      await docker.pull(imageName, {});\r\n\r\n      await this.awaitImageDone(instance, imageName);\r\n      if (cachedStartCount !== instance.startCount) return;\r\n      instance.println(\"CONTAINER\", t(\"TXT_CODE_c68b0bef\"));\r\n    } catch (err: any) {\r\n      if (cachedStartCount !== instance.startCount) return;\r\n      throw new Error([t(\"TXT_CODE_db37b7f9\"), err?.message].join(\"\\n\"));\r\n    } finally {\r\n      this.stopped(instance);\r\n    }\r\n  }\r\n\r\n  async stop(instance: Instance): Promise<void> {\r\n    this.stopped(instance);\r\n  }\r\n}\r\n","import { $t } from \"../../../i18n\";\r\nimport Instance from \"../../instance/instance\";\r\nimport InstanceCommand from \"../base/command\";\r\nimport logger from \"../../../service/log\";\r\nimport fs from \"fs-extra\";\r\nimport { t } from \"i18next\";\r\nimport DockerPullCommand from \"./docker_pull\";\r\nimport {\r\n  DockerProcessAdapter,\r\n  SetupDockerContainer,\r\n  StartupDockerProcessError\r\n} from \"../../../service/docker_process_service\";\r\n\r\nexport default class DockerStartCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"DockerStartCommand\");\r\n  }\r\n\r\n  async exec(instance: Instance, source = \"Unknown\") {\r\n    if (!instance.config.cwd || !instance.config.ie || !instance.config.oe)\r\n      throw new StartupDockerProcessError($t(\"TXT_CODE_instance.dirEmpty\"));\r\n    if (!fs.existsSync(instance.absoluteCwdPath()))\r\n      throw new StartupDockerProcessError($t(\"TXT_CODE_instance.dirNoE\"));\r\n\r\n    // Docker Image check\r\n    try {\r\n      await instance.forceExec(new DockerPullCommand());\r\n    } catch (error: any) {\r\n      throw error;\r\n    }\r\n\r\n    // Docker docks to the process adapter\r\n    const isTty = instance.config.terminalOption.pty;\r\n    const workingDir = instance.config.docker.workingDir ?? \"/workspace/\";\r\n    const processAdapter = new DockerProcessAdapter(new SetupDockerContainer(instance));\r\n    await processAdapter.start({\r\n      isTty,\r\n      w: instance.config.terminalOption.ptyWindowCol,\r\n      h: instance.config.terminalOption.ptyWindowCol\r\n    });\r\n\r\n    instance.println(\"CONTAINER\", t(\"TXT_CODE_e76e49e9\") + workingDir);\r\n    instance.started(processAdapter);\r\n    logger.info(\r\n      $t(\"TXT_CODE_instance.successful\", {\r\n        v: `${instance.config.nickname} ${instance.instanceUuid}`\r\n      })\r\n    );\r\n  }\r\n}\r\n","import { $t } from \"../../../i18n\";\r\n\r\nimport Instance from \"../../instance/instance\";\r\nimport { encode } from \"iconv-lite\";\r\nimport InstanceCommand from \"../base/command\";\r\n\r\nexport default class GeneralSendCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"SendCommand\");\r\n  }\r\n\r\n  async exec(instance: Instance, buf?: any): Promise<any> {\r\n    // The server shutdown command needs to send a command, but before the server shutdown command is executed, the status will be set to the shutdown state.\r\n    // So here the command can only be executed by whether the process exists or not\r\n    if (instance?.process) {\r\n      instance.process.write(encode(buf, instance.config.oe));\r\n      if (instance.config.crlf === 2) return instance.process.write(\"\\r\\n\");\r\n      return instance.process.write(\"\\n\");\r\n    } else {\r\n      instance.failure(new Error($t(\"TXT_CODE_command.instanceNotOpen\")));\r\n    }\r\n  }\r\n}\r\n","import { $t } from \"../../../i18n\";\r\nimport Instance from \"../../instance/instance\";\r\nimport InstanceCommand from \"../base/command\";\r\nimport fs from \"fs-extra\";\r\nimport { QuickInstallTask } from \"../../../service/async_task_service/quick_install\";\r\nimport { IQuickStartPackages } from \"common/global\";\r\n\r\nexport default class GeneralInstallCommand extends InstanceCommand {\r\n  private process?: QuickInstallTask;\r\n\r\n  constructor() {\r\n    super(\"GeneralInstallCommand\");\r\n  }\r\n\r\n  private stopped(instance: Instance) {\r\n    instance.asynchronousTask = undefined;\r\n    instance.setLock(false);\r\n    instance.status(Instance.STATUS_STOP);\r\n  }\r\n\r\n  async exec(instance: Instance, params?: IQuickStartPackages) {\r\n    if (instance.status() !== Instance.STATUS_STOP)\r\n      return instance.failure(new Error($t(\"TXT_CODE_general_update.statusErr_notStop\")));\r\n    if (instance.asynchronousTask)\r\n      return instance.failure(new Error($t(\"TXT_CODE_general_update.statusErr_otherProgress\")));\r\n    if (!params) throw new Error(\"GeneralInstallCommand: No params\");\r\n    try {\r\n      instance.setLock(true);\r\n      instance.status(Instance.STATUS_BUSY);\r\n      instance.println($t(\"TXT_CODE_1704ea49\"), $t(\"TXT_CODE_cbc235ad\"));\r\n      if (instance.config.cwd.length > 1) {\r\n        fs.removeSync(instance.config.cwd);\r\n        fs.mkdirsSync(instance.config.cwd);\r\n      }\r\n      instance.println($t(\"TXT_CODE_1704ea49\"), $t(\"TXT_CODE_906c5d6a\"));\r\n      this.process = new QuickInstallTask(\r\n        instance.config.nickname,\r\n        params.targetLink,\r\n        params.setupInfo,\r\n        instance\r\n      );\r\n      instance.asynchronousTask = this;\r\n      instance.println($t(\"TXT_CODE_1704ea49\"), $t(\"TXT_CODE_b9ca022b\"));\r\n      await this.process.start();\r\n      await this.process.wait();\r\n\r\n      instance.println($t(\"TXT_CODE_1704ea49\"), $t(\"TXT_CODE_f220ed78\"));\r\n    } catch (err: any) {\r\n      instance.println(\r\n        $t(\"TXT_CODE_general_update.update\"),\r\n        $t(\"TXT_CODE_general_update.error\", { err })\r\n      );\r\n    } finally {\r\n      this.stopped(instance);\r\n    }\r\n  }\r\n\r\n  async stop(instance: Instance): Promise<void> {\r\n    instance.println(\r\n      $t(\"TXT_CODE_general_update.update\"),\r\n      $t(\"TXT_CODE_general_update.killProcess\")\r\n    );\r\n    this.stopped(instance);\r\n    await this.process?.stop();\r\n  }\r\n}\r\n","import logger from \"../../../service/log\";\r\nimport Instance from \"../../instance/instance\";\r\nimport InstanceCommand from \"../base/command\";\r\n\r\nexport default class GeneralKillCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"KillCommand\");\r\n  }\r\n\r\n  async exec(instance: Instance) {\r\n    const task = instance?.asynchronousTask;\r\n    if (task && task.stop) {\r\n      task\r\n        .stop(instance)\r\n        .then(() => {})\r\n        .catch((err) => {\r\n          logger.error(`Instance ${instance.config.nickname} asynchronousTask stop error:`, err);\r\n        });\r\n    }\r\n    if (instance.process) {\r\n      await instance.process.kill(\"SIGKILL\");\r\n    }\r\n    instance.setLock(false);\r\n  }\r\n}\r\n","import { $t } from \"../../../i18n\";\r\nimport Instance from \"../../instance/instance\";\r\nimport InstanceCommand from \"../base/command\";\r\n\r\nexport default class GeneralRestartCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"GeneralRestartCommand\");\r\n  }\r\n\r\n  async exec(instance: Instance) {\r\n    try {\r\n      instance.println(\"INFO\", $t(\"TXT_CODE_restart.start\"));\r\n      await instance.execPreset(\"stop\");\r\n      instance.setLock(true);\r\n      const startCount = instance.startCount;\r\n      // Check the instance status every second,\r\n      // if the instance status is stopped, restart the server immediately\r\n      const task = setInterval(async () => {\r\n        try {\r\n          if (startCount !== instance.startCount) {\r\n            throw new Error($t(\"TXT_CODE_restart.error1\"));\r\n          }\r\n          if (\r\n            instance.status() !== Instance.STATUS_STOPPING &&\r\n            instance.status() !== Instance.STATUS_STOP\r\n          ) {\r\n            throw new Error($t(\"TXT_CODE_restart.error2\"));\r\n          }\r\n          if (instance.status() === Instance.STATUS_STOP) {\r\n            instance.println(\"INFO\", $t(\"TXT_CODE_restart.restarting\"));\r\n            await instance.execPreset(\"start\");\r\n            instance.setLock(false);\r\n            clearInterval(task);\r\n          }\r\n        } catch (error: any) {\r\n          clearInterval(task);\r\n          instance.setLock(false);\r\n          instance.failure(error);\r\n        }\r\n      }, 1000);\r\n    } catch (error: any) {\r\n      instance.setLock(false);\r\n      instance.failure(error);\r\n    }\r\n  }\r\n}\r\n","import { $t } from \"../../../i18n\";\r\nimport os from \"os\";\r\nimport Instance from \"../../instance/instance\";\r\nimport logger from \"../../../service/log\";\r\nimport fs from \"fs-extra\";\r\nimport InstanceCommand from \"../base/command\";\r\nimport EventEmitter from \"events\";\r\nimport { IInstanceProcess } from \"../../instance/interface\";\r\nimport { ChildProcess, exec, spawn } from \"child_process\";\r\nimport { commandStringToArray } from \"../base/command_parser\";\r\nimport { killProcess } from \"common\";\r\n\r\n// Error exception at startup\r\nclass StartupError extends Error {\r\n  constructor(msg: string) {\r\n    super(msg);\r\n  }\r\n}\r\n\r\n// Docker process adapter\r\nclass ProcessAdapter extends EventEmitter implements IInstanceProcess {\r\n  pid?: number | string;\r\n\r\n  constructor(private process: ChildProcess) {\r\n    super();\r\n    this.pid = this.process.pid;\r\n    process.stdout?.on(\"data\", (text) => this.emit(\"data\", text));\r\n    process.stderr?.on(\"data\", (text) => this.emit(\"data\", text));\r\n    process.on(\"exit\", (code) => this.emit(\"exit\", code));\r\n  }\r\n\r\n  public write(data?: string) {\r\n    return this.process.stdin?.write(data);\r\n  }\r\n\r\n  public kill(s?: any) {\r\n    if (this.pid) return killProcess(this.pid, this.process, s);\r\n  }\r\n\r\n  public async destroy() {\r\n    // remove all dynamically added event listeners\r\n    for (const n of this.eventNames()) this.removeAllListeners(n);\r\n    if (this.process.stdout)\r\n      for (const eventName of this.process.stdout.eventNames())\r\n        this.process.stdout.removeAllListeners(eventName);\r\n    if (this.process.stderr)\r\n      for (const eventName of this.process.stderr.eventNames())\r\n        this.process.stderr.removeAllListeners(eventName);\r\n    if (this.process)\r\n      for (const eventName of this.process.eventNames()) this.process.removeAllListeners(eventName);\r\n    this.process?.stdout?.destroy();\r\n    this.process?.stderr?.destroy();\r\n    if (this.process?.exitCode === null) {\r\n      this.process.kill(\"SIGTERM\");\r\n      this.process.kill(\"SIGKILL\");\r\n    }\r\n  }\r\n}\r\n\r\nexport default class GeneralStartCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"StartCommand\");\r\n  }\r\n\r\n  async exec(instance: Instance, source = \"Unknown\") {\r\n    if (\r\n      (!instance.config.startCommand && instance.config.processType === \"general\") ||\r\n      !instance.config.cwd ||\r\n      !instance.config.ie ||\r\n      !instance.config.oe\r\n    )\r\n      throw new StartupError($t(\"TXT_CODE_general_start.instanceConfigErr\"));\r\n    if (!fs.existsSync(instance.absoluteCwdPath()))\r\n      throw new StartupError($t(\"TXT_CODE_general_start.cwdPathNotExist\"));\r\n\r\n    // command parsing\r\n    const commandList = commandStringToArray(instance.config.startCommand);\r\n    const commandExeFile = commandList[0];\r\n    const commandParameters = commandList.slice(1);\r\n    if (commandList.length === 0) {\r\n      throw new StartupError($t(\"TXT_CODE_general_start.cmdEmpty\"));\r\n    }\r\n\r\n    logger.info(\"----------------\");\r\n    logger.info($t(\"TXT_CODE_general_start.startInstance\", { source: source }));\r\n    logger.info($t(\"TXT_CODE_general_start.instanceUuid\", { uuid: instance.instanceUuid }));\r\n    logger.info($t(\"TXT_CODE_general_start.startCmd\", { cmdList: JSON.stringify(commandList) }));\r\n    logger.info($t(\"TXT_CODE_general_start.cwd\", { cwd: instance.config.cwd }));\r\n    logger.info(\"----------------\");\r\n\r\n    // create child process\r\n    // Parameter 1 directly passes the process name or path (including spaces) without double quotes\r\n    const subProcess = spawn(commandExeFile, commandParameters, {\r\n      cwd: instance.config.cwd,\r\n      stdio: \"pipe\",\r\n      windowsHide: true,\r\n      env: process.env\r\n    });\r\n\r\n    // child process creation result check\r\n    if (!subProcess || !subProcess.pid) {\r\n      instance.println(\r\n        \"ERROR\",\r\n        $t(\"TXT_CODE_general_start.pidErr\", {\r\n          startCommand: instance.config.startCommand,\r\n          commandExeFile: commandExeFile,\r\n          commandParameters: JSON.stringify(commandParameters)\r\n        })\r\n      );\r\n      throw new StartupError($t(\"TXT_CODE_general_start.startErr\"));\r\n    }\r\n\r\n    // create process adapter\r\n    const processAdapter = new ProcessAdapter(subProcess);\r\n\r\n    // generate open event\r\n    instance.started(processAdapter);\r\n    logger.info(\r\n      $t(\"TXT_CODE_general_start.startSuccess\", {\r\n        instanceUuid: instance.instanceUuid,\r\n        pid: subProcess.pid\r\n      })\r\n    );\r\n    instance.println(\"INFO\", $t(\"TXT_CODE_general_start.startOrdinaryTerminal\"));\r\n  }\r\n}\r\n","import { $t } from \"../../../i18n\";\r\nimport Instance from \"../../instance/instance\";\r\nimport InstanceCommand from \"../base/command\";\r\nimport SendCommand from \"../cmd\";\r\n\r\nexport default class GeneralStopCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"StopCommand\");\r\n  }\r\n\r\n  async exec(instance: Instance) {\r\n    const stopCommand = instance.config.stopCommand;\r\n    if (instance.status() === Instance.STATUS_STOP || !instance.process)\r\n      return instance.failure(new Error($t(\"TXT_CODE_general_stop.notRunning\")));\r\n\r\n    instance.status(Instance.STATUS_STOPPING);\r\n\r\n    const stopCommandList = stopCommand.split(\"\\n\");\r\n    for (const stopCommandColumn of stopCommandList) {\r\n      if (stopCommandColumn.toLocaleLowerCase() == \"^c\") {\r\n        instance.process.kill(\"SIGINT\");\r\n      } else {\r\n        await instance.exec(new SendCommand(stopCommandColumn));\r\n      }\r\n    }\r\n\r\n    instance.print(\"\\n\");\r\n    instance.println(\"INFO\", $t(\"TXT_CODE_general_stop.execCmd\", { stopCommand }));\r\n    const cacheStartCount = instance.startCount;\r\n\r\n    // If the instance is still in the stopped state after 10 minutes, restore the state\r\n    setTimeout(() => {\r\n      if (\r\n        instance.status() === Instance.STATUS_STOPPING &&\r\n        instance.startCount === cacheStartCount\r\n      ) {\r\n        instance.println(\"ERROR\", $t(\"TXT_CODE_general_stop.stopErr\"));\r\n        instance.status(Instance.STATUS_RUNNING);\r\n      }\r\n    }, 1000 * 60 * 10);\r\n\r\n    return instance;\r\n  }\r\n}\r\n","import { $t } from \"../../../i18n\";\r\nimport logger from \"../../../service/log\";\r\nimport Instance from \"../../instance/instance\";\r\nimport InstanceCommand from \"../base/command\";\r\nimport { InstanceUpdateAction } from \"../../../service/instance_update_action\";\r\n\r\nexport default class GeneralUpdateCommand extends InstanceCommand {\r\n  private updateTask?: InstanceUpdateAction;\r\n\r\n  constructor() {\r\n    super(\"GeneralUpdateCommand\");\r\n  }\r\n\r\n  private stopped(instance: Instance) {\r\n    instance.asynchronousTask = undefined;\r\n    instance.setLock(false);\r\n    instance.status(Instance.STATUS_STOP);\r\n  }\r\n\r\n  async exec(instance: Instance) {\r\n    if (instance.status() !== Instance.STATUS_STOP && instance.status() !== Instance.STATUS_BUSY)\r\n      return instance.failure(new Error($t(\"TXT_CODE_general_update.statusErr_notStop\")));\r\n    if (instance.asynchronousTask)\r\n      return instance.failure(new Error($t(\"TXT_CODE_general_update.statusErr_otherProgress\")));\r\n\r\n    try {\r\n      instance.setLock(true);\r\n      instance.asynchronousTask = this;\r\n      instance.status(Instance.STATUS_BUSY);\r\n\r\n      this.updateTask = new InstanceUpdateAction(instance);\r\n      await this.updateTask.start();\r\n      await this.updateTask.wait();\r\n    } catch (err: any) {\r\n      instance.println(\r\n        $t(\"TXT_CODE_general_update.update\"),\r\n        $t(\"TXT_CODE_general_update.error\", { err: err })\r\n      );\r\n    } finally {\r\n      this.stopped(instance);\r\n    }\r\n  }\r\n\r\n  async stop(instance: Instance): Promise<void> {\r\n    instance.asynchronousTask = undefined;\r\n    logger.info(\r\n      $t(\"TXT_CODE_general_update.terminateUpdate\", { instanceUuid: instance.instanceUuid })\r\n    );\r\n    instance.println(\r\n      $t(\"TXT_CODE_general_update.update\"),\r\n      $t(\"TXT_CODE_general_update.terminateUpdate\", { instanceUuid: instance.instanceUuid })\r\n    );\r\n    instance.println(\r\n      $t(\"TXT_CODE_general_update.update\"),\r\n      $t(\"TXT_CODE_general_update.killProcess\")\r\n    );\r\n\r\n    await this.updateTask?.stop();\r\n  }\r\n}\r\n","import Instance from \"../instance/instance\";\r\nimport InstanceCommand from \"./base/command\";\r\n\r\nexport default class KillCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"KillCommand\");\r\n  }\r\n\r\n  async exec(instance: Instance) {\r\n    // If the automatic restart function is enabled, the setting is ignored once\r\n    if (instance.config.eventTask && instance.config.eventTask.autoRestart)\r\n      instance.config.eventTask.ignore = true;\r\n\r\n    // send stop command\r\n    return await instance.execPreset(\"kill\");\r\n  }\r\n}\r\n","import InstanceCommand from \"./base/command\";\r\n\r\nexport default class NullCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"NullCommand\");\r\n  }\r\n  async exec() {\r\n    // Do nothing.....\r\n  }\r\n}\r\n","import { ProcessConfig } from \"../instance/process_config\";\r\nimport pidusage from \"pidusage\";\r\nimport InstanceCommand from \"./base/command\";\r\nimport Instance from \"../instance/instance\";\r\n\r\nexport default class ProcessInfoCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"ProcessInfo\");\r\n  }\r\n  async exec(instance: Instance): Promise<Object> {\r\n    let info: any = {\r\n      cpu: 0, // percentage (from 0 to 100*vcore)\r\n      memory: 0, // bytes\r\n      ppid: 0, // PPID\r\n      pid: 0, // PID\r\n      ctime: 0, // ms user + system time\r\n      elapsed: 0, // ms since the start of the process\r\n      timestamp: 0 // ms since epoch\r\n    };\r\n    if (instance.process && instance.process.pid) {\r\n      info = await pidusage(instance.process.pid);\r\n    }\r\n    return info;\r\n  }\r\n}\r\n","import Instance from \"../../instance/instance\";\r\nimport InstanceCommand from \"../base/command\";\r\nimport { GoPtyProcessAdapter } from \"./pty_start\";\r\n\r\nexport default class PtyResizeCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"ResizeTTY\");\r\n  }\r\n\r\n  async exec(instance: Instance): Promise<any> {\r\n    const pty = instance.process as Partial<GoPtyProcessAdapter>;\r\n    if (typeof pty?.resize === \"function\") {\r\n      const { w, h } = instance.computeTerminalSize();\r\n      pty?.resize(w, h);\r\n    }\r\n  }\r\n}\r\n","import { $t } from \"../../../i18n\";\r\nimport os from \"os\";\r\nimport Instance from \"../../instance/instance\";\r\nimport logger from \"../../../service/log\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport readline from \"readline\";\r\nimport InstanceCommand from \"../base/command\";\r\nimport EventEmitter from \"events\";\r\nimport { IInstanceProcess } from \"../../instance/interface\";\r\nimport { ChildProcess, ChildProcessWithoutNullStreams, exec, spawn } from \"child_process\";\r\nimport { commandStringToArray } from \"../base/command_parser\";\r\nimport { killProcess } from \"common\";\r\nimport FunctionDispatcher from \"../dispatcher\";\r\nimport { PTY_PATH } from \"../../../const\";\r\nimport { Writable } from \"stream\";\r\n\r\ninterface IPtySubProcessCfg {\r\n  pid: number;\r\n}\r\n\r\n// Error exception at startup\r\nclass StartupError extends Error {\r\n  constructor(msg: string) {\r\n    super(msg);\r\n  }\r\n}\r\n\r\nconst GO_PTY_MSG_TYPE = {\r\n  RESIZE: 0x04\r\n};\r\n\r\n// process adapter\r\nexport class GoPtyProcessAdapter extends EventEmitter implements IInstanceProcess {\r\n  private pipeClient?: Writable;\r\n\r\n  constructor(private process: ChildProcess, public pid: number, public pipeName: string) {\r\n    super();\r\n    process.stdout?.on(\"data\", (text) => this.emit(\"data\", text));\r\n    process.stderr?.on(\"data\", (text) => this.emit(\"data\", text));\r\n    process.on(\"exit\", (code) => this.emit(\"exit\", code));\r\n    try {\r\n      this.initNamedPipe();\r\n    } catch (error: any) {\r\n      logger.error(`Init Pipe Err: ${pipeName}, ${error}`);\r\n    }\r\n  }\r\n\r\n  private initNamedPipe() {\r\n    const fd = fs.openSync(this.pipeName, \"w\");\r\n    const writePipe = fs.createWriteStream(\"\", { fd });\r\n    writePipe.on(\"close\", () => {});\r\n    writePipe.on(\"end\", () => {});\r\n    writePipe.on(\"error\", (err) => {\r\n      logger.error(\"Pipe error:\", this.pipeName, err);\r\n    });\r\n    this.pipeClient = writePipe;\r\n  }\r\n\r\n  public resize(w: number, h: number) {\r\n    const MAX_W = 900;\r\n    if (w > MAX_W) w = MAX_W;\r\n    if (h > MAX_W) h = MAX_W;\r\n    const resizeStruct = JSON.stringify({ width: Number(w), height: Number(h) });\r\n    const len = resizeStruct.length;\r\n    const lenBuff = Buffer.alloc(2);\r\n    lenBuff.writeInt16BE(len, 0);\r\n    const buf = Buffer.from([GO_PTY_MSG_TYPE.RESIZE, ...lenBuff, ...Buffer.from(resizeStruct)]);\r\n    this.writeToNamedPipe(buf);\r\n  }\r\n\r\n  public writeToNamedPipe(data: Buffer) {\r\n    this.pipeClient?.write(data);\r\n  }\r\n\r\n  public write(data?: string) {\r\n    return this.process.stdin?.write(data);\r\n  }\r\n\r\n  public kill(s?: any) {\r\n    return killProcess(this.pid, this.process, s);\r\n  }\r\n\r\n  public async destroy() {\r\n    for (const n of this.eventNames()) this.removeAllListeners(n);\r\n    if (this.process.stdout)\r\n      for (const eventName of this.process.stdout.eventNames())\r\n        this.process.stdout.removeAllListeners(eventName);\r\n    if (this.process.stderr)\r\n      for (const eventName of this.process.stderr.eventNames())\r\n        this.process.stderr.removeAllListeners(eventName);\r\n    if (this.process)\r\n      for (const eventName of this.process.eventNames())\r\n        this.process.stdout?.removeAllListeners(eventName);\r\n    if (this.pipeClient)\r\n      for (const eventName of this.pipeClient.eventNames())\r\n        this.pipeClient.removeAllListeners(eventName);\r\n    this.pipeClient?.destroy();\r\n    this.process?.stdout?.destroy();\r\n    this.process?.stderr?.destroy();\r\n    if (this.process?.exitCode === null) {\r\n      this.process.kill(\"SIGTERM\");\r\n      this.process.kill(\"SIGKILL\");\r\n    }\r\n    fs.remove(this.pipeName, (err) => {});\r\n  }\r\n}\r\n\r\nexport default class PtyStartCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"PtyStartCommand\");\r\n  }\r\n\r\n  readPtySubProcessConfig(subProcess: ChildProcessWithoutNullStreams): Promise<IPtySubProcessCfg> {\r\n    return new Promise((r, j) => {\r\n      const errConfig = {\r\n        pid: 0\r\n      };\r\n      const rl = readline.createInterface({\r\n        input: subProcess.stdout,\r\n        crlfDelay: Infinity\r\n      });\r\n      rl.on(\"line\", (line = \"\") => {\r\n        try {\r\n          rl.removeAllListeners();\r\n          const cfg = JSON.parse(line) as IPtySubProcessCfg;\r\n          if (cfg.pid == null) throw new Error(\"Error\");\r\n          r(cfg);\r\n        } catch (error: any) {\r\n          r(errConfig);\r\n        }\r\n      });\r\n      setTimeout(() => {\r\n        r(errConfig);\r\n      }, 1000 * 3);\r\n    });\r\n  }\r\n\r\n  async exec(instance: Instance, source = \"Unknown\") {\r\n    if (\r\n      !instance.config.startCommand ||\r\n      !instance.config.cwd ||\r\n      !instance.config.ie ||\r\n      !instance.config.oe\r\n    )\r\n      throw new StartupError($t(\"TXT_CODE_pty_start.cmdErr\"));\r\n    if (!fs.existsSync(instance.absoluteCwdPath()))\r\n      throw new StartupError($t(\"TXT_CODE_pty_start.cwdNotExist\"));\r\n    if (!path.isAbsolute(path.normalize(instance.config.cwd)))\r\n      throw new StartupError($t(\"TXT_CODE_pty_start.mustAbsolutePath\"));\r\n\r\n    // PTY mode correctness check\r\n    logger.info($t(\"TXT_CODE_pty_start.startPty\", { source: source }));\r\n    let checkPtyEnv = true;\r\n\r\n    if (!fs.existsSync(PTY_PATH)) {\r\n      instance.println(\"ERROR\", $t(\"TXT_CODE_pty_start.startErr\"));\r\n      checkPtyEnv = false;\r\n    }\r\n\r\n    if (checkPtyEnv === false) {\r\n      // Close the PTY type, reconfigure the instance function group, and restart the instance\r\n      instance.config.terminalOption.pty = false;\r\n      await instance.forceExec(new FunctionDispatcher());\r\n      await instance.execPreset(\"start\", source); // execute the preset command directly\r\n      return;\r\n    }\r\n\r\n    // Set the startup state & increase the number of startups\r\n    instance.setLock(true);\r\n    instance.status(Instance.STATUS_STARTING);\r\n    instance.startCount++;\r\n\r\n    // command parsing\r\n    let commandList: string[] = [];\r\n    if (os.platform() === \"win32\") {\r\n      // windows: cmd.exe  /c {{startCommand}}\r\n      commandList = [instance.config.startCommand];\r\n    } else {\r\n      commandList = commandStringToArray(instance.config.startCommand);\r\n    }\r\n\r\n    if (commandList.length === 0)\r\n      return instance.failure(new StartupError($t(\"TXT_CODE_pty_start.cmdEmpty\")));\r\n\r\n    const pipeLinuxDir = \"/tmp/mcsmanager-instance-pipe\";\r\n    if (!fs.existsSync(pipeLinuxDir)) fs.mkdirsSync(pipeLinuxDir);\r\n    let pipeName = `${pipeLinuxDir}/pipe-${instance.instanceUuid}`;\r\n    if (os.platform() === \"win32\") {\r\n      pipeName = `\\\\\\\\.\\\\pipe\\\\mcsmanager-${instance.instanceUuid}`;\r\n    }\r\n\r\n    const ptyParameter = [\r\n      \"-size\",\r\n      `${instance.config.terminalOption.ptyWindowCol},${instance.config.terminalOption.ptyWindowRow}`,\r\n      \"-coder\",\r\n      instance.config.oe,\r\n      \"-dir\",\r\n      instance.config.cwd,\r\n      \"-fifo\",\r\n      pipeName,\r\n      \"-cmd\",\r\n      JSON.stringify(commandList)\r\n    ];\r\n\r\n    logger.info(\"----------------\");\r\n    logger.info($t(\"TXT_CODE_pty_start.sourceRequest\", { source: source }));\r\n    logger.info($t(\"TXT_CODE_pty_start.instanceUuid\", { instanceUuid: instance.instanceUuid }));\r\n    logger.info($t(\"TXT_CODE_pty_start.startCmd\", { cmd: commandList.join(\" \") }));\r\n    logger.info($t(\"TXT_CODE_pty_start.ptyPath\", { path: PTY_PATH }));\r\n    logger.info($t(\"TXT_CODE_pty_start.ptyParams\", { param: ptyParameter.join(\" \") }));\r\n    logger.info($t(\"TXT_CODE_pty_start.ptyCwd\", { cwd: instance.config.cwd }));\r\n    logger.info(\"----------------\");\r\n\r\n    // create pty child process\r\n    // Parameter 1 directly passes the process name or path (including spaces) without double quotes\r\n    const subProcess = spawn(PTY_PATH, ptyParameter, {\r\n      cwd: path.dirname(PTY_PATH),\r\n      stdio: \"pipe\",\r\n      windowsHide: true,\r\n      env: {\r\n        ...process.env,\r\n        TERM: \"xterm-256color\"\r\n      }\r\n    });\r\n\r\n    // pty child process creation result check\r\n    if (!subProcess || !subProcess.pid) {\r\n      instance.println(\r\n        \"ERROR\",\r\n        $t(\"TXT_CODE_pty_start.pidErr\", {\r\n          startCommand: instance.config.startCommand,\r\n          path: PTY_PATH,\r\n          params: JSON.stringify(ptyParameter)\r\n        })\r\n      );\r\n      throw new StartupError($t(\"TXT_CODE_pty_start.instanceStartErr\"));\r\n    }\r\n\r\n    // create process adapter\r\n    const ptySubProcessCfg = await this.readPtySubProcessConfig(subProcess);\r\n    const processAdapter = new GoPtyProcessAdapter(subProcess, ptySubProcessCfg.pid, pipeName);\r\n    logger.info(`pty.exe response: ${JSON.stringify(ptySubProcessCfg)}`);\r\n\r\n    // After reading the configuration, Need to check the process status\r\n    // The \"processAdapter.pid\" here represents the process created by the PTY process\r\n    if (subProcess.exitCode !== null || processAdapter.pid == null || processAdapter.pid === 0) {\r\n      instance.println(\r\n        \"ERROR\",\r\n        $t(\"TXT_CODE_pty_start.pidErr\", {\r\n          startCommand: instance.config.startCommand,\r\n          path: PTY_PATH,\r\n          params: JSON.stringify(ptyParameter)\r\n        })\r\n      );\r\n      throw new StartupError($t(\"TXT_CODE_pty_start.instanceStartErr\"));\r\n    }\r\n\r\n    // generate open event\r\n    instance.started(processAdapter);\r\n\r\n    logger.info(\r\n      $t(\"TXT_CODE_pty_start.startSuccess\", {\r\n        instanceUuid: instance.instanceUuid,\r\n        pid: ptySubProcessCfg.pid\r\n      })\r\n    );\r\n    instance.println(\"INFO\", $t(\"TXT_CODE_pty_start.startEmulatedTerminal\"));\r\n  }\r\n}\r\n","import { $t } from \"../../../i18n\";\r\nimport Instance from \"../../instance/instance\";\r\nimport InstanceCommand from \"../base/command\";\r\nimport SendCommand from \"../cmd\";\r\n\r\nexport default class PtyStopCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"PtyStopCommand\");\r\n  }\r\n\r\n  async exec(instance: Instance) {\r\n    let stopCommand = instance.config.stopCommand;\r\n\r\n    if (instance.status() === Instance.STATUS_STOP || !instance.process)\r\n      return instance.failure(new Error($t(\"TXT_CODE_pty_stop.notRunning\")));\r\n    instance.status(Instance.STATUS_STOPPING);\r\n\r\n    instance.println(\"INFO\", $t(\"TXT_CODE_pty_stop.execCmd\", { stopCommand: stopCommand }));\r\n\r\n    const stopCommandList = stopCommand.split(\"\\n\");\r\n    for (const stopCommandColumn of stopCommandList) {\r\n      if (stopCommandColumn.toLocaleLowerCase() == \"^c\") {\r\n        await instance.exec(new SendCommand(\"\\x03\"));\r\n      } else {\r\n        await instance.exec(new SendCommand(stopCommandColumn));\r\n      }\r\n    }\r\n\r\n    // If the instance is still in the stopped state after 10 minutes, restore the state\r\n    const cacheStartCount = instance.startCount;\r\n    setTimeout(() => {\r\n      if (\r\n        instance.status() === Instance.STATUS_STOPPING &&\r\n        instance.startCount === cacheStartCount\r\n      ) {\r\n        instance.println(\"ERROR\", $t(\"TXT_CODE_pty_stop.stopErr\"));\r\n        instance.status(Instance.STATUS_RUNNING);\r\n      }\r\n    }, 1000 * 60 * 10);\r\n\r\n    return instance;\r\n  }\r\n}\r\n","import { $t } from \"../../i18n\";\r\nimport Instance from \"../instance/instance\";\r\nimport InstanceCommand from \"./base/command\";\r\n\r\nexport default class RestartCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"RestartCommand\");\r\n  }\r\n\r\n  async exec(instance: Instance) {\r\n    // If the automatic restart function is enabled, the setting is ignored once\r\n    if (instance.config.eventTask && instance.config.eventTask.autoRestart)\r\n      instance.config.eventTask.ignore = true;\r\n\r\n    if (instance.status() !== Instance.STATUS_RUNNING) {\r\n      throw new Error($t(\"TXT_CODE_d58ffa0f\"));\r\n    }\r\n\r\n    return await instance.execPreset(\"restart\");\r\n  }\r\n}\r\n","import { $t } from \"../../i18n\";\r\nimport Instance from \"../instance/instance\";\r\nimport InstanceCommand from \"./base/command\";\r\n\r\nclass StartupError extends Error {\r\n  constructor(msg: string) {\r\n    super(msg);\r\n  }\r\n}\r\n\r\nexport default class StartCommand extends InstanceCommand {\r\n  public source: string;\r\n\r\n  constructor(source = \"Unknown\") {\r\n    super(\"StartCommand\");\r\n    this.source = source;\r\n  }\r\n\r\n  private async sleep() {\r\n    return new Promise((ok) => {\r\n      setTimeout(ok, 1000 * 3);\r\n    });\r\n  }\r\n\r\n  async exec(instance: Instance) {\r\n    if (instance.status() !== Instance.STATUS_STOP)\r\n      return instance.failure(new StartupError($t(\"TXT_CODE_start.instanceNotDown\")));\r\n    try {\r\n      instance.setLock(true);\r\n      instance.status(Instance.STATUS_STARTING);\r\n      instance.startCount++;\r\n\r\n      // expiration time check\r\n      if (instance.config.endTime) {\r\n        const endTime = instance.config.endTime;\r\n        if (endTime) {\r\n          const currentTime = Date.now();\r\n          if (endTime <= currentTime) {\r\n            throw new Error($t(\"TXT_CODE_start.instanceMaturity\"));\r\n          }\r\n        }\r\n      }\r\n\r\n      const currentTimestamp = Date.now();\r\n      instance.startTimestamp = currentTimestamp;\r\n\r\n      instance.print(\"\\n\");\r\n      instance.println(\"INFO\", $t(\"TXT_CODE_start.startInstance\"));\r\n\r\n      // prevent the dead-loop from starting\r\n      await this.sleep();\r\n\r\n      return await instance.execPreset(\"start\", this.source);\r\n    } catch (error: any) {\r\n      try {\r\n        await instance.execPreset(\"kill\");\r\n      } catch (ignore) {}\r\n      instance.releaseResources();\r\n      instance.status(Instance.STATUS_STOP);\r\n      instance.failure(error);\r\n    } finally {\r\n      instance.setLock(false);\r\n    }\r\n  }\r\n}\r\n","import { t } from \"i18next\";\r\nimport Instance from \"../../instance/instance\";\r\nimport InstanceCommand from \"../base/command\";\r\nimport Rcon from \"rcon-srcds\";\r\n\r\nasync function sendRconCommand(instance: Instance, command: string) {\r\n  const targetIp = instance.config.rconIp || \"localhost\";\r\n  const rconServer = new Rcon({\r\n    port: instance.config.rconPort,\r\n    host: targetIp,\r\n    encoding: \"utf8\",\r\n    timeout: 1000 * 6\r\n  });\r\n  await rconServer.authenticate(instance.config.rconPassword);\r\n  if (!rconServer.isAuthenticated()) {\r\n    throw new Error(t(\"TXT_CODE_1b1b2934\"));\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    let hasResult = false;\r\n    setTimeout(() => {\r\n      if (!hasResult) {\r\n        rconServer.disconnect().catch(() => {});\r\n        instance.print(`[RCON] ${t(\"TXT_CODE_386f2d66\")}\\n`);\r\n        resolve(\"\");\r\n      }\r\n    }, 1000 * 10);\r\n    rconServer\r\n      .execute(command)\r\n      .then((res) => {\r\n        hasResult = true;\r\n        instance.print(`[RCON] ${res}\\n`);\r\n        rconServer.disconnect().catch(() => {});\r\n        resolve(res);\r\n      })\r\n      .catch((err) => {\r\n        reject(err);\r\n      });\r\n    instance.print(`[RCON] <<< ${command}\\n`);\r\n  });\r\n}\r\n\r\nexport default class RconCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"RconSendCommand\");\r\n  }\r\n\r\n  async exec(instance: Instance, text?: string): Promise<any> {\r\n    try {\r\n      if (text) await sendRconCommand(instance, text);\r\n    } catch (error: any) {\r\n      instance.println(\"RCON ERROR\", error?.message || error);\r\n    }\r\n  }\r\n}\r\n","import Instance from \"../instance/instance\";\r\nimport InstanceCommand from \"./base/command\";\r\nimport SendCommand from \"./cmd\";\r\n\r\nexport default class StopCommand extends InstanceCommand {\r\n  constructor() {\r\n    super(\"StopCommand\");\r\n  }\r\n\r\n  async exec(instance: Instance) {\r\n    // If the automatic restart function is enabled, the setting is ignored once\r\n    if (instance.config.eventTask && instance.config.eventTask.autoRestart)\r\n      instance.config.eventTask.ignore = true;\r\n\r\n    // send stop command\r\n    return await instance.execPreset(\"stop\");\r\n  }\r\n}\r\n","import { v4 } from \"uuid\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { spawn, ChildProcess } from \"child_process\";\r\nimport os from \"os\";\r\nimport { killProcess } from \"common\";\r\nimport { ILifeCycleTask } from \"../../instance/life_cycle\";\r\nimport Instance from \"../../instance/instance\";\r\nimport KillCommand from \"../kill\";\r\nimport logger from \"../../../service/log\";\r\nimport { $t } from \"../../../i18n\";\r\nimport { ProcessWrapper } from \"common\";\r\nimport { FRPC_PATH } from \"../../../const\";\r\nimport { downloadFileToLocalFile } from \"../../../service/download\";\r\nexport class OpenFrp {\r\n  public processWrapper?: ProcessWrapper;\r\n\r\n  constructor(public readonly token: string, public readonly tunnelId: string) {\r\n    // ./frpc -u <passowrd> -p <channel id>\r\n    this.processWrapper = new ProcessWrapper(\r\n      FRPC_PATH,\r\n      [\"-u\", this.token, \"-p\", this.tunnelId],\r\n      path.dirname(FRPC_PATH)\r\n    );\r\n  }\r\n\r\n  public open() {\r\n    logger.info(\"Start openfrp:\", FRPC_PATH);\r\n    this.processWrapper?.start();\r\n    if (!this.processWrapper?.getPid()) {\r\n      throw new Error(\"pid is null\");\r\n    }\r\n  }\r\n\r\n  public stop() {\r\n    try {\r\n      if (this.processWrapper?.exitCode() == null) {\r\n        this.processWrapper?.kill();\r\n      }\r\n      this.processWrapper = undefined;\r\n    } catch (error: any) {}\r\n  }\r\n}\r\n\r\nexport default class OpenFrpTask implements ILifeCycleTask {\r\n  public status: number = 0;\r\n  public name: string = \"openfrp\";\r\n  public static readonly FRP_EXE_NAME = `frpc_${os.platform()}_${os.arch()}${\r\n    os.platform() === \"win32\" ? \".exe\" : \"\"\r\n  }`;\r\n  public static readonly FRP_EXE_PATH = path.normalize(\r\n    path.join(process.cwd(), \"lib\", OpenFrpTask.FRP_EXE_NAME)\r\n  );\r\n  public static readonly FRP_DOWNLOAD_ADDR = \"https://mcsmanager.oss-cn-guangzhou.aliyuncs.com/\";\r\n\r\n  async start(instance: Instance) {\r\n    const { openFrpToken, openFrpTunnelId } = instance.config?.extraServiceConfig;\r\n    if (!openFrpToken || !openFrpTunnelId) return;\r\n\r\n    if (!fs.existsSync(OpenFrpTask.FRP_EXE_PATH)) {\r\n      const tmpTask = setInterval(() => {\r\n        instance.println(\"FRP\", $t(\"TXT_CODE_frp.installing\"));\r\n      }, 2000);\r\n      try {\r\n        await downloadFileToLocalFile(\r\n          OpenFrpTask.FRP_DOWNLOAD_ADDR + OpenFrpTask.FRP_EXE_NAME,\r\n          OpenFrpTask.FRP_EXE_PATH\r\n        );\r\n        instance.println(\"FRP\", $t(\"TXT_CODE_frp.done\"));\r\n      } catch (error: any) {\r\n        logger.error($t(\"TXT_CODE_frp.downloadErr\"), error);\r\n        instance.println(\"ERROR\", $t(\"TXT_CODE_frp.downloadErr\") + `: ${error}`);\r\n        fs.remove(OpenFrpTask.FRP_EXE_PATH, () => {});\r\n        return;\r\n      } finally {\r\n        clearInterval(tmpTask);\r\n      }\r\n    }\r\n\r\n    const frpProcess = new OpenFrp(openFrpToken, openFrpTunnelId);\r\n    frpProcess.processWrapper?.on(\"start\", (pid: number) => {\r\n      if (pid) {\r\n        logger.info(\r\n          `Instance ${instance.config.nickname}(${instance.instanceUuid}) ${pid} Frp task started!`\r\n        );\r\n        logger.info(`Params: ${openFrpTunnelId} | ${openFrpToken}`);\r\n        instance.openFrp = frpProcess;\r\n        instance.info.openFrpStatus = true;\r\n      } else {\r\n        logger.warn(\r\n          `Instance ${instance.config.nickname}(${instance.instanceUuid}) Frp task start failed! Process ID is ${pid}`\r\n        );\r\n      }\r\n    });\r\n    frpProcess.processWrapper?.on(\"exit\", () => {\r\n      logger.info(\r\n        `Instance ${instance.config.nickname}(${instance.instanceUuid}) Frp task stopped!`\r\n      );\r\n      instance.info.openFrpStatus = false;\r\n      instance.openFrp = undefined;\r\n    });\r\n\r\n    try {\r\n      frpProcess.open();\r\n    } catch (error: any) {\r\n      logger.warn(\r\n        `Instance ${instance.config.nickname}(${instance.instanceUuid}) Frp task Start failure! ERR:`\r\n      );\r\n      logger.warn(error);\r\n    }\r\n  }\r\n\r\n  async stop(instance: Instance) {\r\n    if (instance.openFrp) {\r\n      const frpProcess = instance.openFrp;\r\n      frpProcess.stop();\r\n    }\r\n  }\r\n}\r\n","import { ILifeCycleTask } from \"../../instance/life_cycle\";\r\nimport Instance from \"../../instance/instance\";\r\nimport KillCommand from \"../kill\";\r\n\r\n// When the instance is running, continue to check the expiration time\r\nexport default class TimeCheck implements ILifeCycleTask {\r\n  public status: number = 0;\r\n  public name: string = \"TimeCheck\";\r\n\r\n  private task: any = null;\r\n\r\n  async start(instance: Instance) {\r\n    this.task = setInterval(async () => {\r\n      if (instance.config.endTime) {\r\n        const endTime = instance.config.endTime;\r\n        if (endTime) {\r\n          const currentTime = Date.now();\r\n          if (endTime <= currentTime) {\r\n            // Expired, execute the end process command\r\n            await instance.exec(new KillCommand());\r\n            clearInterval(this.task);\r\n          }\r\n        }\r\n      }\r\n    }, 1000 * 60 * 60);\r\n  }\r\n\r\n  async stop(instance: Instance) {\r\n    clearInterval(this.task);\r\n  }\r\n}\r\n","import { v4 } from \"uuid\";\r\nimport StorageSubsystem from \"../common/system_storage\";\r\n\r\nfunction builderPassword() {\r\n  const a = `${v4().replace(/\\-/gim, \"\")}`;\r\n  const b = a.slice(0, a.length / 2 - 1);\r\n  const c = `${v4().replace(/\\-/gim, \"\")}`;\r\n  return b + c;\r\n}\r\n\r\n// @Entity\r\nclass Config {\r\n  public version = 2;\r\n  public ip = \"\";\r\n  public port = 24444;\r\n  public prefix = \"\";\r\n  public key = builderPassword();\r\n  public maxFileTask = 2;\r\n  public maxZipFileSize = 200;\r\n  public language = \"en_us\";\r\n  public defaultInstancePath = \"\";\r\n}\r\n\r\n// daemon configuration class\r\nclass GlobalConfiguration {\r\n  public config = new Config();\r\n  private static readonly ID = \"global\";\r\n\r\n  load() {\r\n    let config: Config = StorageSubsystem.load(\"Config\", Config, GlobalConfiguration.ID);\r\n    if (config == null) {\r\n      config = new Config();\r\n      StorageSubsystem.store(\"Config\", GlobalConfiguration.ID, config);\r\n    }\r\n    this.config = config;\r\n  }\r\n\r\n  store() {\r\n    StorageSubsystem.store(\"Config\", GlobalConfiguration.ID, this.config);\r\n  }\r\n}\r\n\r\nclass GlobalEnv {\r\n  public fileTaskCount = 0;\r\n}\r\n\r\nconst globalConfiguration = new GlobalConfiguration();\r\nconst globalEnv = new GlobalEnv();\r\n\r\nexport { globalConfiguration, Config, globalEnv };\r\n","import { Socket } from \"socket.io\";\r\n\r\nexport default class RouterContext {\r\n  constructor(\r\n    public uuid: string | null,\r\n    public socket: Socket,\r\n    public session?: any,\r\n    public event?: string\r\n  ) {}\r\n\r\n  public response(data: any) {\r\n    return this;\r\n  }\r\n}\r\n","import Instance from \"./instance\";\r\nimport os from \"os\";\r\nimport { IGlobalInstanceConfig, IGlobalInstanceDockerConfig } from \"common/global\";\r\ninterface IActionCommand {\r\n  name: string;\r\n  command: string;\r\n}\r\n\r\ntype ProcessType = \"general\" | \"docker\";\r\n\r\n// @Entity\r\nexport default class InstanceConfig implements IGlobalInstanceConfig {\r\n  public nickname = \"Undefined\";\r\n  public startCommand = \"\";\r\n  public stopCommand = \"^C\";\r\n  public cwd = \".\";\r\n  public ie = \"utf-8\";\r\n  public oe = \"utf-8\";\r\n  public createDatetime = Date.now();\r\n  public lastDatetime = Date.now();\r\n  public type = Instance.TYPE_UNIVERSAL;\r\n  public tag: string[] = [];\r\n  public endTime: number = 0;\r\n  public fileCode: string = \"utf-8\";\r\n  public processType: ProcessType = \"general\";\r\n  public updateCommand: string = \"\";\r\n  public crlf = os.platform() === \"win32\" ? 2 : 1; // 1: \\n  2: \\r\\n\r\n\r\n  // Steam RCON protocol\r\n  public enableRcon = false;\r\n  public rconPassword = \"\";\r\n  public rconPort = 0;\r\n  public rconIp = \"\";\r\n\r\n  // custom command list\r\n  public actionCommandList: IActionCommand[] = [];\r\n\r\n  // terminal option\r\n  public terminalOption = {\r\n    haveColor: false,\r\n    pty: true,\r\n    ptyWindowCol: 164,\r\n    ptyWindowRow: 40\r\n  };\r\n\r\n  // Event task\r\n  public eventTask = {\r\n    autoStart: false,\r\n    autoRestart: false,\r\n    ignore: false\r\n  };\r\n\r\n  // Extend\r\n  public docker: IGlobalInstanceDockerConfig = {\r\n    containerName: \"\",\r\n    image: \"\",\r\n    ports: [],\r\n    extraVolumes: [],\r\n    memory: 0,\r\n    networkMode: \"bridge\",\r\n    networkAliases: [],\r\n    cpusetCpus: \"\",\r\n    cpuUsage: 0,\r\n    maxSpace: 0,\r\n    io: 0,\r\n    network: 0,\r\n    workingDir: \"/workspace/\",\r\n    env: []\r\n  };\r\n\r\n  public pingConfig = {\r\n    ip: \"\",\r\n    port: 25565,\r\n    type: 1\r\n  };\r\n\r\n  public extraServiceConfig = {\r\n    openFrpTunnelId: \"\",\r\n    openFrpToken: \"\"\r\n  };\r\n}\r\n","import { $t } from \"../../i18n\";\r\nimport iconv from \"iconv-lite\";\r\nimport path from \"path\";\r\nimport { EventEmitter } from \"events\";\r\nimport { IExecutable } from \"./preset\";\r\nimport InstanceCommand from \"../commands/base/command\";\r\nimport InstanceConfig from \"./Instance_config\";\r\nimport StorageSubsystem from \"../../common/system_storage\";\r\nimport { LifeCycleTaskManager } from \"./life_cycle\";\r\nimport { PresetCommandManager } from \"./preset\";\r\nimport FunctionDispatcher, { IPresetCommand } from \"../commands/dispatcher\";\r\nimport { IInstanceProcess } from \"./interface\";\r\nimport StartCommand from \"../commands/start\";\r\nimport { configureEntityParams } from \"common\";\r\nimport { OpenFrp } from \"../commands/task/openfrp\";\r\nimport logger from \"../../service/log\";\r\n\r\n// The instance does not need to store additional information persistently\r\ninterface IInstanceInfo {\r\n  currentPlayers: number;\r\n  maxPlayers: number;\r\n  version: string;\r\n  fileLock: number;\r\n  playersChart: Array<{ value: string }>;\r\n  openFrpStatus: boolean;\r\n}\r\n\r\ninterface IWatcherInfo {\r\n  terminalSize: {\r\n    w: number;\r\n    h: number;\r\n  };\r\n}\r\n\r\n// instance class\r\nexport default class Instance extends EventEmitter {\r\n  public static readonly STATUS_BUSY = -1;\r\n  public static readonly STATUS_STOP = 0;\r\n  public static readonly STATUS_STOPPING = 1;\r\n  public static readonly STATUS_STARTING = 2;\r\n  public static readonly STATUS_RUNNING = 3;\r\n\r\n  public static readonly TYPE_UNIVERSAL = \"universal\";\r\n  public static readonly TYPE_MINECRAFT_JAVA = \"minecraft/java\";\r\n  public static readonly TYPE_MINECRAFT_BEDROCK = \"minecraft/bedrock\";\r\n\r\n  public instanceStatus: number = Instance.STATUS_STOP;\r\n  public instanceUuid: string = \"\";\r\n  public lock: boolean = false;\r\n  public startCount: number = 0;\r\n  public startTimestamp: number = 0;\r\n  public asynchronousTask?: IExecutable | null;\r\n  public openFrp?: OpenFrp;\r\n\r\n  public readonly lifeCycleTaskManager = new LifeCycleTaskManager(this);\r\n  public readonly presetCommandManager = new PresetCommandManager(this);\r\n\r\n  public config: InstanceConfig;\r\n\r\n  public info: IInstanceInfo = {\r\n    currentPlayers: -1,\r\n    maxPlayers: -1,\r\n    version: \"\",\r\n    fileLock: 0,\r\n    playersChart: [],\r\n    openFrpStatus: false\r\n  };\r\n\r\n  public watchers: Map<string, IWatcherInfo> = new Map();\r\n\r\n  public process?: IInstanceProcess;\r\n\r\n  // When initializing an instance, the instance must be initialized through uuid and configuration class, otherwise the instance will be unavailable\r\n  constructor(instanceUuid: string, config: InstanceConfig) {\r\n    super();\r\n\r\n    if (!instanceUuid || !config) throw new Error($t(\"TXT_CODE_instanceConf.initInstanceErr\"));\r\n\r\n    // Basic information\r\n    this.instanceStatus = Instance.STATUS_STOP;\r\n    this.instanceUuid = instanceUuid;\r\n\r\n    // Action lock\r\n    this.lock = false;\r\n\r\n    this.config = config;\r\n\r\n    this.process = undefined;\r\n    this.startCount = 0;\r\n  }\r\n\r\n  isStoppedOrBusy() {\r\n    return [Instance.STATUS_STOP, Instance.STATUS_BUSY].includes(this.status());\r\n  }\r\n\r\n  // Pass in instance configuration, loosely and dynamically set configuration items for instance parameters\r\n  parameters(cfg: any, persistence = true) {\r\n    // If the instance type changes, default commands and lifecycle events must be reset\r\n    if (cfg?.type && cfg?.type != this.config.type) {\r\n      if (!this.isStoppedOrBusy())\r\n        throw new Error($t(\"TXT_CODE_instanceConf.cantModifyInstanceType\"));\r\n      configureEntityParams(this.config, cfg, \"type\", String);\r\n      this.forceExec(new FunctionDispatcher());\r\n    }\r\n\r\n    if (cfg?.enableRcon != null && cfg?.enableRcon !== this.config.enableRcon) {\r\n      if (!this.isStoppedOrBusy()) throw new Error($t(\"TXT_CODE_bdfa3457\"));\r\n      configureEntityParams(this.config, cfg, \"enableRcon\", Boolean);\r\n      this.forceExec(new FunctionDispatcher());\r\n    }\r\n\r\n    if (cfg?.processType && cfg?.processType !== this.config.processType) {\r\n      if (!this.isStoppedOrBusy())\r\n        throw new Error($t(\"TXT_CODE_instanceConf.cantModifyProcessType\"));\r\n      configureEntityParams(this.config, cfg, \"processType\", String);\r\n      this.forceExec(new FunctionDispatcher());\r\n    }\r\n\r\n    // If the terminal type is changed, the default command must be reset\r\n    if (\r\n      cfg?.terminalOption?.pty != null &&\r\n      cfg?.terminalOption?.pty !== this.config.terminalOption.pty\r\n    ) {\r\n      if (!this.isStoppedOrBusy()) throw new Error($t(\"TXT_CODE_instanceConf.cantModifyPtyModel\"));\r\n      configureEntityParams(this.config.terminalOption, cfg.terminalOption, \"pty\", Boolean);\r\n      this.forceExec(new FunctionDispatcher());\r\n    }\r\n\r\n    // Only allow some configuration items to be modified when the server is stopped\r\n    if (this.isStoppedOrBusy() && cfg.terminalOption) {\r\n      configureEntityParams(this.config.terminalOption, cfg.terminalOption, \"ptyWindowCol\", Number);\r\n      configureEntityParams(this.config.terminalOption, cfg.terminalOption, \"ptyWindowRow\", Number);\r\n    }\r\n\r\n    if (cfg?.extraServiceConfig) {\r\n      configureEntityParams(\r\n        this.config.extraServiceConfig,\r\n        cfg.extraServiceConfig,\r\n        \"isOpenFrp\",\r\n        Boolean\r\n      );\r\n      configureEntityParams(\r\n        this.config.extraServiceConfig,\r\n        cfg.extraServiceConfig,\r\n        \"openFrpToken\",\r\n        String\r\n      );\r\n      configureEntityParams(\r\n        this.config.extraServiceConfig,\r\n        cfg.extraServiceConfig,\r\n        \"openFrpTunnelId\",\r\n        String\r\n      );\r\n    }\r\n\r\n    configureEntityParams(this.config, cfg, \"nickname\", String);\r\n    configureEntityParams(this.config, cfg, \"startCommand\", String);\r\n    configureEntityParams(this.config, cfg, \"stopCommand\", String);\r\n    configureEntityParams(this.config, cfg, \"updateCommand\", String);\r\n    configureEntityParams(this.config, cfg, \"cwd\", String);\r\n    configureEntityParams(this.config, cfg, \"ie\", String);\r\n    configureEntityParams(this.config, cfg, \"oe\", String);\r\n    configureEntityParams(this.config, cfg, \"crlf\", Number);\r\n    configureEntityParams(this.config, cfg, \"endTime\", Number);\r\n    configureEntityParams(this.config, cfg, \"fileCode\", String);\r\n    configureEntityParams(this.config, cfg, \"rconPassword\", String);\r\n    configureEntityParams(this.config, cfg, \"rconPort\", Number);\r\n    configureEntityParams(this.config, cfg, \"rconIp\", String);\r\n\r\n    if (cfg.docker) {\r\n      configureEntityParams(this.config.docker, cfg.docker, \"containerName\", String);\r\n      configureEntityParams(this.config.docker, cfg.docker, \"image\", String);\r\n      configureEntityParams(this.config.docker, cfg.docker, \"memory\", Number);\r\n      configureEntityParams(this.config.docker, cfg.docker, \"ports\");\r\n      configureEntityParams(this.config.docker, cfg.docker, \"extraVolumes\");\r\n      configureEntityParams(this.config.docker, cfg.docker, \"maxSpace\", Number);\r\n      configureEntityParams(this.config.docker, cfg.docker, \"io\", Number);\r\n      configureEntityParams(this.config.docker, cfg.docker, \"network\", Number);\r\n      configureEntityParams(this.config.docker, cfg.docker, \"networkMode\", String);\r\n      configureEntityParams(this.config.docker, cfg.docker, \"networkAliases\");\r\n      configureEntityParams(this.config.docker, cfg.docker, \"cpusetCpus\", String);\r\n      configureEntityParams(this.config.docker, cfg.docker, \"cpuUsage\", Number);\r\n      configureEntityParams(this.config.docker, cfg.docker, \"env\");\r\n      configureEntityParams(this.config.docker, cfg.docker, \"workingDir\", String);\r\n    }\r\n    if (cfg.pingConfig) {\r\n      configureEntityParams(this.config.pingConfig, cfg.pingConfig, \"ip\", String);\r\n      configureEntityParams(this.config.pingConfig, cfg.pingConfig, \"port\", Number);\r\n      configureEntityParams(this.config.pingConfig, cfg.pingConfig, \"type\", Number);\r\n    }\r\n    if (cfg.eventTask) {\r\n      configureEntityParams(this.config.eventTask, cfg.eventTask, \"autoStart\", Boolean);\r\n      configureEntityParams(this.config.eventTask, cfg.eventTask, \"autoRestart\", Boolean);\r\n      configureEntityParams(this.config.eventTask, cfg.eventTask, \"ignore\", Boolean);\r\n    }\r\n    if (cfg.terminalOption) {\r\n      configureEntityParams(this.config.terminalOption, cfg.terminalOption, \"haveColor\", Boolean);\r\n    }\r\n\r\n    if (persistence) StorageSubsystem.store(\"InstanceConfig\", this.instanceUuid, this.config);\r\n  }\r\n\r\n  setLock(bool: boolean) {\r\n    this.lock = bool;\r\n  }\r\n\r\n  // Execute the corresponding command for this instance\r\n  async execCommand(command: InstanceCommand) {\r\n    if (this.lock)\r\n      throw new Error($t(\"TXT_CODE_instanceConf.instanceLock\", { info: command.info }));\r\n    if (this.status() == Instance.STATUS_BUSY)\r\n      throw new Error($t(\"TXT_CODE_instanceConf.instanceBusy\"));\r\n    return await command.exec(this);\r\n  }\r\n\r\n  // Execute the corresponding command for this instance Alias\r\n  async exec(command: InstanceCommand) {\r\n    return await this.execCommand(command);\r\n  }\r\n\r\n  // force the command to execute\r\n  async forceExec(command: InstanceCommand) {\r\n    return await command.exec(this);\r\n  }\r\n\r\n  // set instance state or get state\r\n  status(v?: number) {\r\n    if (v != null) this.instanceStatus = v;\r\n    return this.instanceStatus;\r\n  }\r\n\r\n  // function that must be executed after the instance starts\r\n  // Trigger the open event and bind the data and exit events, etc.\r\n  started(process: IInstanceProcess) {\r\n    this.config.lastDatetime = Date.now();\r\n    const outputCode = this.config.terminalOption.pty ? \"utf-8\" : this.config.oe;\r\n    process.on(\"data\", (text: any) => {\r\n      this.emit(\"data\", iconv.decode(text, outputCode));\r\n    });\r\n    process.on(\"exit\", (code: number) => this.stopped(code));\r\n    this.process = process;\r\n    this.instanceStatus = Instance.STATUS_RUNNING;\r\n    this.emit(\"open\", this);\r\n    // start all lifecycle tasks\r\n    this.lifeCycleTaskManager.execLifeCycleTask(1);\r\n  }\r\n\r\n  // If the instance performs any operation exception, it must throw an exception through this function\r\n  // trigger failure event\r\n  failure(error: Error) {\r\n    this.emit(\"failure\", error);\r\n    this.println(\"Operation Error\", error.message ?? String(error));\r\n    throw error;\r\n  }\r\n\r\n  // function that must be executed after the instance has been closed\r\n  // trigger exit event\r\n  stopped(code = 0) {\r\n    this.releaseResources();\r\n    if (this.instanceStatus != Instance.STATUS_STOP) {\r\n      this.instanceStatus = Instance.STATUS_STOP;\r\n      this.emit(\"exit\", code);\r\n      StorageSubsystem.store(\"InstanceConfig\", this.instanceUuid, this.config);\r\n    }\r\n    // Close all lifecycle tasks\r\n    this.lifeCycleTaskManager.execLifeCycleTask(0);\r\n\r\n    // If automatic restart is enabled, the startup operation is performed immediately\r\n    if (this.config.eventTask.autoRestart) {\r\n      if (!this.config.eventTask.ignore) {\r\n        this.forceExec(new StartCommand(\"Event Task: Auto Restart\"))\r\n          .then(() => {\r\n            this.println($t(\"TXT_CODE_instanceConf.info\"), $t(\"TXT_CODE_instanceConf.autoRestart\"));\r\n          })\r\n          .catch((err) => {\r\n            this.println(\r\n              $t(\"TXT_CODE_instanceConf.error\"),\r\n              $t(\"TXT_CODE_instanceConf.autoRestartErr\", { err: err })\r\n            );\r\n          });\r\n      }\r\n      this.config.eventTask.ignore = false;\r\n    }\r\n\r\n    // Turn off the warning immediately after startup, usually the startup command is written incorrectly\r\n    const currentTimestamp = new Date().getTime();\r\n    const startThreshold = 6 * 1000;\r\n    if (currentTimestamp - this.startTimestamp < startThreshold) {\r\n      this.println(\"ERROR\", $t(\"TXT_CODE_instanceConf.instantExit\"));\r\n    }\r\n  }\r\n\r\n  // custom output method, formatting\r\n  println(level: string, text: string) {\r\n    const str = `[${level}] ${text}\\n`;\r\n    this.emit(\"data\", str);\r\n  }\r\n\r\n  // custom output method\r\n  print(data: any) {\r\n    this.emit(\"data\", data);\r\n  }\r\n\r\n  // Release resources (mainly release process-related resources)\r\n  releaseResources() {\r\n    try {\r\n      this.process?.destroy();\r\n    } catch (error: any) {\r\n      logger.error(`Instance ${this.instanceUuid}, Release resources error: ${error}`);\r\n    } finally {\r\n      this.process = undefined;\r\n    }\r\n  }\r\n\r\n  // destroy this instance\r\n  destroy() {\r\n    if (this.process && this.process.pid) {\r\n      this.process.kill(\"SIGKILL\");\r\n    }\r\n    this.process = undefined;\r\n  }\r\n\r\n  fullTime() {\r\n    const date = new Date();\r\n    return date.toLocaleDateString() + \" \" + date.getHours() + \":\" + date.getMinutes();\r\n  }\r\n\r\n  absoluteCwdPath() {\r\n    if (!this.config || !this.config.cwd) throw new Error(\"Instance config error, cwd is Null!\");\r\n    if (path.isAbsolute(this.config.cwd)) return path.normalize(this.config.cwd);\r\n    return path.normalize(path.join(process.cwd(), this.config.cwd));\r\n  }\r\n\r\n  async usedSpace(tmp?: string, maxDeep = 4, deep = 0) {\r\n    // if (deep >= maxDeep) return 0;\r\n    // let size = 0;\r\n    // const topPath = tmp ? tmp : this.absoluteCwdPath();\r\n    // const files = await fs.readdir(topPath);\r\n    // for (const fileName of files) {\r\n    // const absPath = path.join(topPath, fileName);\r\n    // const info = await fs.stat(absPath);\r\n    // if (info.isDirectory()) {\r\n    // size += await this.usedSpace(absPath, maxDeep, deep + 1);\r\n    // } else {\r\n    // size += info.size;\r\n    // }\r\n    // }\r\n    return 0;\r\n  }\r\n\r\n  // execute the preset command action\r\n  async execPreset(action: IPresetCommand, p?: any) {\r\n    if (this.presetCommandManager) {\r\n      return await this.presetCommandManager.execPreset(action, p);\r\n    }\r\n    throw new Error(`Preset Manager does not exist`);\r\n  }\r\n\r\n  setPreset(action: IPresetCommand, cmd: InstanceCommand) {\r\n    this.presetCommandManager.setPreset(action, cmd);\r\n  }\r\n\r\n  getPreset(action: IPresetCommand) {\r\n    return this.presetCommandManager.getPreset(action);\r\n  }\r\n\r\n  clearPreset() {\r\n    this.presetCommandManager.clearPreset();\r\n  }\r\n\r\n  computeTerminalSize() {\r\n    let minW = this.config.terminalOption.ptyWindowCol;\r\n    let minH = this.config.terminalOption.ptyWindowRow;\r\n    for (const iterator of this.watchers.values()) {\r\n      const { w, h } = iterator.terminalSize;\r\n      if (w && h) {\r\n        if (w < minW) minW = w;\r\n        if (h < minH) minH = h;\r\n      }\r\n    }\r\n    return {\r\n      w: minW,\r\n      h: minH\r\n    };\r\n  }\r\n}\r\n","import Instance from \"./instance\";\r\n\r\nexport interface ILifeCycleTask {\r\n  name: string; // task name\r\n  status: number; // Running status, the default is 0, the task manager will automatically change\r\n  start: (instance: Instance) => Promise<void>;\r\n  stop: (instance: Instance) => Promise<void>;\r\n}\r\n\r\nexport class LifeCycleTaskManager {\r\n  // list of life cycle tasks\r\n  public readonly lifeCycleTask: ILifeCycleTask[] = [];\r\n\r\n  constructor(private self: any) {}\r\n\r\n  registerLifeCycleTask(task: ILifeCycleTask) {\r\n    this.lifeCycleTask.push(task);\r\n  }\r\n\r\n  execLifeCycleTask(type: number) {\r\n    if (type == 1) {\r\n      this.lifeCycleTask.forEach((v) => {\r\n        if (v.status === 0) v.start(this.self);\r\n        v.status = 1;\r\n      });\r\n    } else {\r\n      this.lifeCycleTask.forEach((v) => {\r\n        if (v.status === 1) v.stop(this.self);\r\n        v.status = 0;\r\n      });\r\n    }\r\n  }\r\n\r\n  clearLifeCycleTask() {\r\n    this.execLifeCycleTask(0);\r\n    this.lifeCycleTask.splice(0, this.lifeCycleTask.length);\r\n  }\r\n}\r\n","import { $t } from \"../../i18n\";\r\nimport { IPresetCommand } from \"../commands/dispatcher\";\r\nexport interface IExecutable {\r\n  exec: (a: any, b?: any) => Promise<any>;\r\n  stop?: (a: any) => Promise<void>;\r\n}\r\n\r\nexport class PresetCommandManager {\r\n  public readonly preset = new Map<IPresetCommand, IExecutable>();\r\n\r\n  constructor(private self: any) {}\r\n\r\n  setPreset(action: IPresetCommand, cmd: IExecutable) {\r\n    this.preset.set(action, cmd);\r\n  }\r\n\r\n  getPreset(action: IPresetCommand) {\r\n    return this.preset.get(action);\r\n  }\r\n\r\n  async execPreset(action: IPresetCommand, p?: any) {\r\n    const cmd = this.preset.get(action);\r\n    if (!cmd) throw new Error($t(\"TXT_CODE_preset.actionErr\", { action: action }));\r\n    return await cmd.exec(this.self, p);\r\n  }\r\n\r\n  clearPreset() {\r\n    this.preset.clear();\r\n  }\r\n}\r\n","import { $t } from \"../../i18n\";\r\nimport yaml from \"yaml\";\r\nimport toml from \"@iarna/toml\";\r\nimport properties from \"properties\";\r\nimport path from \"path\";\r\nimport fs from \"fs-extra\";\r\n\r\nconst CONFIG_FILE_ENCODE = \"utf-8\";\r\n\r\nexport interface IProcessConfig {\r\n  fileName: string;\r\n  path: string;\r\n  type: string;\r\n  info: string | null;\r\n  redirect: string;\r\n  from?: string;\r\n  fromLink?: string | null;\r\n}\r\n\r\nexport class ProcessConfig {\r\n  constructor(public iProcessConfig: IProcessConfig) {\r\n    iProcessConfig.path = path.normalize(iProcessConfig.path);\r\n  }\r\n\r\n  // Automatically parse the local file according to the type and return the configuration object\r\n  read(): any {\r\n    const text = fs.readFileSync(this.iProcessConfig.path, { encoding: CONFIG_FILE_ENCODE });\r\n    if (this.iProcessConfig.type === \"yml\") {\r\n      return yaml.parse(text);\r\n    }\r\n    if (this.iProcessConfig.type == \"toml\") {\r\n      return toml.parse(text);\r\n    }\r\n    if (this.iProcessConfig.type === \"properties\") {\r\n      return properties.parse(text);\r\n    }\r\n    if (this.iProcessConfig.type === \"json\") {\r\n      return JSON.parse(text);\r\n    }\r\n    if (this.iProcessConfig.type === \"txt\") {\r\n      return text;\r\n    }\r\n  }\r\n\r\n  // Automatically save to the local configuration file according to the parameter object\r\n  write(object: Object | toml.JsonMap) {\r\n    let text = \"\";\r\n    if (this.iProcessConfig.type === \"yml\") {\r\n      text = yaml.stringify(object);\r\n    }\r\n    if (this.iProcessConfig.type === \"toml\") {\r\n      text = toml.stringify(<toml.JsonMap>object);\r\n    }\r\n    if (this.iProcessConfig.type === \"properties\") {\r\n      text = properties.stringify(object, {\r\n        unicode: true\r\n      });\r\n      text = text.replace(/ = /gim, \"=\");\r\n      if (this.iProcessConfig.fileName == \"server.properties\") {\r\n        text = text.replace(/\\\\\\\\u/gim, \"\\\\u\");\r\n      }\r\n    }\r\n    if (this.iProcessConfig.type === \"json\") {\r\n      text = JSON.stringify(object);\r\n    }\r\n    if (this.iProcessConfig.type === \"txt\") {\r\n      text = object.toString();\r\n    }\r\n    if (!text && this.iProcessConfig.type !== \"txt\")\r\n      throw new Error($t(\"TXT_CODE_process_config.writEmpty\"));\r\n    fs.writeFileSync(this.iProcessConfig.path, text, { encoding: CONFIG_FILE_ENCODE });\r\n  }\r\n\r\n  exists() {\r\n    return fs.existsSync(this.iProcessConfig.path);\r\n  }\r\n}\r\n","// I18n init configuration (Daemon)\r\n// If you want to add the language of your own country, you need to add the code here.\r\n\r\nimport i18next from \"i18next\";\r\n\r\nimport zh_cn from \"@languages/zh_CN.json\";\r\nimport en_us from \"@languages/en_US.json\";\r\nimport zh_tw from \"@languages/zh_TW.json\";\r\nimport ja_JP from \"@languages/ja_JP.json\";\r\nimport es_ES from \"@languages/es_ES.json\";\r\nimport fr_FR from \"@languages/fr_FR.json\";\r\nimport ru_RU from \"@languages/ru_RU.json\";\r\nimport ko_KR from \"@languages/ko_KR.json\";\r\nimport de_DE from \"@languages/de_DE.json\";\r\n\r\ni18next.init({\r\n  interpolation: {\r\n    escapeValue: false\r\n  },\r\n  lng: \"en_us\",\r\n  fallbackLng: \"en_us\",\r\n  resources: {\r\n    en_us: {\r\n      translation: en_us\r\n    },\r\n    zh_cn: {\r\n      translation: zh_cn\r\n    },\r\n    zh_tw: {\r\n      translation: zh_tw\r\n    },\r\n    ja_jp: {\r\n      translation: ja_JP\r\n    },\r\n    es_es: {\r\n      translation: es_ES\r\n    },\r\n    fr_fr: {\r\n      translation: fr_FR\r\n    },\r\n    ru_ru: {\r\n      translation: ru_RU\r\n    },\r\n    ko_kr: {\r\n      translation: ko_KR\r\n    },\r\n    de_de: {\r\n      translation: de_DE\r\n    }\r\n  }\r\n});\r\n\r\n// alias\r\nconst $t = i18next.t;\r\n\r\nexport { $t, i18next };\r\n","import { $t } from \"../i18n\";\r\nimport fs from \"fs-extra\";\r\nimport * as protocol from \"../service/protocol\";\r\nimport { routerApp } from \"../service/router\";\r\nimport InstanceSubsystem from \"../service/system_instance\";\r\nimport Instance from \"../entity/instance/instance\";\r\nimport logger from \"../service/log\";\r\nimport path from \"path\";\r\n\r\nimport StartCommand from \"../entity/commands/start\";\r\nimport StopCommand from \"../entity/commands/stop\";\r\nimport SendCommand from \"../entity/commands/cmd\";\r\nimport KillCommand from \"../entity/commands/kill\";\r\nimport { IInstanceDetail, IJson } from \"../service/interfaces\";\r\nimport { QueryMapWrapper } from \"common\";\r\nimport ProcessInfoCommand from \"../entity/commands/process_info\";\r\nimport FileManager from \"../service/system_file\";\r\nimport { ProcessConfig } from \"../entity/instance/process_config\";\r\nimport RestartCommand from \"../entity/commands/restart\";\r\nimport { TaskCenter } from \"../service/async_task_service\";\r\nimport { createQuickInstallTask } from \"../service/async_task_service/quick_install\";\r\nimport { QuickInstallTask } from \"../service/async_task_service/quick_install\";\r\n\r\n// Some instances operate router authentication middleware\r\nrouterApp.use((event, ctx, data, next) => {\r\n  if (event === \"instance/new\" && data) return next();\r\n  if (event === \"instance/overview\") return next();\r\n  if (event === \"instance/select\") return next();\r\n  if (event === \"instance/asynchronous\") return next();\r\n  if (event === \"instance/query_asynchronous\") return next();\r\n  if (event === \"instance/stop_asynchronous\") return next();\r\n  if (event.startsWith(\"instance\")) {\r\n    // class AOP\r\n    if (data.instanceUuids) return next();\r\n    const instanceUuid = data.instanceUuid;\r\n    if (!InstanceSubsystem.exists(instanceUuid)) {\r\n      return protocol.error(ctx, event, {\r\n        instanceUuid: instanceUuid,\r\n        err: `The operation failed, the instance ${instanceUuid} does not exist.`\r\n      });\r\n    }\r\n  }\r\n  next();\r\n});\r\n\r\n// Get the list of instances of this daemon (query)\r\nrouterApp.on(\"instance/select\", (ctx, data) => {\r\n  const page = data.page || 1;\r\n  const pageSize = data.pageSize || 1;\r\n  const condition = data.condition;\r\n  const overview: IInstanceDetail[] = [];\r\n  // keyword condition query\r\n  const queryWrapper = InstanceSubsystem.getQueryMapWrapper();\r\n  let result = queryWrapper.select<Instance>((v) => {\r\n    if (InstanceSubsystem.isGlobalInstance(v)) return false;\r\n    if (!v.config.nickname.toLowerCase().includes(condition.instanceName.toLowerCase()))\r\n      return false;\r\n    if (condition.status && v.instanceStatus !== Number(condition.status)) return false;\r\n    return true;\r\n  });\r\n  result = result.sort((a, b) => (a.config.nickname > b.config.nickname ? 1 : -1));\r\n  // paging function\r\n  const pageResult = queryWrapper.page<Instance>(result, page, pageSize);\r\n  // filter unwanted data\r\n  pageResult.data.forEach((instance) => {\r\n    overview.push({\r\n      instanceUuid: instance.instanceUuid,\r\n      started: instance.startCount,\r\n      status: instance.status(),\r\n      config: instance.config,\r\n      info: instance.info\r\n    });\r\n  });\r\n\r\n  overview.sort((a, b) => {\r\n    return a.config.nickname >= b.config.nickname ? 1 : -1;\r\n  });\r\n\r\n  protocol.response(ctx, {\r\n    page: pageResult.page,\r\n    pageSize: pageResult.pageSize,\r\n    maxPage: pageResult.maxPage,\r\n    data: overview\r\n  });\r\n});\r\n\r\n// Get an overview of this daemon instance\r\nrouterApp.on(\"instance/overview\", (ctx) => {\r\n  const overview: IInstanceDetail[] = [];\r\n  InstanceSubsystem.getInstances().forEach((instance) => {\r\n    overview.push({\r\n      instanceUuid: instance.instanceUuid,\r\n      started: instance.startCount,\r\n      status: instance.status(),\r\n      config: instance.config,\r\n      info: instance.info\r\n    });\r\n  });\r\n\r\n  protocol.msg(ctx, \"instance/overview\", overview);\r\n});\r\n\r\n// Get an overview of some instances of this daemon\r\nrouterApp.on(\"instance/section\", (ctx, data) => {\r\n  const instanceUuids = data.instanceUuids as string[];\r\n  const overview: IInstanceDetail[] = [];\r\n  InstanceSubsystem.getInstances().forEach((instance) => {\r\n    instanceUuids.forEach((targetUuid) => {\r\n      if (targetUuid === instance.instanceUuid) {\r\n        overview.push({\r\n          instanceUuid: instance.instanceUuid,\r\n          started: instance.startCount,\r\n          status: instance.status(),\r\n          config: instance.config,\r\n          info: instance.info\r\n        });\r\n      }\r\n    });\r\n  });\r\n  protocol.msg(ctx, \"instance/section\", overview);\r\n});\r\n\r\n// View details of a single instance\r\nrouterApp.on(\"instance/detail\", async (ctx, data) => {\r\n  try {\r\n    const instanceUuid = data.instanceUuid;\r\n    const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n    if (!instance) throw new Error($t(\"TXT_CODE_3bfb9e04\"));\r\n    let processInfo = null;\r\n    let space = null;\r\n    try {\r\n      // Parts that may be wrong due to file permissions, avoid affecting the acquisition of the entire configuration\r\n      processInfo = await instance.forceExec(new ProcessInfoCommand());\r\n      space = await instance.usedSpace();\r\n    } catch (err: any) {}\r\n    protocol.msg(ctx, \"instance/detail\", {\r\n      instanceUuid: instance.instanceUuid,\r\n      started: instance.startCount,\r\n      status: instance.status(),\r\n      config: instance.config,\r\n      info: instance.info,\r\n      space,\r\n      processInfo\r\n    });\r\n  } catch (err: any) {\r\n    protocol.error(ctx, \"instance/detail\", { err: err.message });\r\n  }\r\n});\r\n\r\n// create a new application instance\r\nrouterApp.on(\"instance/new\", (ctx, data) => {\r\n  const config = data;\r\n  try {\r\n    const newInstance = InstanceSubsystem.createInstance(config);\r\n    protocol.msg(ctx, \"instance/new\", {\r\n      instanceUuid: newInstance.instanceUuid,\r\n      config: newInstance.config\r\n    });\r\n  } catch (err: any) {\r\n    protocol.error(ctx, \"instance/new\", { instanceUuid: null, err: err.message });\r\n  }\r\n});\r\n\r\n// update instance data\r\nrouterApp.on(\"instance/update\", (ctx, data) => {\r\n  const instanceUuid = data.instanceUuid;\r\n  const config = data.config;\r\n  try {\r\n    InstanceSubsystem.getInstance(instanceUuid)?.parameters(config);\r\n    protocol.msg(ctx, \"instance/update\", { instanceUuid });\r\n  } catch (err: any) {\r\n    protocol.error(ctx, \"instance/update\", { instanceUuid: instanceUuid, err: err.message });\r\n  }\r\n});\r\n\r\n// Request to forward all IO data of an instance\r\nrouterApp.on(\"instance/forward\", (ctx, data) => {\r\n  const targetInstanceUuid = data.instanceUuid;\r\n  const isforward: boolean = data.forward;\r\n  try {\r\n    // InstanceSubsystem.getInstance(targetInstanceUuid);\r\n    if (isforward) {\r\n      logger.info(\r\n        $t(\"TXT_CODE_Instance_router.requestIO\", {\r\n          id: ctx.socket.id,\r\n          targetInstanceUuid: targetInstanceUuid\r\n        })\r\n      );\r\n      InstanceSubsystem.forward(targetInstanceUuid, ctx.socket);\r\n    } else {\r\n      logger.info(\r\n        $t(\"TXT_CODE_Instance_router.cancelIO\", {\r\n          id: ctx.socket.id,\r\n          targetInstanceUuid: targetInstanceUuid\r\n        })\r\n      );\r\n      InstanceSubsystem.stopForward(targetInstanceUuid, ctx.socket);\r\n    }\r\n    protocol.msg(ctx, \"instance/forward\", { instanceUuid: targetInstanceUuid });\r\n  } catch (err: any) {\r\n    protocol.error(ctx, \"instance/forward\", { instanceUuid: targetInstanceUuid, err: err.message });\r\n  }\r\n});\r\n\r\n// open the instance\r\nrouterApp.on(\"instance/open\", async (ctx, data) => {\r\n  const disableResponse = data.disableResponse;\r\n  for (const instanceUuid of data.instanceUuids) {\r\n    const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n    try {\r\n      await instance!.exec(new StartCommand(ctx.socket.id));\r\n      if (!disableResponse) protocol.msg(ctx, \"instance/open\", { instanceUuid });\r\n    } catch (err: any) {\r\n      if (!disableResponse) {\r\n        logger.error(\r\n          $t(\"TXT_CODE_Instance_router.openInstanceErr\", { instanceUuid: instanceUuid }),\r\n          err\r\n        );\r\n        protocol.error(ctx, \"instance/open\", { instanceUuid: instanceUuid, err: err.message });\r\n      }\r\n    }\r\n  }\r\n});\r\n\r\n// close the instance\r\nrouterApp.on(\"instance/stop\", async (ctx, data) => {\r\n  const disableResponse = data.disableResponse;\r\n  for (const instanceUuid of data.instanceUuids) {\r\n    const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n    try {\r\n      if (!instance) throw new Error($t(\"TXT_CODE_3bfb9e04\"));\r\n      await instance.exec(new StopCommand());\r\n      //Note: Removing this reply will cause the front-end response to be slow, because the front-end will wait for the panel-side message to be forwarded\r\n      if (!disableResponse) protocol.msg(ctx, \"instance/stop\", { instanceUuid });\r\n    } catch (err: any) {\r\n      if (!disableResponse)\r\n        protocol.error(ctx, \"instance/stop\", { instanceUuid: instanceUuid, err: err.message });\r\n    }\r\n  }\r\n});\r\n\r\n// restart the instance\r\nrouterApp.on(\"instance/restart\", async (ctx, data) => {\r\n  const disableResponse = data.disableResponse;\r\n  for (const instanceUuid of data.instanceUuids) {\r\n    const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n    try {\r\n      if (!instance) throw new Error($t(\"TXT_CODE_3bfb9e04\"));\r\n      await instance.exec(new RestartCommand());\r\n      if (!disableResponse) protocol.msg(ctx, \"instance/restart\", { instanceUuid });\r\n    } catch (err: any) {\r\n      if (!disableResponse)\r\n        protocol.error(ctx, \"instance/restart\", { instanceUuid: instanceUuid, err: err.message });\r\n    }\r\n  }\r\n});\r\n\r\n// terminate instance method\r\nrouterApp.on(\"instance/kill\", async (ctx, data) => {\r\n  const disableResponse = data.disableResponse;\r\n  for (const instanceUuid of data.instanceUuids) {\r\n    const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n    if (!instance) continue;\r\n    try {\r\n      await instance.forceExec(new KillCommand());\r\n      if (!disableResponse) protocol.msg(ctx, \"instance/kill\", { instanceUuid });\r\n    } catch (err: any) {\r\n      if (!disableResponse)\r\n        protocol.error(ctx, \"instance/kill\", { instanceUuid: instanceUuid, err: err.message });\r\n    }\r\n  }\r\n});\r\n\r\n// Send a command to the application instance\r\nrouterApp.on(\"instance/command\", async (ctx, data) => {\r\n  const disableResponse = data.disableResponse;\r\n  const instanceUuid = data.instanceUuid;\r\n  const command = data.command || \"\";\r\n  const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n  try {\r\n    if (!instance) throw new Error($t(\"TXT_CODE_3bfb9e04\"));\r\n    await instance.exec(new SendCommand(command));\r\n    if (!disableResponse) protocol.msg(ctx, \"instance/command\", { instanceUuid });\r\n  } catch (err: any) {\r\n    if (!disableResponse)\r\n      protocol.error(ctx, \"instance/command\", { instanceUuid: instanceUuid, err: err.message });\r\n  }\r\n});\r\n\r\n// delete instance\r\nrouterApp.on(\"instance/delete\", (ctx, data) => {\r\n  const instanceUuids = data.instanceUuids;\r\n  const deleteFile = data.deleteFile;\r\n  for (const instanceUuid of instanceUuids) {\r\n    try {\r\n      InstanceSubsystem.removeInstance(instanceUuid, deleteFile);\r\n    } catch (err: any) {}\r\n  }\r\n  protocol.msg(ctx, \"instance/delete\", instanceUuids);\r\n});\r\n\r\n// perform complex asynchronous tasks\r\nrouterApp.on(\"instance/asynchronous\", (ctx, data) => {\r\n  const instanceUuid = data.instanceUuid;\r\n  const taskName = data.taskName;\r\n  const parameter = data.parameter;\r\n  const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n\r\n  logger.info(\r\n    $t(\"TXT_CODE_Instance_router.performTasks\", {\r\n      id: ctx.socket.id,\r\n      uuid: instanceUuid,\r\n      taskName: taskName\r\n    })\r\n  );\r\n\r\n  // Install instance via preset package\r\n  if (taskName === \"install_instance\" && instance) {\r\n    instance\r\n      .execPreset(\"install\", parameter)\r\n      .then(() => {})\r\n      .catch((err) => {\r\n        logger.error(\r\n          $t(\"TXT_CODE_Instance_router.performTasksErr\", {\r\n            uuid: instance.instanceUuid,\r\n            taskName: taskName,\r\n            err: err\r\n          })\r\n        );\r\n      });\r\n  }\r\n\r\n  // Instance software update via Command\r\n  if (taskName === \"update\" && instance) {\r\n    instance\r\n      .execPreset(\"update\", parameter)\r\n      .then(() => {})\r\n      .catch((err) => {\r\n        logger.error(\r\n          $t(\"TXT_CODE_Instance_router.performTasksErr\", {\r\n            uuid: instance.instanceUuid,\r\n            taskName: taskName,\r\n            err: err\r\n          })\r\n        );\r\n      });\r\n  }\r\n  // Quick install Minecraft server task\r\n  if (taskName === \"quick_install\") {\r\n    const newInstanceName = String(parameter.newInstanceName);\r\n    const targetLink = String(parameter.targetLink);\r\n    logger.info(`Quick install: Name: ${newInstanceName} | Download: ${targetLink}`);\r\n    const task = createQuickInstallTask(targetLink, newInstanceName, parameter.setupInfo);\r\n    return protocol.response(ctx, task.toObject());\r\n  }\r\n\r\n  protocol.response(ctx, true);\r\n});\r\n\r\n// Terminate the execution of complex asynchronous tasks\r\nrouterApp.on(\"instance/stop_asynchronous\", (ctx, data) => {\r\n  const instanceUuid = data.instanceUuid;\r\n  const { taskId } = data.parameter;\r\n  const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n\r\n  // Multi-instance async task\r\n  if (taskId && typeof taskId === \"string\") {\r\n    const task = TaskCenter.getTask(taskId);\r\n    if (!task) throw new Error(`Async Task ID: ${taskId} does not exist`);\r\n    task.stop();\r\n    return protocol.response(ctx, true);\r\n  }\r\n\r\n  // Singleton async task\r\n  const task = instance?.asynchronousTask;\r\n  if (task && task.stop) {\r\n    task\r\n      .stop(instance)\r\n      .then(() => {})\r\n      .catch((err) => {});\r\n  } else {\r\n    return protocol.error(\r\n      ctx,\r\n      \"instance/stop_asynchronous\",\r\n      $t(\"TXT_CODE_Instance_router.taskEmpty\")\r\n    );\r\n  }\r\n\r\n  protocol.response(ctx, true);\r\n});\r\n\r\n// Query async task status\r\nrouterApp.on(\"instance/query_asynchronous\", (ctx, data) => {\r\n  const taskId = data.parameter.taskId as string | undefined;\r\n  const taskName = data.taskName as string;\r\n  const taskNameTypeMap: IJson<string> = {\r\n    quick_install: QuickInstallTask.TYPE\r\n  };\r\n  const type = String(taskNameTypeMap[taskName] || QuickInstallTask.TYPE);\r\n  if (!taskId) {\r\n    const result = [];\r\n    for (const task of TaskCenter.getTasks(type)) {\r\n      result.push({\r\n        taskId: task.taskId,\r\n        status: task.status(),\r\n        detail: task.toObject()\r\n      });\r\n    }\r\n    protocol.response(ctx, result);\r\n  } else {\r\n    const task = TaskCenter.getTask(String(taskId));\r\n    if (task)\r\n      protocol.response(ctx, {\r\n        taskId: task.taskId,\r\n        status: task.status(),\r\n        detail: task.toObject()\r\n      });\r\n  }\r\n});\r\n\r\nrouterApp.on(\"instance/process_config/list\", (ctx, data) => {\r\n  const instanceUuid = data.instanceUuid;\r\n  const files = data.files;\r\n  const result: any[] = [];\r\n  try {\r\n    const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n    if (!instance) throw new Error($t(\"TXT_CODE_3bfb9e04\"));\r\n    const fileManager = new FileManager(instance.absoluteCwdPath());\r\n    for (const filePath of files) {\r\n      if (fileManager.check(filePath)) {\r\n        result.push({\r\n          file: filePath,\r\n          check: true\r\n        });\r\n      }\r\n    }\r\n    protocol.response(ctx, result);\r\n  } catch (err: any) {\r\n    protocol.responseError(ctx, err);\r\n  }\r\n});\r\n\r\n// Get or update the content of the instance specified file\r\nrouterApp.on(\"instance/process_config/file\", (ctx, data) => {\r\n  const instanceUuid = data.instanceUuid;\r\n  const fileName = data.fileName;\r\n  const config = data.config || null;\r\n  const fileType = data.type;\r\n  try {\r\n    const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n    if (!instance) throw new Error($t(\"TXT_CODE_3bfb9e04\"));\r\n    const fileManager = new FileManager(instance.absoluteCwdPath());\r\n    if (!fileManager.check(fileName)) throw new Error($t(\"TXT_CODE_Instance_router.accessFileErr\"));\r\n    const filePath = path.normalize(path.join(instance.absoluteCwdPath(), fileName));\r\n    const processConfig = new ProcessConfig({\r\n      fileName: fileName,\r\n      redirect: fileName,\r\n      path: filePath,\r\n      type: fileType,\r\n      info: null,\r\n      fromLink: null\r\n    });\r\n    if (config) {\r\n      processConfig.write(config);\r\n      return protocol.response(ctx, true);\r\n    } else {\r\n      const json = processConfig.read();\r\n      return protocol.response(ctx, json);\r\n    }\r\n  } catch (err: any) {\r\n    protocol.responseError(ctx, err);\r\n  }\r\n});\r\n\r\n// Get instance terminal log\r\nrouterApp.on(\"instance/outputlog\", async (ctx, data) => {\r\n  const instanceUuid = data.instanceUuid;\r\n  try {\r\n    const filePath = path.join(InstanceSubsystem.LOG_DIR, `${instanceUuid}.log`);\r\n    if (fs.existsSync(filePath)) {\r\n      const text = await fs.readFile(filePath, { encoding: \"utf-8\" });\r\n      return protocol.response(ctx, text);\r\n    }\r\n    protocol.responseError(ctx, new Error($t(\"TXT_CODE_Instance_router.terminalLogNotExist\")), {\r\n      disablePrint: true\r\n    });\r\n  } catch (err: any) {\r\n    protocol.responseError(ctx, err);\r\n  }\r\n});\r\n","import { $t } from \"../i18n\";\r\nimport { routerApp } from \"../service/router\";\r\nimport * as protocol from \"../service/protocol\";\r\nimport { globalConfiguration } from \"../entity/config\";\r\nimport logger from \"../service/log\";\r\nimport RouterContext from \"../entity/ctx\";\r\nimport { IGNORE } from \"../const\";\r\nimport { LOGIN_BY_TOP_LEVEL, loginSuccessful } from \"../service/mission_passport\";\r\n\r\n// latest verification time\r\nconst AUTH_TIMEOUT = 6000;\r\n\r\n// Top-level authority authentication middleware (this is the first place for any authority authentication middleware)\r\nrouterApp.use(async (event, ctx, _, next) => {\r\n  const socket = ctx.socket;\r\n  // release all data flow controllers\r\n  if (event.startsWith(\"stream\")) return next();\r\n  // Except for the auth controller, which is publicly accessible, other business controllers must be authorized before they can be accessed\r\n  if (event === \"auth\") return await next();\r\n  if (!ctx.session) throw new Error(\"Session does not exist in authentication middleware.\");\r\n  if (\r\n    ctx.session.key === globalConfiguration.config.key &&\r\n    ctx.session.type === LOGIN_BY_TOP_LEVEL &&\r\n    ctx.session.login &&\r\n    ctx.session.id\r\n  ) {\r\n    return await next();\r\n  }\r\n  logger.warn(\r\n    $t(\"TXT_CODE_auth_router.notAccess\", {\r\n      id: socket.id,\r\n      address: socket.handshake.address,\r\n      event: event\r\n    })\r\n  );\r\n  return protocol.error(ctx, \"error\", IGNORE, {\r\n    disablePrint: true\r\n  });\r\n});\r\n\r\n// authentication controller\r\nrouterApp.on(\"auth\", (ctx, data) => {\r\n  if (data === globalConfiguration.config.key) {\r\n    // The authentication is passed, and the registered session is a trusted session\r\n    logger.info(\r\n      $t(\"TXT_CODE_auth_router.access\", {\r\n        id: ctx.socket.id,\r\n        address: ctx.socket.handshake.address\r\n      })\r\n    );\r\n    loginSuccessful(ctx, data);\r\n    protocol.msg(ctx, \"auth\", true);\r\n  } else {\r\n    protocol.msg(ctx, \"auth\", false);\r\n  }\r\n});\r\n\r\n// Connected event for timeout authentication close\r\nrouterApp.on(\"connection\", (ctx) => {\r\n  const session = ctx.session;\r\n  setTimeout(() => {\r\n    if (!session.login) {\r\n      ctx.socket.disconnect();\r\n      logger.info(\r\n        $t(\"TXT_CODE_auth_router.disconnect\", {\r\n          id: ctx.socket.id,\r\n          address: ctx.socket.handshake.address\r\n        })\r\n      );\r\n    }\r\n  }, AUTH_TIMEOUT);\r\n});\r\n","import { $t } from \"../i18n\";\r\nimport { DockerManager } from \"../service/docker_service\";\r\nimport * as protocol from \"../service/protocol\";\r\nimport { routerApp } from \"../service/router\";\r\nimport * as fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { v4 } from \"uuid\";\r\nimport logger from \"../service/log\";\r\nimport os from \"os\";\r\n\r\n// Get the image list of this system\r\nrouterApp.on(\"environment/images\", async (ctx, data) => {\r\n  try {\r\n    const docker = new DockerManager().getDocker();\r\n    const result = await docker.listImages();\r\n    protocol.response(ctx, result);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, $t(\"TXT_CODE_environment_router.dockerInfoErr\"));\r\n  }\r\n});\r\n\r\n// Get the list of containers in this system\r\nrouterApp.on(\"environment/containers\", async (ctx, data) => {\r\n  try {\r\n    const docker = new DockerManager().getDocker();\r\n    const result = await docker.listContainers();\r\n    protocol.response(ctx, result);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// Get the network list of this system\r\nrouterApp.on(\"environment/networkModes\", async (ctx, data) => {\r\n  try {\r\n    const docker = new DockerManager().getDocker();\r\n    const result = await docker.listNetworks();\r\n    protocol.response(ctx, result);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// create image\r\nrouterApp.on(\"environment/new_image\", async (ctx, data) => {\r\n  try {\r\n    const dockerFileText = data.dockerFile;\r\n    const name = data.name;\r\n    const tag = data.tag;\r\n    // Initialize the image file directory and Dockerfile\r\n    const uuid = v4();\r\n    const dockerFileDir = path.normalize(path.join(process.cwd(), \"tmp\", uuid));\r\n    if (!fs.existsSync(dockerFileDir)) fs.mkdirsSync(dockerFileDir);\r\n\r\n    // write to DockerFile\r\n    const dockerFilepath = path.normalize(path.join(dockerFileDir, \"Dockerfile\"));\r\n    await fs.writeFile(dockerFilepath, dockerFileText, { encoding: \"utf-8\" });\r\n\r\n    logger.info(\r\n      $t(\"TXT_CODE_environment_router.crateImage\", {\r\n        name: name,\r\n        tag: tag,\r\n        dockerFileText: dockerFileText\r\n      })\r\n    );\r\n\r\n    // pre-response\r\n    protocol.response(ctx, true);\r\n\r\n    // start creating\r\n    const dockerImageName = `${name}:${tag}`;\r\n    try {\r\n      await new DockerManager().startBuildImage(dockerFileDir, dockerImageName);\r\n      logger.info($t(\"TXT_CODE_environment_router.crateSuccess\", { name: name, tag: tag }));\r\n    } catch (error: any) {\r\n      logger.info(\r\n        $t(\"TXT_CODE_environment_router.crateErr\", { name: name, tag: tag, error: error })\r\n      );\r\n    }\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// delete image\r\nrouterApp.on(\"environment/del_image\", async (ctx, data) => {\r\n  try {\r\n    const imageId = data.imageId;\r\n    const docker = new DockerManager().getDocker();\r\n    const image = docker.getImage(imageId);\r\n    if (image) {\r\n      logger.info($t(\"TXT_CODE_environment_router.delImage\", { imageId: imageId }));\r\n      await image.remove();\r\n    } else {\r\n      throw new Error(\"Image does not exist\");\r\n    }\r\n    protocol.response(ctx, true);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// Get the progress of all mirroring tasks\r\nrouterApp.on(\"environment/progress\", async (ctx) => {\r\n  try {\r\n    const data: any = {};\r\n    DockerManager.builderProgress.forEach((v, k) => {\r\n      data[k] = v;\r\n    });\r\n    protocol.response(ctx, data);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n","import { $t } from \"../i18n\";\r\nimport * as protocol from \"../service/protocol\";\r\nimport { routerApp } from \"../service/router\";\r\nimport InstanceSubsystem from \"../service/system_instance\";\r\nimport { getFileManager } from \"../service/file_router_service\";\r\nimport { globalConfiguration, globalEnv } from \"../entity/config\";\r\nimport os from \"os\";\r\nimport * as nodeDiskInfo from \"node-disk-info\";\r\n\r\nlet diskInfos: any[] = [];\r\nif (os.platform() === \"win32\") {\r\n  diskInfos = nodeDiskInfo.getDiskInfoSync();\r\n}\r\n\r\n// Some routers operate router authentication middleware\r\nrouterApp.use((event, ctx, data, next) => {\r\n  if (event.startsWith(\"file/\")) {\r\n    const instanceUuid = data.instanceUuid;\r\n    if (!InstanceSubsystem.exists(instanceUuid)) {\r\n      return protocol.error(ctx, event, {\r\n        instanceUuid: instanceUuid,\r\n        err: $t(\"TXT_CODE_file_router.instanceNotExist\", { instanceUuid: instanceUuid })\r\n      });\r\n    }\r\n  }\r\n  next();\r\n});\r\n\r\n// List the files in the specified instance working directory\r\nrouterApp.on(\"file/list\", (ctx, data) => {\r\n  try {\r\n    const fileManager = getFileManager(data.instanceUuid);\r\n    const { page, pageSize, target, fileName } = data;\r\n    fileManager.cd(target);\r\n    const overview = fileManager.list(page, pageSize, fileName);\r\n    protocol.response(ctx, overview);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// File chmod (only Linux)\r\nrouterApp.on(\"file/chmod\", async (ctx, data) => {\r\n  try {\r\n    const fileManager = getFileManager(data.instanceUuid);\r\n    const { chmod, target, deep } = data;\r\n    await fileManager.chmod(target, chmod, deep);\r\n    protocol.response(ctx, true);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// Query the status of the file management system\r\nrouterApp.on(\"file/status\", async (ctx, data) => {\r\n  try {\r\n    const instance = InstanceSubsystem.getInstance(data.instanceUuid);\r\n    if (!instance) throw new Error($t(\"TXT_CODE_3bfb9e04\"));\r\n    protocol.response(ctx, {\r\n      instanceFileTask: instance.info.fileLock ?? 0,\r\n      globalFileTask: globalEnv.fileTaskCount ?? 0,\r\n      platform: os.platform(),\r\n      isGlobalInstance: data.instanceUuid === InstanceSubsystem.GLOBAL_INSTANCE_UUID,\r\n      disks: diskInfos.map((v) => {\r\n        return String(v._mounted).replace(\":\", \"\");\r\n      })\r\n    });\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// Create a new file\r\nrouterApp.on(\"file/touch\", (ctx, data) => {\r\n  try {\r\n    const target = data.target;\r\n    const fileManager = getFileManager(data.instanceUuid);\r\n    fileManager.newFile(target);\r\n    protocol.response(ctx, true);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// Create a directory\r\nrouterApp.on(\"file/mkdir\", (ctx, data) => {\r\n  try {\r\n    const target = data.target;\r\n    const fileManager = getFileManager(data.instanceUuid);\r\n    fileManager.mkdir(target);\r\n    protocol.response(ctx, true);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// copy the file\r\nrouterApp.on(\"file/copy\", async (ctx, data) => {\r\n  try {\r\n    // [[\"a.txt\",\"b.txt\"],[\"cxz\",\"zzz\"]]\r\n    const targets = data.targets;\r\n    const fileManager = getFileManager(data.instanceUuid);\r\n    for (const target of targets) {\r\n      fileManager.copy(target[0], target[1]);\r\n    }\r\n    protocol.response(ctx, true);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// move the file\r\nrouterApp.on(\"file/move\", async (ctx, data) => {\r\n  try {\r\n    // [[\"a.txt\",\"b.txt\"],[\"cxz\",\"zzz\"]]\r\n    const targets = data.targets;\r\n    const fileManager = getFileManager(data.instanceUuid);\r\n    for (const target of targets) {\r\n      await fileManager.move(target[0], target[1]);\r\n    }\r\n    protocol.response(ctx, true);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// Delete Files\r\nrouterApp.on(\"file/delete\", async (ctx, data) => {\r\n  try {\r\n    const targets = data.targets;\r\n    const fileManager = getFileManager(data.instanceUuid);\r\n    for (const target of targets) {\r\n      // async delete\r\n      fileManager.delete(target);\r\n    }\r\n    protocol.response(ctx, true);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// edit file\r\nrouterApp.on(\"file/edit\", async (ctx, data) => {\r\n  try {\r\n    const target = data.target;\r\n    const text = data.text;\r\n    const fileManager = getFileManager(data.instanceUuid);\r\n    const result = await fileManager.edit(target, text);\r\n    protocol.response(ctx, result ? result : true);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// compress/decompress the file\r\nrouterApp.on(\"file/compress\", async (ctx, data) => {\r\n  const maxFileTask = globalConfiguration.config.maxFileTask;\r\n  try {\r\n    const source = data.source;\r\n    const targets = data.targets;\r\n    const type = data.type;\r\n    const code = data.code;\r\n    const fileManager = getFileManager(data.instanceUuid);\r\n    const instance = InstanceSubsystem.getInstance(data.instanceUuid);\r\n    if (!instance) throw new Error($t(\"TXT_CODE_3bfb9e04\"));\r\n    if (instance.info.fileLock >= maxFileTask) {\r\n      throw new Error(\r\n        $t(\"TXT_CODE_file_router.unzipLimit\", {\r\n          maxFileTask: maxFileTask,\r\n          fileLock: instance.info.fileLock\r\n        })\r\n      );\r\n    }\r\n    // Statistics of the number of tasks in a single instance file and the number of tasks in the entire daemon process\r\n    function fileTaskStart() {\r\n      if (instance) {\r\n        instance.info.fileLock++;\r\n        globalEnv.fileTaskCount++;\r\n      }\r\n    }\r\n    function fileTaskEnd() {\r\n      if (instance) {\r\n        instance.info.fileLock--;\r\n        globalEnv.fileTaskCount--;\r\n      }\r\n    }\r\n\r\n    // start decompressing or compressing the file\r\n    fileTaskStart();\r\n    try {\r\n      if (type === 1) {\r\n        await fileManager.zip(source, targets, code);\r\n      } else {\r\n        await fileManager.unzip(source, targets, code);\r\n      }\r\n      protocol.response(ctx, true);\r\n    } catch (error: any) {\r\n      throw error;\r\n    } finally {\r\n      fileTaskEnd();\r\n    }\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n","import { $t } from \"../i18n\";\r\nimport Router from \"@koa/router\";\r\nimport send from \"koa-send\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { missionPassport } from \"../service/mission_passport\";\r\nimport InstanceSubsystem from \"../service/system_instance\";\r\nimport FileManager from \"../service/system_file\";\r\nimport formidable from \"formidable\";\r\nimport { clearUploadFiles } from \"../tools/filepath\";\r\n\r\nconst router = new Router();\r\n\r\n// Define the HTTP home page display route\r\nrouter.all(\"/\", async (ctx) => {\r\n  ctx.body = \"[MCSManager Daemon] Status: OK | reference: https://mcsmanager.com/\";\r\n  ctx.status = 200;\r\n});\r\n\r\n// file download route\r\nrouter.get(\"/download/:key/:fileName\", async (ctx) => {\r\n  const key = ctx.params.key;\r\n  const paramsFileName = ctx.params.fileName;\r\n  try {\r\n    // Get the task from the task center\r\n    const mission = missionPassport.getMission(key, \"download\");\r\n    if (!mission) throw new Error((ctx.body = \"Access denied: No task found\"));\r\n    const instance = InstanceSubsystem.getInstance(mission.parameter.instanceUuid);\r\n    if (!instance) throw new Error($t(\"TXT_CODE_http_router.instanceNotExist\"));\r\n    if (!FileManager.checkFileName(paramsFileName))\r\n      throw new Error($t(\"TXT_CODE_http_router.fileNameNotSpec\"));\r\n\r\n    const cwd = instance.config.cwd;\r\n    const fileRelativePath = mission.parameter.fileName;\r\n\r\n    // Check for file cross-directory security risks\r\n    const fileManager = new FileManager(cwd);\r\n    if (!fileManager.check(fileRelativePath))\r\n      throw new Error((ctx.body = \"Access denied: Invalid destination\"));\r\n\r\n    // send File\r\n    const fileAbsPath = fileManager.toAbsolutePath(fileRelativePath);\r\n    const fileDir = path.dirname(fileAbsPath);\r\n    const fileName = path.basename(fileAbsPath);\r\n    ctx.set(\"Content-Type\", \"application/octet-stream\");\r\n    await send(ctx, fileName, { root: fileDir + \"/\", hidden: true });\r\n  } catch (error: any) {\r\n    ctx.body = $t(\"TXT_CODE_http_router.downloadErr\", { error: error.message });\r\n    ctx.status = 500;\r\n  } finally {\r\n    missionPassport.deleteMission(key);\r\n  }\r\n});\r\n\r\n// File upload route\r\nrouter.post(\"/upload/:key\", async (ctx) => {\r\n  const key = ctx.params.key;\r\n  const unzip = ctx.query.unzip;\r\n  const zipCode = String(ctx.query.code);\r\n  let tmpFiles: formidable.File | formidable.File[] | undefined;\r\n  try {\r\n    const mission = missionPassport.getMission(key, \"upload\");\r\n    if (!mission) throw new Error(\"Access denied: No task found\");\r\n    const instance = InstanceSubsystem.getInstance(mission.parameter.instanceUuid);\r\n    if (!instance) throw new Error(\"Access denied: No instance found\");\r\n    const uploadDir = mission.parameter.uploadDir;\r\n    const cwd = instance.config.cwd;\r\n    const tmpFiles = ctx.request.files?.file;\r\n    if (tmpFiles) {\r\n      let uploadedFile: formidable.File;\r\n      if (tmpFiles instanceof Array) {\r\n        uploadedFile = tmpFiles[0];\r\n      } else {\r\n        throw new Error(\"Access denied: Files must a array!\");\r\n      }\r\n      const originFileName = uploadedFile.originalFilename || \"\";\r\n      const originFilePath = uploadedFile.filepath || \"\";\r\n      const fileSaveRelativePath = path.normalize(path.join(uploadDir, originFileName));\r\n      if (!FileManager.checkFileName(path.basename(originFileName)))\r\n        throw new Error(\"Access denied: Malformed file name\");\r\n      const fileManager = new FileManager(cwd);\r\n      if (!fileManager.checkPath(fileSaveRelativePath))\r\n        throw new Error(\"Access denied: Invalid destination\");\r\n      const fileSaveAbsolutePath = fileManager.toAbsolutePath(fileSaveRelativePath);\r\n      await fs.move(uploadedFile.filepath, fileSaveAbsolutePath);\r\n      if (unzip) {\r\n        const fileManager = new FileManager(instance.config.cwd);\r\n        fileManager.unzip(originFilePath, \"\", zipCode);\r\n      }\r\n      ctx.body = \"OK\";\r\n      return;\r\n    }\r\n    ctx.body = \"Access denied: No file found\";\r\n    ctx.status = 500;\r\n  } catch (error: any) {\r\n    ctx.body = error.message;\r\n    ctx.status = 500;\r\n  } finally {\r\n    missionPassport.deleteMission(key);\r\n    if (tmpFiles) clearUploadFiles(tmpFiles);\r\n  }\r\n});\r\nexport default router;\r\n","import * as protocol from \"../service/protocol\";\r\nimport { routerApp } from \"../service/router\";\r\nimport InstanceSubsystem from \"../service/system_instance\";\r\nimport Instance from \"../entity/instance/instance\";\r\n\r\nimport { systemInfo } from \"common\";\r\nimport { getVersion } from \"../service/version\";\r\nimport { globalConfiguration } from \"../entity/config\";\r\nimport i18next from \"i18next\";\r\nimport logger from \"../service/log\";\r\nimport fs from \"fs-extra\";\r\nimport { LOCAL_PRESET_LANG_PATH } from \"../const\";\r\nimport VisualDataSubsystem from \"../service/system_visual_data\";\r\n\r\n// Get the basic information of the daemon system\r\nrouterApp.on(\"info/overview\", async (ctx) => {\r\n  const daemonVersion = getVersion();\r\n  let total = 0;\r\n  let running = 0;\r\n  InstanceSubsystem.getInstances().forEach((v) => {\r\n    total++;\r\n    if (v.status() == Instance.STATUS_RUNNING) running++;\r\n  });\r\n  const info = {\r\n    version: daemonVersion,\r\n    process: {\r\n      cpu: process.cpuUsage().system,\r\n      memory: process.memoryUsage().heapUsed,\r\n      cwd: process.cwd()\r\n    },\r\n    instance: {\r\n      running,\r\n      total\r\n    },\r\n    system: systemInfo(),\r\n    cpuMemChart: VisualDataSubsystem.getSystemChartArray()\r\n  };\r\n  protocol.response(ctx, info);\r\n});\r\n\r\nrouterApp.on(\"info/setting\", async (ctx, data) => {\r\n  const language = String(data.language);\r\n  try {\r\n    logger.warn(\"Language change:\", language);\r\n    i18next.changeLanguage(language);\r\n    fs.remove(LOCAL_PRESET_LANG_PATH, () => {});\r\n    globalConfiguration.config.language = language;\r\n    globalConfiguration.store();\r\n    protocol.response(ctx, true);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n","import path from \"path\";\r\n\r\nimport RouterContext from \"../entity/ctx\";\r\nimport * as protocol from \"../service/protocol\";\r\nimport InstanceSubsystem from \"../service/system_instance\";\r\nimport fs from \"fs-extra\";\r\nconst MAX_LOG_SIZE = 512;\r\n\r\n// buffer\r\nconst buffer = new Map<string, string>();\r\nsetInterval(() => {\r\n  buffer.forEach((buf, instanceUuid) => {\r\n    if (!buf || !instanceUuid) return;\r\n    const logFilePath = path.join(InstanceSubsystem.LOG_DIR, `${instanceUuid}.log`);\r\n    if (!fs.existsSync(InstanceSubsystem.LOG_DIR)) fs.mkdirsSync(InstanceSubsystem.LOG_DIR);\r\n    try {\r\n      const fileInfo = fs.statSync(logFilePath);\r\n      if (fileInfo && fileInfo.size > 1024 * MAX_LOG_SIZE) fs.removeSync(logFilePath);\r\n    } catch (err: any) {}\r\n    fs.writeFile(logFilePath, buf, { encoding: \"utf-8\", flag: \"a\" }, () => {\r\n      buffer.set(instanceUuid, \"\");\r\n    });\r\n  });\r\n}, 500);\r\n\r\n// output stream record to buffer\r\nasync function outputLog(instanceUuid: string, text: string) {\r\n  const buf = (buffer.get(instanceUuid) ?? \"\") + text;\r\n  if (buf.length > 1024 * 1024) buffer.set(instanceUuid, \"\");\r\n  buffer.set(instanceUuid, buf ?? null);\r\n}\r\n\r\n// instance output stream event\r\n// By default, it is added to the data cache to control the sending rate to ensure its stability\r\nInstanceSubsystem.on(\"data\", (instanceUuid: string, text: string) => {\r\n  InstanceSubsystem.forEachForward(instanceUuid, (socket) => {\r\n    protocol.msg(new RouterContext(null, socket), \"instance/stdout\", {\r\n      instanceUuid: instanceUuid,\r\n      text: text\r\n    });\r\n  });\r\n  // Append the output to the log file\r\n  outputLog(instanceUuid, text)\r\n    .then(() => {})\r\n    .catch(() => {});\r\n});\r\n\r\n// instance exit event\r\nInstanceSubsystem.on(\"exit\", (obj: any) => {\r\n  InstanceSubsystem.forEachForward(obj.instanceUuid, (socket) => {\r\n    protocol.msg(new RouterContext(null, socket), \"instance/stopped\", {\r\n      instanceUuid: obj.instanceUuid,\r\n      instanceName: obj.instanceName\r\n    });\r\n  });\r\n});\r\n\r\n// instance start event\r\nInstanceSubsystem.on(\"open\", (obj: any) => {\r\n  InstanceSubsystem.forEachForward(obj.instanceUuid, (socket) => {\r\n    protocol.msg(new RouterContext(null, socket), \"instance/opened\", {\r\n      instanceUuid: obj.instanceUuid,\r\n      instanceName: obj.instanceName\r\n    });\r\n  });\r\n});\r\n\r\n// Instance failure event (usually used for startup failure, or other operation failures)\r\nInstanceSubsystem.on(\"failure\", (obj: any) => {\r\n  InstanceSubsystem.forEachForward(obj.instanceUuid, (socket) => {\r\n    protocol.msg(new RouterContext(null, socket), \"instance/failure\", {\r\n      instanceUuid: obj.instanceUuid,\r\n      instanceName: obj.instanceName\r\n    });\r\n  });\r\n});\r\n","import { $t } from \"../i18n\";\r\nimport { routerApp } from \"../service/router\";\r\nimport { missionPassport } from \"../service/mission_passport\";\r\nimport * as protocol from \"../service/protocol\";\r\n\r\nconst ONE_HOUR_TIME = 3600000;\r\nconst TASK_MAX_TIME = 1;\r\n\r\n// register temporary task passport\r\n// For example, file upload, file download, these operations that need to bypass the Web side,\r\n// all need to use this route\r\nrouterApp.on(\"passport/register\", (ctx, data) => {\r\n  const name = data.name;\r\n  const password = data.password;\r\n  const parameter = data.parameter;\r\n  const count = data.count;\r\n  const start = new Date().getTime();\r\n  const end = start + ONE_HOUR_TIME * TASK_MAX_TIME;\r\n  if (!name || !password) throw new Error($t(\"TXT_CODE_passport_router.registerErr\"));\r\n  missionPassport.registerMission(password, {\r\n    name,\r\n    parameter,\r\n    count,\r\n    start,\r\n    end\r\n  });\r\n  protocol.response(ctx, true);\r\n});\r\n","import { routerApp } from \"../service/router\";\r\nimport * as protocol from \"../service/protocol\";\r\nimport InstanceControlSubsystem from \"../service/system_instance_control\";\r\n\r\n// create a scheduled task\r\nrouterApp.on(\"schedule/register\", (ctx, data) => {\r\n  try {\r\n    InstanceControlSubsystem.registerScheduleJob(data);\r\n    protocol.response(ctx, true);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// get the task list\r\nrouterApp.on(\"schedule/list\", (ctx, data) => {\r\n  protocol.response(ctx, InstanceControlSubsystem.listScheduleJob(data.instanceUuid));\r\n});\r\n\r\n// delete the task plan\r\nrouterApp.on(\"schedule/delete\", (ctx, data) => {\r\n  InstanceControlSubsystem.deleteScheduleTask(data.instanceUuid, data.name);\r\n  protocol.response(ctx, true);\r\n});\r\n","import { $t } from \"../i18n\";\r\nimport * as protocol from \"../service/protocol\";\r\nimport { routerApp } from \"../service/router\";\r\nimport {\r\n  LOGIN_FROM_STREAM,\r\n  missionPassport,\r\n  streamLoginSuccessful\r\n} from \"../service/mission_passport\";\r\nimport InstanceSubsystem from \"../service/system_instance\";\r\nimport SendCommand from \"../entity/commands/cmd\";\r\nimport { IGNORE } from \"../const\";\r\nimport logger from \"../service/log\";\r\n\r\n// Authorization authentication middleware\r\nrouterApp.use(async (event, ctx, data, next) => {\r\n  // release data flow authentication route\r\n  if (event === \"stream/auth\") return next();\r\n  // Check other routes for data flow\r\n  if (event.startsWith(\"stream\")) {\r\n    if (\r\n      ctx.session.stream &&\r\n      ctx.session?.stream?.check === true &&\r\n      ctx.session.type === LOGIN_FROM_STREAM\r\n    ) {\r\n      return await next();\r\n    }\r\n    return protocol.error(ctx, \"error\", IGNORE, {\r\n      disablePrint: true\r\n    });\r\n  }\r\n  return await next();\r\n});\r\n\r\n// Publicly accessible dataflow authentication route\r\nrouterApp.on(\"stream/auth\", (ctx, data) => {\r\n  try {\r\n    const password = data.password;\r\n    const mission = missionPassport.getMission(password, \"stream_channel\");\r\n    if (!mission) throw new Error($t(\"TXT_CODE_stream_router.taskNotExist\"));\r\n    const instance = InstanceSubsystem.getInstance(mission.parameter.instanceUuid);\r\n    if (!instance) throw new Error($t(\"TXT_CODE_stream_router.instanceNotExist\"));\r\n    // Auth success!\r\n    streamLoginSuccessful(ctx, instance.instanceUuid);\r\n    // Start forwarding output stream data to this Socket\r\n    InstanceSubsystem.forward(instance.instanceUuid, ctx.socket);\r\n    // Cancel forwarding events when registration is disconnected\r\n    ctx.socket.on(\"disconnect\", () => {\r\n      InstanceSubsystem.stopForward(instance.instanceUuid, ctx.socket);\r\n    });\r\n    protocol.response(ctx, true);\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error, {\r\n      disablePrint: true\r\n    });\r\n  }\r\n});\r\n\r\n// Get instance details\r\nrouterApp.on(\"stream/detail\", async (ctx) => {\r\n  try {\r\n    const instanceUuid = ctx.session?.stream?.instanceUuid;\r\n    const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n    if (!instance) throw new Error($t(\"TXT_CODE_3bfb9e04\"));\r\n    protocol.response(ctx, {\r\n      instanceUuid: instance.instanceUuid,\r\n      started: instance.startCount,\r\n      status: instance.status(),\r\n      config: instance.config,\r\n      info: instance.info,\r\n      watcher: instance.watchers.size\r\n    });\r\n  } catch (error: any) {\r\n    protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// Execute commands, line-based interactive input and output streams for ordinary processes\r\nrouterApp.on(\"stream/input\", async (ctx, data) => {\r\n  try {\r\n    const command = data.command;\r\n    const instanceUuid = ctx.session?.stream?.instanceUuid;\r\n    const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n    await instance?.exec(new SendCommand(command));\r\n  } catch (error: any) {\r\n    // Ignore potential high frequency exceptions here\r\n    // protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// Process terminal input, suitable for direct connection input and output streams of simulated terminals.\r\nrouterApp.on(\"stream/write\", async (ctx, data) => {\r\n  try {\r\n    const buf = data.input;\r\n    const instanceUuid = ctx.session?.stream?.instanceUuid;\r\n    const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n    // run without command execution\r\n    if (instance?.process) instance.process.write(buf);\r\n  } catch (error: any) {\r\n    // Ignore potential high frequency exceptions here\r\n    // protocol.responseError(ctx, error);\r\n  }\r\n});\r\n\r\n// handle terminal resize\r\n// interface IResizeOptions {\r\n//   h: number;\r\n//   w: number;\r\n// }\r\nrouterApp.on(\"stream/resize\", async (ctx, data) => {\r\n  try {\r\n    const instanceUuid = ctx.session?.stream?.instanceUuid;\r\n    const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n    instance?.watchers.set(ctx.socket.id, {\r\n      terminalSize: {\r\n        w: Number(data.w) || 0,\r\n        h: Number(data.h) || 0\r\n      }\r\n    });\r\n    if (instance) await instance.execPreset(\"resize\");\r\n  } catch (error: any) {\r\n    // protocol.responseError(ctx, error);\r\n  }\r\n});\r\n","import EventEmitter from \"events\";\r\nimport logger from \"../log\";\r\n\r\nexport type IAsyncTaskJSON = any;\r\n\r\nexport interface IAsyncTask extends EventEmitter {\r\n  // The taskId must be complex enough to prevent other users from accessing the information\r\n  taskId: string;\r\n  type: string;\r\n  start(): Promise<void>;\r\n  stop(): Promise<void>;\r\n  status(): number;\r\n  toObject(): IAsyncTaskJSON;\r\n}\r\n\r\nexport abstract class AsyncTask extends EventEmitter implements IAsyncTask {\r\n  public static readonly STATUS_STOP = 0;\r\n  public static readonly STATUS_RUNNING = 1;\r\n  public static readonly STATUS_ERROR = -1;\r\n\r\n  public taskId: string = \"\";\r\n  public type: string = \"\";\r\n\r\n  public errorInfo?: Error;\r\n\r\n  protected _status = AsyncTask.STATUS_STOP;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  public async start() {\r\n    this._status = AsyncTask.STATUS_RUNNING;\r\n    try {\r\n      await this.onStart();\r\n      this.emit(\"started\");\r\n    } catch (error: any) {\r\n      this.error(error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  public async stop() {\r\n    if (this._status === AsyncTask.STATUS_STOP) return Promise.resolve();\r\n    try {\r\n      await this.onStop();\r\n    } finally {\r\n      if (this._status !== AsyncTask.STATUS_ERROR) this._status = AsyncTask.STATUS_STOP;\r\n      this.emit(\"stopped\");\r\n    }\r\n  }\r\n\r\n  public async error(err: Error) {\r\n    this._status = AsyncTask.STATUS_ERROR;\r\n    this.errorInfo = err;\r\n    logger.error(`AsyncTask - ID: ${this.taskId} TYPE: ${this.type} Error:`, err);\r\n    await this.onError(err);\r\n    this.emit(\"error\", err);\r\n    this.stop();\r\n  }\r\n\r\n  public wait() {\r\n    return new Promise<void>((resolve, reject) => {\r\n      if (this._status === AsyncTask.STATUS_STOP) {\r\n        return resolve();\r\n      }\r\n      if (this._status === AsyncTask.STATUS_ERROR) {\r\n        return reject(this.errorInfo);\r\n      }\r\n      this.once(\"stopped\", () => {\r\n        resolve();\r\n      });\r\n      this.once(\"error\", (err) => {\r\n        reject(err);\r\n      });\r\n    });\r\n  }\r\n\r\n  status(): number {\r\n    return this._status;\r\n  }\r\n\r\n  public abstract onStart(): Promise<void>;\r\n  public abstract onStop(): Promise<void>;\r\n  public abstract onError(err: Error): Promise<void>;\r\n  public abstract toObject(): IAsyncTaskJSON;\r\n}\r\n\r\nexport class TaskCenter {\r\n  public static tasks = new Array<IAsyncTask>();\r\n\r\n  public static addTask(t: IAsyncTask) {\r\n    TaskCenter.tasks.push(t);\r\n    t.start();\r\n    t.on(\"stopped\", () => TaskCenter.onTaskStopped(t));\r\n    t.on(\"error\", () => TaskCenter.onTaskError(t));\r\n  }\r\n\r\n  public static onTaskStopped(t: IAsyncTask) {\r\n    logger.info(\"Async Task:\", t.taskId, \"Stopped.\");\r\n  }\r\n\r\n  public static onTaskError(t: IAsyncTask) {\r\n    logger.info(\"Async Task:\", t.taskId, \"Failed.\");\r\n  }\r\n\r\n  public static getTask(taskId: string, type?: string) {\r\n    for (const iterator of TaskCenter.tasks) {\r\n      if (iterator.taskId === taskId && (type == null || iterator.type === type)) return iterator;\r\n    }\r\n  }\r\n\r\n  public static getTasks(type?: string) {\r\n    const result: IAsyncTask[] = [];\r\n    for (const iterator of TaskCenter.tasks) {\r\n      if (type == null || iterator.type === type) {\r\n        result.push(iterator);\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  public static deleteAllStoppedTask() {\r\n    TaskCenter.tasks.forEach((v, i, arr) => {\r\n      if (v.status() !== 1) {\r\n        arr.splice(i, 1);\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { v4 } from \"uuid\";\r\nimport axios from \"axios\";\r\nimport { pipeline, Readable } from \"stream\";\r\nimport fs from \"fs-extra\";\r\nimport Instance from \"../../entity/instance/instance\";\r\nimport InstanceSubsystem from \"../system_instance\";\r\nimport InstanceConfig from \"../../entity/instance/Instance_config\";\r\nimport { $t } from \"../../i18n\";\r\nimport path from \"path\";\r\nimport { getFileManager } from \"../file_router_service\";\r\nimport { IAsyncTaskJSON, TaskCenter, AsyncTask } from \"./index\";\r\nimport logger from \"../log\";\r\nimport { t } from \"i18next\";\r\nimport type { IJsonData } from \"common/global\";\r\nimport { InstanceUpdateAction } from \"../instance_update_action\";\r\n\r\nexport class QuickInstallTask extends AsyncTask {\r\n  public static TYPE = \"QuickInstallTask\";\r\n\r\n  public instance: Instance;\r\n  public readonly TMP_ZIP_NAME = \"mcsm_install_package.zip\";\r\n  public readonly ZIP_CONFIG_JSON = \"mcsmanager-config.json\";\r\n  public filePath = \"\";\r\n  public extName = \"\";\r\n\r\n  private downloadStream?: fs.WriteStream;\r\n  private writeStream?: fs.WriteStream;\r\n  private updateTask?: InstanceUpdateAction;\r\n\r\n  constructor(\r\n    public instanceName: string,\r\n    public targetLink?: string,\r\n    public buildParams?: Partial<InstanceConfig>,\r\n    curInstance?: Instance\r\n  ) {\r\n    super();\r\n    const config = new InstanceConfig();\r\n    config.nickname = instanceName;\r\n    config.stopCommand = \"^c\";\r\n    if (!curInstance) {\r\n      config.cwd = \"\";\r\n      this.instance = InstanceSubsystem.createInstance(config);\r\n    } else {\r\n      this.instance = curInstance;\r\n    }\r\n    this.taskId = `${QuickInstallTask.TYPE}-${this.instance.instanceUuid}-${v4()}`;\r\n    this.type = QuickInstallTask.TYPE;\r\n    this.extName = path.extname(this.targetLink ?? \"\") || \".zip\";\r\n  }\r\n\r\n  private download(): Promise<boolean> {\r\n    return new Promise(async (resolve, reject) => {\r\n      try {\r\n        if (!this.targetLink) return reject(new Error(\"No targetLink!\"));\r\n        let downloadFileName = this.TMP_ZIP_NAME;\r\n        if (this.extName !== \".zip\") {\r\n          const url = new URL(this.targetLink);\r\n          downloadFileName = url.pathname.split(\"/\").pop() || `application${this.extName}`;\r\n        }\r\n        this.filePath = path.normalize(path.join(this.instance.config.cwd, downloadFileName));\r\n        this.writeStream = fs.createWriteStream(this.filePath);\r\n        const response = await axios<Readable>({\r\n          url: this.targetLink,\r\n          responseType: \"stream\"\r\n        });\r\n        this.downloadStream = pipeline(response.data, this.writeStream, (err) => {\r\n          if (err) {\r\n            reject(err);\r\n          } else {\r\n            resolve(true);\r\n          }\r\n        });\r\n      } catch (error: any) {\r\n        reject(error);\r\n      }\r\n    });\r\n  }\r\n\r\n  async onStart() {\r\n    const fileManager = getFileManager(this.instance.instanceUuid);\r\n    try {\r\n      if (this.targetLink) {\r\n        let result = await this.download();\r\n        if (this.extName === \".zip\")\r\n          result = await fileManager.unzip(this.TMP_ZIP_NAME, \".\", \"UTF-8\");\r\n        if (!result) throw new Error($t(\"TXT_CODE_quick_install.unzipError\"));\r\n      }\r\n\r\n      let config: Partial<InstanceConfig>;\r\n      if (this.buildParams?.startCommand || !fs.existsSync(this.ZIP_CONFIG_JSON)) {\r\n        config = this.buildParams || {};\r\n      } else {\r\n        config = JSON.parse(await fileManager.readFile(this.ZIP_CONFIG_JSON));\r\n      }\r\n\r\n      logger.info(\r\n        t(\"TXT_CODE_e5ba712d\"),\r\n        this.instance.config.nickname,\r\n        this.instance.instanceUuid,\r\n        \"URL:\",\r\n        this.targetLink\r\n      );\r\n      logger.info(t(\"TXT_CODE_ac225d07\") + JSON.stringify(config));\r\n\r\n      this.instance.parameters(config);\r\n\r\n      // Render startCommand with ENV\r\n      if (this.instance.config.startCommand) {\r\n        let startCommand = this.instance.config.startCommand;\r\n        const ENV_MAP: IJsonData = {\r\n          java: \"java\",\r\n          cwd: this.instance.config.cwd,\r\n          rconIp: this.instance.config.rconIp || \"localhost\",\r\n          rconPort: String(this.instance.config.rconPort),\r\n          rconPassword: this.instance.config.rconPassword,\r\n          nickname: this.instance.config.nickname,\r\n          instanceUuid: this.instance.instanceUuid\r\n        };\r\n        for (const key in ENV_MAP) {\r\n          const varDefine = `{{${key}}}`;\r\n          while (startCommand.includes(varDefine))\r\n            startCommand = startCommand?.replace(varDefine, ENV_MAP[key] || \"\");\r\n        }\r\n        this.instance.parameters({\r\n          startCommand\r\n        });\r\n      }\r\n\r\n      if (this.instance?.config?.updateCommand) {\r\n        try {\r\n          this.updateTask = new InstanceUpdateAction(this.instance);\r\n          await this.updateTask.start();\r\n          await this.updateTask.wait();\r\n        } catch (error) {}\r\n      }\r\n\r\n      this.stop();\r\n    } catch (error: any) {\r\n      this.error(error);\r\n    } finally {\r\n      if (fs.existsSync(fileManager.toAbsolutePath(this.TMP_ZIP_NAME)))\r\n        fs.remove(fileManager.toAbsolutePath(this.TMP_ZIP_NAME), () => {});\r\n    }\r\n  }\r\n\r\n  async onStop() {\r\n    try {\r\n      this.writeStream?.destroy();\r\n      this.writeStream = undefined;\r\n      this.downloadStream?.destroy();\r\n      this.downloadStream = undefined;\r\n    } catch (error) {\r\n      logger.error(\"QuickInstallTask -> onStop(): destroy download stream error:\", error);\r\n    }\r\n\r\n    try {\r\n      await this.updateTask?.stop();\r\n      this.updateTask = undefined;\r\n    } catch (error: any) {\r\n      logger.error(\"QuickInstallTask -> onStop(): updateTask stop error:\", error);\r\n    }\r\n  }\r\n\r\n  toObject(): IAsyncTaskJSON {\r\n    return JSON.parse(\r\n      JSON.stringify({\r\n        taskId: this.taskId,\r\n        status: this.status(),\r\n        instanceUuid: this.instance.instanceUuid,\r\n        instanceStatus: this.instance.status(),\r\n        instanceConfig: this.instance.config\r\n      })\r\n    );\r\n  }\r\n\r\n  async onError() {}\r\n}\r\n\r\nexport function createQuickInstallTask(\r\n  targetLink?: string,\r\n  instanceName?: string,\r\n  buildParams?: any\r\n) {\r\n  if (!instanceName) throw new Error(\"Instance name is empty!\");\r\n  const task = new QuickInstallTask(instanceName, targetLink, buildParams);\r\n  TaskCenter.addTask(task);\r\n  return task;\r\n}\r\n","import { GOLANG_ZIP_PATH } from \"../const\";\r\nimport fs from \"fs-extra\";\r\nimport { t } from \"i18next\";\r\n\r\nexport function checkDependencies() {\r\n  const dependencies = [GOLANG_ZIP_PATH];\r\n  dependencies.forEach((path) => {\r\n    if (!fs.existsSync(path)) {\r\n      throw new Error(t(\"TXT_CODE_6915f2a\") + path);\r\n    }\r\n  });\r\n}\r\n","import { t } from \"i18next\";\r\nimport { commandStringToArray } from \"../entity/commands/base/command_parser\";\r\nimport DockerPullCommand from \"../entity/commands/docker/docker_pull\";\r\nimport Instance from \"../entity/instance/instance\";\r\n\r\nimport path from \"path\";\r\nimport { $t } from \"../i18n\";\r\nimport logger from \"./log\";\r\nimport Docker from \"dockerode\";\r\nimport { EventEmitter } from \"stream\";\r\nimport { IInstanceProcess } from \"../entity/instance/interface\";\r\nimport { AsyncTask } from \"./async_task_service\";\r\nimport iconv from \"iconv-lite\";\r\n\r\n// Error exception at startup\r\nexport class StartupDockerProcessError extends Error {\r\n  constructor(msg: string) {\r\n    super(msg);\r\n  }\r\n}\r\n\r\nexport interface IDockerProcessAdapterStartParam {\r\n  isTty: boolean;\r\n  h: number;\r\n  w: number;\r\n}\r\n\r\nexport class SetupDockerContainer extends AsyncTask {\r\n  private container?: Docker.Container;\r\n\r\n  constructor(public readonly instance: Instance, public readonly startCommand?: string) {\r\n    super();\r\n  }\r\n\r\n  public async onStart() {\r\n    const instance = this.instance;\r\n    const customCommand = this.startCommand;\r\n    // Docker Image check\r\n    try {\r\n      await instance.forceExec(new DockerPullCommand());\r\n    } catch (error: any) {\r\n      throw error;\r\n    }\r\n\r\n    // Command text parsing\r\n    let commandList: string[] = [];\r\n    if (instance.config?.startCommand?.trim() || customCommand?.trim()) {\r\n      commandList = commandStringToArray(customCommand ?? instance.config.startCommand);\r\n    } else {\r\n      commandList = [];\r\n    }\r\n\r\n    const cwd = instance.absoluteCwdPath();\r\n\r\n    // Parsing port open\r\n    // 25565:25565/tcp 8080:8080/tcp\r\n    const portMap = instance.config.docker.ports || [];\r\n    const publicPortArray: any = {};\r\n    const exposedPorts: any = {};\r\n    for (const iterator of portMap) {\r\n      const elem = iterator.split(\"/\");\r\n      if (elem.length != 2) throw new Error($t(\"TXT_CODE_1cf6fc4b\"));\r\n      const ports = elem[0];\r\n      const protocol = elem[1];\r\n      //Host (host) port: container port\r\n      const publicAndPrivatePort = ports.split(\":\");\r\n      if (publicAndPrivatePort.length != 2) throw new Error(t(\"TXT_CODE_2029027e\"));\r\n      publicPortArray[`${publicAndPrivatePort[1]}/${protocol}`] = [\r\n        { HostPort: publicAndPrivatePort[0] }\r\n      ];\r\n      exposedPorts[`${publicAndPrivatePort[1]}/${protocol}`] = {};\r\n    }\r\n\r\n    // resolve extra path mounts\r\n    const extraVolumes = instance.config.docker.extraVolumes || [];\r\n    const extraBinds: { hostPath: string; containerPath: string }[] = [];\r\n    for (const item of extraVolumes) {\r\n      if (!item) throw new Error($t(\"TXT_CODE_ae441ea3\"));\r\n      const paths = item.split(\"|\");\r\n      if (paths.length < 2) throw new Error($t(\"TXT_CODE_dca030b8\"));\r\n      const hostPath = path.normalize(paths[0]);\r\n      const containerPath = path.normalize(paths[1]);\r\n      extraBinds.push({ hostPath, containerPath });\r\n    }\r\n\r\n    // memory limit\r\n    let maxMemory = undefined;\r\n    if (instance.config.docker.memory) maxMemory = instance.config.docker.memory * 1024 * 1024;\r\n\r\n    // CPU usage calculation\r\n    let cpuQuota = undefined;\r\n    let cpuPeriod = undefined;\r\n    if (instance.config.docker.cpuUsage) {\r\n      cpuQuota = instance.config.docker.cpuUsage * 10 * 1000;\r\n      cpuPeriod = 1000 * 1000;\r\n    }\r\n\r\n    // Check the number of CPU cores\r\n    let cpusetCpus = undefined;\r\n    if (instance.config.docker.cpusetCpus) {\r\n      const arr = instance.config.docker.cpusetCpus.split(\",\");\r\n      arr.forEach((v) => {\r\n        if (isNaN(Number(v))) throw new Error($t(\"TXT_CODE_instance.invalidCpu\", { v }));\r\n      });\r\n      cpusetCpus = instance.config.docker.cpusetCpus;\r\n      // Note: check\r\n    }\r\n\r\n    // container name check\r\n    let containerName =\r\n      instance.config.docker.containerName || `MCSM-${instance.instanceUuid.slice(0, 6)}`;\r\n    if (containerName && (containerName.length > 64 || containerName.length < 2)) {\r\n      throw new Error($t(\"TXT_CODE_instance.invalidContainerName\", { v: containerName }));\r\n    }\r\n\r\n    // Whether to use TTY mode\r\n    const isTty = instance.config.terminalOption.pty;\r\n    const workingDir = instance.config.docker.workingDir ?? \"/workspace/\";\r\n\r\n    // output startup log\r\n    logger.info(\"----------------\");\r\n    logger.info(`[SetupDockerContainer]`);\r\n    logger.info(`UUID: [${instance.instanceUuid}] [${instance.config.nickname}]`);\r\n    logger.info(`NAME: [${containerName}]`);\r\n    logger.info(`COMMAND: ${commandList.join(\" \")}`);\r\n    logger.info(`CWD: ${cwd}, WORKING_DIR: ${workingDir}`);\r\n    logger.info(`NET_MODE: ${instance.config.docker.networkMode}`);\r\n    logger.info(`OPEN_PORT: ${JSON.stringify(publicPortArray)}`);\r\n    logger.info(`BINDS: ${JSON.stringify([`${cwd}->${workingDir}`, ...extraBinds])}`);\r\n    logger.info(`NET_ALIASES: ${JSON.stringify(instance.config.docker.networkAliases)}`);\r\n    logger.info(`MEM_LIMIT: ${maxMemory || \"--\"} MB`);\r\n    logger.info(`TYPE: Docker Container`);\r\n    logger.info(\"----------------\");\r\n\r\n    // Start Docker container creation and running\r\n    const docker = new Docker();\r\n    this.container = await docker.createContainer({\r\n      name: containerName,\r\n      Hostname: containerName,\r\n      Image: instance.config.docker.image,\r\n      AttachStdin: true,\r\n      AttachStdout: true,\r\n      AttachStderr: true,\r\n      Tty: isTty,\r\n      WorkingDir: workingDir,\r\n      Cmd: commandList ? commandList : undefined,\r\n      OpenStdin: true,\r\n      StdinOnce: false,\r\n      ExposedPorts: exposedPorts,\r\n      Env: instance.config.docker?.env || [],\r\n      HostConfig: {\r\n        Memory: maxMemory,\r\n        AutoRemove: true,\r\n        CpusetCpus: cpusetCpus,\r\n        CpuPeriod: cpuPeriod,\r\n        CpuQuota: cpuQuota,\r\n        PortBindings: publicPortArray,\r\n        NetworkMode: instance.config.docker.networkMode,\r\n        Mounts: [\r\n          {\r\n            Type: \"bind\",\r\n            Source: cwd,\r\n            Target: workingDir\r\n          },\r\n          ...extraBinds.map((v) => {\r\n            return {\r\n              Type: \"bind\" as Docker.MountType,\r\n              Source: v.hostPath,\r\n              Target: v.containerPath\r\n            };\r\n          })\r\n        ]\r\n      },\r\n      NetworkingConfig: {\r\n        EndpointsConfig: {\r\n          [instance.config.docker.networkMode || \"bridge\"]: {\r\n            Aliases: instance.config.docker.networkAliases\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    await this.container.start();\r\n\r\n    // Listen to events\r\n    this.container.wait(async (v) => {\r\n      this.stop();\r\n    });\r\n  }\r\n  public async onStop() {\r\n    try {\r\n      await this.container?.kill();\r\n    } catch (error) {}\r\n    try {\r\n      await this.container?.remove();\r\n    } catch (error) {}\r\n  }\r\n\r\n  public getContainer() {\r\n    if (!this.container) throw new Error(\"Function getContainer(): Failed, Container is Null!\");\r\n    return this.container;\r\n  }\r\n\r\n  public async attach(instance: Instance) {\r\n    const outputCode = instance.config.terminalOption.pty ? \"utf-8\" : instance.config.oe;\r\n    const container = this.container;\r\n    if (!container) throw new Error(\"Attach Failed, Container is Null!\");\r\n    try {\r\n      const stream = await container.attach({\r\n        stream: true,\r\n        stdout: true,\r\n        stderr: true,\r\n        stdin: true\r\n      });\r\n      stream.on(\"data\", (text: any) => instance.print(iconv.decode(text, outputCode)));\r\n      stream.on(\"error\", (text: any) => instance.print(iconv.decode(text, outputCode)));\r\n    } catch (error: any) {\r\n      this.error(error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  public async onError(err: Error) {}\r\n\r\n  public toObject() {}\r\n}\r\n\r\n// SubProcess adapter for Instance\r\nexport class DockerProcessAdapter extends EventEmitter implements IInstanceProcess {\r\n  pid?: number | string;\r\n\r\n  private stream?: NodeJS.ReadWriteStream;\r\n  public container?: Docker.Container;\r\n\r\n  constructor(public readonly containerWrapper: SetupDockerContainer) {\r\n    super();\r\n  }\r\n\r\n  // Once the program is actually started, no errors can block the next startup process\r\n  public async start(param: IDockerProcessAdapterStartParam) {\r\n    try {\r\n      await this.containerWrapper.start();\r\n      this.container = this.containerWrapper.getContainer();\r\n\r\n      const { isTty, h, w } = param;\r\n      if (isTty) {\r\n        this.container.resize({ h, w });\r\n      }\r\n\r\n      this.pid = this.container.id;\r\n      this.stream = await this.container.attach({\r\n        stream: true,\r\n        stdout: true,\r\n        stderr: true,\r\n        stdin: true\r\n      });\r\n      this.stream.on(\"data\", (data) => this.emit(\"data\", data));\r\n      this.stream.on(\"error\", (data) => this.emit(\"data\", data));\r\n      this.wait();\r\n    } catch (error: any) {\r\n      this.kill();\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  public write(data?: string) {\r\n    if (this.stream && data) this.stream.write(data);\r\n  }\r\n\r\n  public async kill(s?: string) {\r\n    await this.container?.kill();\r\n    return true;\r\n  }\r\n\r\n  public async destroy() {\r\n    try {\r\n      await this.container?.remove();\r\n    } catch (error: any) {}\r\n  }\r\n\r\n  private wait() {\r\n    this.container?.wait(async (v) => {\r\n      await this.destroy();\r\n      this.emit(\"exit\", v);\r\n    });\r\n  }\r\n}\r\n","import Docker from \"dockerode\";\r\n\r\nexport class DockerManager {\r\n  // 1=creating 2=creating completed -1=creating error\r\n  public static readonly builderProgress = new Map<string, number>();\r\n\r\n  public docker: Docker;\r\n\r\n  constructor(p?: any) {\r\n    this.docker = new Docker(p);\r\n  }\r\n\r\n  public getDocker() {\r\n    return this.docker;\r\n  }\r\n\r\n  public static setBuilderProgress(imageName: string, status: number) {\r\n    DockerManager.builderProgress.set(imageName, status);\r\n  }\r\n\r\n  public static getBuilderProgress(imageName: string) {\r\n    return DockerManager.builderProgress.get(imageName);\r\n  }\r\n\r\n  async startBuildImage(dockerFileDir: string, dockerImageName: string) {\r\n    try {\r\n      // Set the current image creation progress\r\n      DockerManager.setBuilderProgress(dockerImageName, 1);\r\n      // Issue the create image command\r\n      const stream = await this.docker.buildImage(\r\n        {\r\n          context: dockerFileDir,\r\n          src: [\"Dockerfile\"]\r\n        },\r\n        { t: dockerImageName }\r\n      );\r\n      // wait for creation to complete\r\n      await new Promise((resolve, reject) => {\r\n        this.docker.modem.followProgress(stream, (err, res) => (err ? reject(err) : resolve(res)));\r\n      });\r\n      // Set the current image creation progress\r\n      DockerManager.setBuilderProgress(dockerImageName, 2);\r\n    } catch (error: any) {\r\n      // Set the current image creation progress\r\n      DockerManager.setBuilderProgress(dockerImageName, -1);\r\n    }\r\n  }\r\n}\r\n","import path from \"path\";\r\nimport fs from \"fs-extra\";\r\nimport axios from \"axios\";\r\nimport { pipeline, Readable } from \"stream\";\r\nimport logger from \"./log\";\r\n\r\nexport function downloadFileToLocalFile(url: string, localFilePath: string): Promise<boolean> {\r\n  logger.info(`Download File: ${url} --> ${path.normalize(localFilePath)}`);\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      if (fs.existsSync(localFilePath)) fs.removeSync(localFilePath);\r\n      const response = await axios<Readable>({\r\n        url,\r\n        responseType: \"stream\",\r\n        timeout: 1000 * 10\r\n      });\r\n      const writeStream = fs.createWriteStream(path.normalize(localFilePath));\r\n      pipeline(response.data, writeStream, (err) => {\r\n        if (err) {\r\n          fs.remove(localFilePath, () => {});\r\n          reject(err);\r\n        } else {\r\n          fs.chmodSync(localFilePath, 0o777);\r\n          resolve(true);\r\n        }\r\n      });\r\n    } catch (error: any) {\r\n      reject(error.message);\r\n    }\r\n  });\r\n}\r\n","import { $t } from \"../i18n\";\r\nimport InstanceSubsystem from \"../service/system_instance\";\r\nimport FileManager from \"./system_file\";\r\n\r\nexport function getFileManager(instanceUuid: string) {\r\n  // Initialize a file manager for the instance, and assign codes, restrictions, etc.\r\n  const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n  if (!instance)\r\n    throw new Error($t(\"TXT_CODE_file_router_service.instanceNotExit\", { uuid: instanceUuid }));\r\n  const fileCode = instance.config?.fileCode;\r\n  const cwd = instance.config.cwd;\r\n  return new FileManager(cwd, fileCode);\r\n}\r\n","import Koa from \"koa\";\r\nimport koaBody from \"koa-body-patch\";\r\nimport koaRouter from \"../routers/http_router\";\r\nimport logger from \"./log\";\r\nimport { globalConfiguration } from \"../entity/config\";\r\nimport { removeTrail } from \"common\";\r\n\r\nexport function initKoa() {\r\n  const koaApp = new Koa();\r\n  const config = globalConfiguration.config;\r\n  koaApp.use(\r\n    koaBody({\r\n      multipart: true,\r\n      formidable: {\r\n        maxFieldsSize: Number.MAX_SAFE_INTEGER,\r\n        maxFileSize: Number.MAX_SAFE_INTEGER,\r\n        maxFiles: 1\r\n      },\r\n      onError(err, ctx) {\r\n        logger.error(\"koaBody Lib Error:\", err);\r\n      }\r\n    })\r\n  );\r\n  // Load Koa top-level middleware\r\n  koaApp.use(async (ctx, next) => {\r\n    await next();\r\n    // Because all HTTP requests can only be used by creating a task passport on the panel side, cross-domain requests are allowed, and security can also be guaranteed\r\n    ctx.response.set(\"Access-Control-Allow-Origin\", \"*\");\r\n    ctx.response.set(\"Access-Control-Allow-Methods\", \"POST, GET, PUT, DELETE, OPTIONS\");\r\n    ctx.response.set(\r\n      \"Access-Control-Allow-Headers\",\r\n      \"Content-Type, Cookie, Accept-Encoding, User-Agent, Host, Referer, \" +\r\n        \"X-Requested-With, Accept, Accept-Language, Cache-Control, Connection\"\r\n    );\r\n    ctx.response.set(\"X-Power-by\", \"MCSManager\");\r\n  });\r\n\r\n  if (config.prefix != \"\") {\r\n    const prefix = config.prefix;\r\n    koaApp.use(async (ctx, next) => {\r\n      if (ctx.url.startsWith(prefix)) {\r\n        const orig = ctx.url;\r\n        ctx.url = ctx.url.slice(prefix.length);\r\n        if (!ctx.url.startsWith(\"/\")) {\r\n          ctx.url = \"/\" + ctx.url;\r\n        }\r\n        await next();\r\n        ctx.url = orig;\r\n      } else {\r\n        ctx.redirect(removeTrail(prefix, \"/\") + ctx.url);\r\n      }\r\n    });\r\n  }\r\n  koaApp.use(koaRouter.routes()).use(koaRouter.allowedMethods());\r\n  return koaApp;\r\n}\r\n","import { $t } from \"../i18n\";\r\nimport { killProcess } from \"common\";\r\nimport { ChildProcessWithoutNullStreams, spawn } from \"child_process\";\r\nimport logger from \"../service/log\";\r\nimport Instance from \"../entity/instance/instance\";\r\nimport { commandStringToArray } from \"../entity/commands/base/command_parser\";\r\nimport iconv from \"iconv-lite\";\r\nimport { AsyncTask, IAsyncTaskJSON } from \"../service/async_task_service\";\r\nimport { SetupDockerContainer } from \"./docker_process_service\";\r\n\r\nexport class InstanceUpdateAction extends AsyncTask {\r\n  public pid?: number;\r\n\r\n  private process?: ChildProcessWithoutNullStreams;\r\n  private containerWrapper?: SetupDockerContainer;\r\n\r\n  constructor(public readonly instance: Instance) {\r\n    super();\r\n  }\r\n\r\n  public async onStart() {\r\n    let updateCommand = this.instance.config.updateCommand;\r\n    updateCommand = updateCommand.replace(/\\{mcsm_workspace\\}/gm, this.instance.config.cwd);\r\n    logger.info(\r\n      $t(\"TXT_CODE_general_update.readyUpdate\", { instanceUuid: this.instance.instanceUuid })\r\n    );\r\n    logger.info(\r\n      $t(\"TXT_CODE_general_update.updateCmd\", { instanceUuid: this.instance.instanceUuid })\r\n    );\r\n    logger.info(updateCommand);\r\n\r\n    this.instance.println(\r\n      $t(\"TXT_CODE_general_update.update\"),\r\n      $t(\"TXT_CODE_general_update.readyUpdate\", { instanceUuid: this.instance.instanceUuid })\r\n    );\r\n\r\n    // Docker Update Command Mode\r\n    if (this.instance.config.processType === \"docker\" && this.instance.config.docker?.image) {\r\n      this.containerWrapper = new SetupDockerContainer(\r\n        this.instance,\r\n        this.instance.config.updateCommand\r\n      );\r\n      await this.containerWrapper.start();\r\n      await this.containerWrapper.attach(this.instance);\r\n      await this.containerWrapper.wait();\r\n      this.stop();\r\n      return;\r\n    }\r\n\r\n    // command parsing\r\n    const commandList = commandStringToArray(updateCommand);\r\n    const commandExeFile = commandList[0];\r\n    const commandParameters = commandList.slice(1);\r\n    if (commandList.length === 0) {\r\n      return this.instance.failure(new Error($t(\"TXT_CODE_general_update.cmdFormatErr\")));\r\n    }\r\n\r\n    // start the update command\r\n    const process = spawn(commandExeFile, commandParameters, {\r\n      cwd: this.instance.config.cwd,\r\n      stdio: \"pipe\",\r\n      windowsHide: true\r\n    });\r\n    if (!process || !process.pid) {\r\n      return this.instance.println(\r\n        $t(\"TXT_CODE_general_update.err\"),\r\n        $t(\"TXT_CODE_general_update.updateFailed\")\r\n      );\r\n    }\r\n\r\n    // process & pid\r\n    this.pid = process.pid;\r\n    this.process = process;\r\n\r\n    process.stdout.on(\"data\", (text) => {\r\n      this.instance.print(iconv.decode(text, this.instance.config.oe));\r\n    });\r\n    process.stderr.on(\"data\", (text) => {\r\n      this.instance.print(iconv.decode(text, this.instance.config.oe));\r\n    });\r\n\r\n    process.on(\"exit\", (code) => {\r\n      if (code === 0) {\r\n        this.stop();\r\n      } else {\r\n        this.error(new Error($t(\"TXT_CODE_general_update.updateErr\")));\r\n      }\r\n    });\r\n  }\r\n\r\n  public async onStop() {\r\n    if (this.containerWrapper) {\r\n      await this.containerWrapper.stop();\r\n    }\r\n    if (this.pid && this.process) {\r\n      killProcess(this.pid, this.process);\r\n    }\r\n  }\r\n\r\n  public async onError(err: Error) {}\r\n  public toObject(): IAsyncTaskJSON {\r\n    throw new Error(\"Method not implemented.\");\r\n  }\r\n}\r\n","import fs from \"fs-extra\";\r\nimport * as log4js from \"log4js\";\r\nimport { systemInfo } from \"common\";\r\nimport { $t } from \"../i18n\";\r\n\r\nconst LOG_FILE_PATH = \"logs/current.log\";\r\nconst LOG_SYS_INFO_FILE_PATH = \"logs/sysinfo.log\";\r\n\r\nconst time = new Date();\r\nconst timeString =\r\n  `${time.getFullYear()}-${time.getMonth() + 1}-${time.getDate()}` +\r\n  `_${time.getHours()}-${time.getMinutes()}-${time.getSeconds()}`;\r\n\r\nif (fs.existsSync(LOG_FILE_PATH)) {\r\n  fs.renameSync(LOG_FILE_PATH, `logs/${timeString}.log`);\r\n}\r\n\r\nif (fs.existsSync(LOG_SYS_INFO_FILE_PATH)) {\r\n  fs.renameSync(LOG_SYS_INFO_FILE_PATH, `logs/sysinfo_${timeString}.log`);\r\n}\r\n\r\nlog4js.configure({\r\n  appenders: {\r\n    out: {\r\n      type: \"stdout\",\r\n      layout: {\r\n        type: \"pattern\",\r\n        pattern: \"[%d{MM/dd hh:mm:ss}] [%[%p%]] %m\"\r\n      }\r\n    },\r\n    app: {\r\n      type: \"file\",\r\n      filename: LOG_FILE_PATH,\r\n      layout: {\r\n        type: \"pattern\",\r\n        pattern: \"[%d{MM/dd hh:mm:ss}] [%p] %m\"\r\n      }\r\n    },\r\n    sys: {\r\n      type: \"file\",\r\n      filename: LOG_SYS_INFO_FILE_PATH,\r\n      layout: {\r\n        type: \"pattern\",\r\n        pattern: \"[%d{MM/dd hh:mm:ss}] [%p] %m\"\r\n      }\r\n    }\r\n  },\r\n  categories: {\r\n    default: {\r\n      appenders: [\"out\", \"app\"],\r\n      level: \"info\"\r\n    },\r\n    sysinfo: {\r\n      appenders: [\"sys\"],\r\n      level: \"info\"\r\n    }\r\n  }\r\n});\r\n\r\nconst logger = log4js.getLogger(\"default\");\r\nconst loggerSysInfo = log4js.getLogger(\"sysinfo\");\r\nfunction toInt(v: number) {\r\n  return parseInt(String(v));\r\n}\r\n\r\nfunction systemInfoReport() {\r\n  const MB_SIZE = 1024 * 1024;\r\n  const info = systemInfo();\r\n\r\n  const self = process.memoryUsage();\r\n  const sysInfo =\r\n    `MEM: ${toInt((info.totalmem - info.freemem) / MB_SIZE)}MB/${toInt(\r\n      info.totalmem / MB_SIZE\r\n    )}MB` + ` CPU: ${toInt(info.cpuUsage * 100)}%`;\r\n  const selfInfo = `Heap: ${toInt(self.heapUsed / MB_SIZE)}MB/${toInt(self.heapTotal / MB_SIZE)}MB`;\r\n  const selfInfo2 = `RSS: ${toInt(self.rss / MB_SIZE)}MB`;\r\n  const logTip = $t(\"TXT_CODE_app.sysinfo\");\r\n  loggerSysInfo.info([`[${logTip}]`, sysInfo, selfInfo, selfInfo2].join(\" \"));\r\n}\r\n\r\nsetInterval(systemInfoReport, 1000 * 5);\r\n\r\nexport default logger;\r\n","import RouterContext from \"../entity/ctx\";\r\n\r\n// task interface\r\ninterface IMission {\r\n  name: string;\r\n  parameter: any;\r\n  start: number;\r\n  end: number;\r\n  count?: number;\r\n}\r\n\r\n// Task passport manager\r\nclass MissionPassport {\r\n  // temporary task passport list\r\n  public readonly missions = new Map<string, IMission>();\r\n\r\n  constructor() {\r\n    // Set up to check the task expiration every hour\r\n    setInterval(() => {\r\n      const t = new Date().getTime();\r\n      this.missions.forEach((m, k) => {\r\n        if (t > m.end) this.missions.delete(k);\r\n      });\r\n    }, 1000);\r\n  }\r\n\r\n  // register task passport\r\n  public registerMission(password: string, mission: IMission) {\r\n    if (this.missions.has(password))\r\n      throw new Error(\"Duplicate primary key, failed to create task\");\r\n    this.missions.set(password, mission);\r\n  }\r\n\r\n  // Get the task based on the passport and task name\r\n  public getMission(password: string, missionName: string) {\r\n    if (!this.missions.has(password)) return null;\r\n    const m = this.missions.get(password);\r\n    if (m?.name === missionName) return m;\r\n    return null;\r\n  }\r\n\r\n  public deleteMission(password: string) {\r\n    this.missions.delete(password);\r\n  }\r\n}\r\n\r\nconst LOGIN_BY_TOP_LEVEL = \"TOP_LEVEL\";\r\nconst LOGIN_FROM_STREAM = \"STREAM\";\r\n\r\n// This function must be executed after successful login\r\nfunction loginSuccessful(ctx: RouterContext, key: string) {\r\n  ctx.session.key = key;\r\n  ctx.session.login = true;\r\n  ctx.session.id = ctx.socket.id;\r\n  ctx.session.type = LOGIN_BY_TOP_LEVEL;\r\n  ctx.session.stream = {};\r\n  return ctx.session;\r\n}\r\n\r\nfunction streamLoginSuccessful(ctx: RouterContext, instanceUuid: string) {\r\n  ctx.session.id = ctx.socket.id;\r\n  ctx.session.login = true;\r\n  ctx.session.type = LOGIN_FROM_STREAM;\r\n  ctx.session.stream = {\r\n    check: true,\r\n    instanceUuid\r\n  };\r\n  return ctx.session;\r\n}\r\n\r\nconst missionPassport = new MissionPassport();\r\n\r\nexport {\r\n  missionPassport,\r\n  IMission,\r\n  LOGIN_BY_TOP_LEVEL,\r\n  LOGIN_FROM_STREAM,\r\n  loginSuccessful,\r\n  streamLoginSuccessful\r\n};\r\n","import { $t } from \"../i18n\";\r\nimport { Socket } from \"socket.io\";\r\nimport RouterContext from \"../entity/ctx\";\r\nimport logger from \"./log\";\r\nimport { IGNORE } from \"../const\";\r\n\r\n// Define network protocols and common send/broadcast/parse functions, the client should also have this file\r\n\r\nconst STATUS_OK = 200;\r\nconst STATUS_ERR = 500;\r\n\r\n// packet format definition\r\nexport interface IPacket {\r\n  uuid: string | null;\r\n  status: number;\r\n  event: string | null;\r\n  data: any;\r\n}\r\n\r\nexport interface IResponseErrorConfig {\r\n  disablePrint: boolean;\r\n}\r\n\r\n// global socket storage\r\nconst globalSocket = new Map<String, Socket>();\r\n\r\nexport class Packet implements IPacket {\r\n  constructor(\r\n    public uuid: string | null = null,\r\n    public status = 200,\r\n    public event: string | null = null,\r\n    public data: any = null\r\n  ) {}\r\n}\r\n\r\nexport function response(ctx: RouterContext, data: any) {\r\n  if (ctx.event) {\r\n    const packet = new Packet(ctx.uuid, STATUS_OK, ctx.event, data);\r\n    ctx.socket.emit(ctx.event, packet);\r\n  }\r\n}\r\n\r\nexport function responseError(\r\n  ctx: RouterContext,\r\n  err: Error | string,\r\n  config?: IResponseErrorConfig\r\n) {\r\n  let errinfo: any = \"\";\r\n  if (err) errinfo = err.toString();\r\n  else errinfo = err;\r\n  const packet = new Packet(ctx.uuid, STATUS_ERR, ctx.event, errinfo);\r\n  // Ignore\r\n  if (String(err).includes(IGNORE) && ctx.event) return ctx.socket.emit(ctx.event, packet);\r\n  if (!config?.disablePrint)\r\n    logger.warn(\r\n      $t(\"TXT_CODE_protocol.socketErr\", {\r\n        id: ctx.socket.id,\r\n        address: ctx.socket.handshake.address,\r\n        event: ctx.event\r\n      }),\r\n      err\r\n    );\r\n  if (ctx.event) ctx.socket.emit(ctx.event, packet);\r\n}\r\n\r\nexport function msg(ctx: RouterContext, event: string, data: any) {\r\n  const packet = new Packet(ctx.uuid, STATUS_OK, event, data);\r\n  ctx.socket.emit(event, packet);\r\n}\r\n\r\nexport function error(ctx: RouterContext, event: string, err: any, config?: IResponseErrorConfig) {\r\n  const packet = new Packet(ctx.uuid, STATUS_ERR, event, err);\r\n  // Ignore\r\n  if (String(err).includes(IGNORE) && ctx.event) return ctx.socket.emit(ctx.event, packet);\r\n  if (!config?.disablePrint)\r\n    logger.warn(\r\n      $t(\"TXT_CODE_protocol.socketErr\", {\r\n        id: ctx.socket.id,\r\n        address: ctx.socket.handshake.address,\r\n        event: ctx.event\r\n      }),\r\n      err\r\n    );\r\n\r\n  ctx.socket.emit(event, packet);\r\n}\r\n\r\nexport function parse(text: IPacket) {\r\n  if (typeof text == \"object\") {\r\n    return new Packet(text.uuid || null, text.status, text.event, text.data);\r\n  }\r\n  const obj = JSON.parse(text);\r\n  return new Packet(null, obj.status, obj.event, obj.data);\r\n}\r\n\r\nexport function stringify(obj: any) {\r\n  return JSON.stringify(obj);\r\n}\r\n\r\nexport function addGlobalSocket(socket: Socket) {\r\n  globalSocket.set(socket.id, socket);\r\n}\r\n\r\nexport function delGlobalSocket(socket: Socket) {\r\n  globalSocket.delete(socket.id);\r\n}\r\n\r\nexport function socketObjects() {\r\n  return globalSocket;\r\n}\r\n\r\n// global socket broadcast\r\nexport function broadcast(event: string, obj: any) {\r\n  globalSocket.forEach((socket) => {\r\n    msg(new RouterContext(null, socket), event, obj);\r\n  });\r\n}\r\n","import { $t } from \"../i18n\";\r\nimport { EventEmitter } from \"events\";\r\nimport { Socket } from \"socket.io\";\r\nimport logger from \"./log\";\r\nimport RouterContext from \"../entity/ctx\";\r\nimport { IPacket, response, responseError } from \"../service/protocol\";\r\n// Routing controller class (singleton class)\r\nclass RouterApp extends EventEmitter {\r\n  public readonly middlewares: Array<Function>;\r\n\r\n  constructor() {\r\n    super();\r\n    this.middlewares = [];\r\n  }\r\n\r\n  emitRouter(event: string, ctx: RouterContext, data: any) {\r\n    try {\r\n      // service logic routing trigger point\r\n      super.emit(event, ctx, data);\r\n    } catch (error: any) {\r\n      responseError(ctx, error);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  on(event: string, fn: (ctx: RouterContext, data: any) => void) {\r\n    // logger.info(` Register event: ${event} `);\r\n    return super.on(event, fn);\r\n  }\r\n\r\n  use(fn: (event: string, ctx: RouterContext, data: any, next: Function) => void) {\r\n    this.middlewares.push(fn);\r\n  }\r\n\r\n  getMiddlewares() {\r\n    return this.middlewares;\r\n  }\r\n}\r\n\r\n// routing controller singleton class\r\nexport const routerApp = new RouterApp();\r\n\r\n/**\r\n * Based on Socket.io for routing decentralization and secondary forwarding\r\n * @param {Socket} socket\r\n */\r\nexport function navigation(socket: Socket) {\r\n  // Full-life session variables (Between connection and disconnection)\r\n  const session: any = {};\r\n  // Register all middleware with Socket\r\n  for (const fn of routerApp.getMiddlewares()) {\r\n    socket.use((packet, next) => {\r\n      const protocol = packet[1] as IPacket;\r\n      if (!protocol)\r\n        return logger.info(`session ${socket.id} request data protocol format is incorrect`);\r\n      const ctx = new RouterContext(protocol.uuid, socket, session);\r\n      fn(packet[0], ctx, protocol.data, next);\r\n    });\r\n  }\r\n  // Register all events with Socket\r\n  for (const event of routerApp.eventNames()) {\r\n    socket.on(event as string, (protocol: IPacket) => {\r\n      if (!protocol)\r\n        return logger.info(`session ${socket.id} request data protocol format is incorrect`);\r\n      const ctx = new RouterContext(protocol.uuid, socket, session, event.toString());\r\n      routerApp.emitRouter(event as string, ctx, protocol.data);\r\n    });\r\n  }\r\n  // The connected event route is triggered\r\n  const ctx = new RouterContext(null, socket, session);\r\n  routerApp.emitRouter(\"connection\", ctx, null);\r\n}\r\n\r\n// The authentication routing order must be the first load. These routing orders cannot be changed without authorization\r\nimport \"../routers/auth_router\";\r\nimport \"../routers/passport_router\";\r\nimport \"../routers/info_router\";\r\nimport \"../routers/Instance_router\";\r\nimport \"../routers/instance_event_router\";\r\nimport \"../routers/file_router\";\r\nimport \"../routers/stream_router\";\r\nimport \"../routers/environment_router\";\r\nimport \"../routers/schedule_router\";\r\n\r\nlogger.info($t(\"TXT_CODE_router.initComplete\"));\r\n","import { $t, i18next } from \"../i18n\";\r\nimport path from \"path\";\r\nimport fs from \"fs-extra\";\r\nimport { compress, decompress } from \"../common/compress\";\r\nimport iconv from \"iconv-lite\";\r\nimport { globalConfiguration } from \"../entity/config\";\r\nimport { ProcessWrapper } from \"common\";\r\nimport os from \"os\";\r\n\r\nconst ERROR_MSG_01 = $t(\"TXT_CODE_system_file.illegalAccess\");\r\nconst MAX_EDIT_SIZE = 1024 * 1024 * 5;\r\n\r\ninterface IFile {\r\n  name: string;\r\n  size: number;\r\n  time: string;\r\n  type: number;\r\n  mode: number;\r\n}\r\n\r\nexport default class FileManager {\r\n  public cwd: string = \".\";\r\n\r\n  constructor(public topPath: string = \"\", public fileCode?: string) {\r\n    if (!path.isAbsolute(topPath)) {\r\n      this.topPath = path.normalize(path.join(process.cwd(), topPath));\r\n    } else {\r\n      this.topPath = path.normalize(topPath);\r\n    }\r\n    if (!fileCode) {\r\n      this.fileCode = \"utf-8\";\r\n      if (i18next.language == \"zh_cn\") this.fileCode = \"gbk\";\r\n    }\r\n  }\r\n\r\n  isRootTopRath() {\r\n    return this.topPath === \"/\" || this.topPath === \"\\\\\";\r\n  }\r\n\r\n  toAbsolutePath(fileName: string = \"\") {\r\n    const topAbsolutePath = this.topPath;\r\n    let finalPath: string = \"\";\r\n    if (os.platform() === \"win32\") {\r\n      const reg = new RegExp(\"^[A-Za-z]{1}:[\\\\\\\\/]{1}\");\r\n      if (reg.test(this.cwd)) {\r\n        finalPath = path.normalize(path.join(this.cwd, fileName));\r\n      } else if (reg.test(fileName)) {\r\n        finalPath = path.normalize(fileName);\r\n      }\r\n    }\r\n    if (!finalPath) {\r\n      finalPath = path.normalize(path.join(this.topPath, this.cwd, fileName));\r\n    }\r\n    if (finalPath.indexOf(topAbsolutePath) !== 0) throw new Error(ERROR_MSG_01);\r\n    return finalPath;\r\n  }\r\n\r\n  checkPath(fileNameOrPath: string) {\r\n    if (this.isRootTopRath()) return true;\r\n    const destAbsolutePath = this.toAbsolutePath(fileNameOrPath);\r\n    const topAbsolutePath = this.topPath;\r\n    return destAbsolutePath.indexOf(topAbsolutePath) === 0;\r\n  }\r\n\r\n  check(destPath: string) {\r\n    if (this.isRootTopRath()) return true;\r\n    return this.checkPath(destPath) && fs.existsSync(this.toAbsolutePath(destPath));\r\n  }\r\n\r\n  cd(dirName: string) {\r\n    if (!this.check(dirName)) throw new Error(ERROR_MSG_01);\r\n    this.cwd = path.normalize(path.join(this.cwd, dirName));\r\n  }\r\n\r\n  list(page: 0, pageSize = 40, searchFileName?: string) {\r\n    if (pageSize > 100 || pageSize <= 0 || page < 0) throw new Error(\"Beyond the value limit\");\r\n    let fileNames = fs.readdirSync(this.toAbsolutePath());\r\n    if (searchFileName)\r\n      fileNames = fileNames.filter((name) =>\r\n        name.toLowerCase().includes(searchFileName.toLowerCase())\r\n      );\r\n\r\n    const total = fileNames.length;\r\n    const sliceStart = page * pageSize;\r\n    const sliceEnd = sliceStart + pageSize;\r\n    const files: IFile[] = [];\r\n    const dirs: IFile[] = [];\r\n    fileNames.forEach((name) => {\r\n      try {\r\n        const info = fs.statSync(this.toAbsolutePath(name));\r\n        const mode = parseInt(String(parseInt(info.mode?.toString(8), 10)).slice(-3));\r\n        const commonInfo = {\r\n          name: name,\r\n          size: info.size,\r\n          time: info.atime.toString(),\r\n          mode,\r\n          type: info.isFile() ? 1 : 0\r\n        };\r\n        if (info.isFile()) {\r\n          files.push(commonInfo);\r\n        } else {\r\n          dirs.push(commonInfo);\r\n        }\r\n      } catch (error: any) {\r\n        // Ignore a file information retrieval error to prevent an overall error\r\n      }\r\n    });\r\n    files.sort((a, b) => (a.name > b.name ? 1 : -1));\r\n    dirs.sort((a, b) => (a.name > b.name ? 1 : -1));\r\n    let resultList = dirs.concat(files);\r\n    resultList = resultList.slice(sliceStart, sliceEnd);\r\n    return {\r\n      items: resultList,\r\n      page,\r\n      pageSize,\r\n      total,\r\n      absolutePath: this.toAbsolutePath()\r\n    };\r\n  }\r\n\r\n  async chmod(fileName: string, chmodValue: number, deep: boolean) {\r\n    if (!this.check(fileName) || isNaN(parseInt(chmodValue as any))) throw new Error(ERROR_MSG_01);\r\n    const absPath = this.toAbsolutePath(fileName);\r\n    const defaultPath = \"/bin/chmod\";\r\n    let file = \"chmod\";\r\n    if (fs.existsSync(defaultPath)) file = defaultPath;\r\n    const params: string[] = [];\r\n    if (deep) params.push(\"-R\");\r\n    params.push(String(chmodValue));\r\n    params.push(absPath);\r\n    return await new ProcessWrapper(file, params, \".\", 60 * 10).start();\r\n  }\r\n\r\n  async readFile(fileName: string) {\r\n    if (!this.check(fileName)) throw new Error(ERROR_MSG_01);\r\n    const absPath = this.toAbsolutePath(fileName);\r\n    const buf = await fs.readFile(absPath);\r\n    const text = iconv.decode(buf, this.fileCode || \"utf-8\");\r\n    return text;\r\n  }\r\n\r\n  async writeFile(fileName: string, data: string) {\r\n    if (!this.check(fileName)) throw new Error(ERROR_MSG_01);\r\n    const absPath = this.toAbsolutePath(fileName);\r\n    const buf = iconv.encode(data, this.fileCode || \"utf-8\");\r\n    return await fs.writeFile(absPath, buf);\r\n  }\r\n\r\n  async newFile(fileName: string) {\r\n    // if (!FileManager.checkFileName(fileName)) throw new Error(ERROR_MSG_01);\r\n    if (!this.checkPath(fileName)) throw new Error(ERROR_MSG_01);\r\n    const target = this.toAbsolutePath(fileName);\r\n    fs.createFile(target);\r\n  }\r\n\r\n  async copy(target1: string, target2: string) {\r\n    if (!this.checkPath(target2) || !this.check(target1)) throw new Error(ERROR_MSG_01);\r\n    const targetPath = this.toAbsolutePath(target1);\r\n    target2 = this.toAbsolutePath(target2);\r\n    return await fs.copy(targetPath, target2);\r\n  }\r\n\r\n  mkdir(target: string) {\r\n    if (!this.checkPath(target)) throw new Error(ERROR_MSG_01);\r\n    const targetPath = this.toAbsolutePath(target);\r\n    return fs.mkdirSync(targetPath);\r\n  }\r\n\r\n  async delete(target: string): Promise<boolean> {\r\n    if (!this.check(target)) throw new Error(ERROR_MSG_01);\r\n    const targetPath = this.toAbsolutePath(target);\r\n    return new Promise((r, j) => {\r\n      fs.remove(targetPath, (err) => {\r\n        if (!err) r(true);\r\n        else j(err);\r\n      });\r\n    });\r\n  }\r\n\r\n  async move(target: string, destPath: string) {\r\n    if (!this.check(target)) throw new Error(ERROR_MSG_01);\r\n    if (!this.checkPath(destPath)) throw new Error(ERROR_MSG_01);\r\n    const targetPath = this.toAbsolutePath(target);\r\n    destPath = this.toAbsolutePath(destPath);\r\n    await fs.move(targetPath, destPath);\r\n  }\r\n\r\n  private zipFileCheck(path: string) {\r\n    const fileInfo = fs.statSync(path);\r\n    const MAX_ZIP_GB = globalConfiguration.config.maxZipFileSize;\r\n    if (fileInfo.size > 1024 * 1024 * 1024 * MAX_ZIP_GB)\r\n      throw new Error($t(\"TXT_CODE_system_file.unzipLimit\", { max: MAX_ZIP_GB }));\r\n  }\r\n\r\n  async unzip(sourceZip: string, destDir: string, code?: string) {\r\n    if (!code) code = this.fileCode;\r\n    if (!this.check(sourceZip) || !this.checkPath(destDir)) throw new Error(ERROR_MSG_01);\r\n    this.zipFileCheck(this.toAbsolutePath(sourceZip));\r\n    return await decompress(this.toAbsolutePath(sourceZip), this.toAbsolutePath(destDir), code);\r\n  }\r\n\r\n  async zip(sourceZip: string, files: string[], code?: string) {\r\n    if (!code) code = this.fileCode;\r\n    if (!this.checkPath(sourceZip)) throw new Error(ERROR_MSG_01);\r\n    const MAX_ZIP_GB = globalConfiguration.config.maxZipFileSize;\r\n    const MAX_TOTAL_FIELS_SIZE = 1024 * 1024 * 1024 * MAX_ZIP_GB;\r\n    const sourceZipPath = this.toAbsolutePath(sourceZip);\r\n    const filesPath = [];\r\n    let totalSize = 0;\r\n    for (const iterator of files) {\r\n      if (this.check(iterator)) {\r\n        filesPath.push(this.toAbsolutePath(iterator));\r\n        try {\r\n          totalSize += fs.statSync(this.toAbsolutePath(iterator))?.size;\r\n        } catch (error: any) {}\r\n      }\r\n    }\r\n    if (totalSize > MAX_TOTAL_FIELS_SIZE)\r\n      throw new Error($t(\"TXT_CODE_system_file.unzipLimit\", { max: MAX_ZIP_GB }));\r\n    return await compress(sourceZipPath, filesPath, code);\r\n  }\r\n\r\n  async edit(target: string, data?: string) {\r\n    if (!this.check(target)) throw new Error(ERROR_MSG_01);\r\n    if (data || typeof data === \"string\") {\r\n      return await this.writeFile(target, data);\r\n    } else {\r\n      const absPath = this.toAbsolutePath(target);\r\n      const info = fs.statSync(absPath);\r\n      if (info.size > MAX_EDIT_SIZE) {\r\n        throw new Error($t(\"TXT_CODE_system_file.execLimit\"));\r\n      }\r\n      return await this.readFile(target);\r\n    }\r\n  }\r\n\r\n  rename(target: string, newName: string) {\r\n    if (!this.check(target)) throw new Error(ERROR_MSG_01);\r\n    if (!this.checkPath(newName)) throw new Error(ERROR_MSG_01);\r\n    const targetPath = this.toAbsolutePath(target);\r\n    const newPath = this.toAbsolutePath(newName);\r\n    fs.renameSync(targetPath, newPath);\r\n  }\r\n\r\n  public static checkFileName(fileName?: string): boolean {\r\n    if (!fileName) return false;\r\n    const blackKeys = [\"/\", \"\\\\\", \"|\", \"?\", \"*\", \">\", \"<\", \";\", '\"'];\r\n    for (const ch of blackKeys) {\r\n      if (fileName.includes(ch)) return false;\r\n    }\r\n    return true;\r\n  }\r\n}\r\n","import { $t } from \"../i18n\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport os from \"os\";\r\nimport Instance from \"../entity/instance/instance\";\r\nimport EventEmitter from \"events\";\r\nimport KillCommand from \"../entity/commands/kill\";\r\nimport logger from \"./log\";\r\nimport { v4 } from \"uuid\";\r\nimport { Socket } from \"socket.io\";\r\nimport StorageSubsystem from \"../common/system_storage\";\r\nimport InstanceConfig from \"../entity/instance/Instance_config\";\r\nimport { QueryMapWrapper, InstanceStreamListener } from \"common\";\r\nimport FunctionDispatcher from \"../entity/commands/dispatcher\";\r\nimport InstanceControl from \"./system_instance_control\";\r\nimport StartCommand from \"../entity/commands/start\";\r\nimport { globalConfiguration } from \"../entity/config\";\r\n\r\n// init instance default install path\r\nlet INSTANCE_DATA_DIR = path.join(process.cwd(), \"data/InstanceData\");\r\nif (globalConfiguration.config.defaultInstancePath) {\r\n  INSTANCE_DATA_DIR = path.normalize(globalConfiguration.config.defaultInstancePath);\r\n}\r\n\r\nif (!fs.existsSync(INSTANCE_DATA_DIR)) {\r\n  fs.mkdirsSync(INSTANCE_DATA_DIR);\r\n}\r\n\r\nclass InstanceSubsystem extends EventEmitter {\r\n  public readonly GLOBAL_INSTANCE = \"__MCSM_GLOBAL_INSTANCE__\";\r\n  public readonly GLOBAL_INSTANCE_UUID = \"global0001\";\r\n\r\n  public readonly LOG_DIR = \"data/InstanceLog/\";\r\n\r\n  public readonly instances = new Map<string, Instance>();\r\n  public readonly instanceStream = new InstanceStreamListener();\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  // start automatically at boot\r\n  private autoStart() {\r\n    this.instances.forEach((instance) => {\r\n      if (instance.config.eventTask.autoStart) {\r\n        instance\r\n          .exec(new StartCommand())\r\n          .then(() => {\r\n            logger.info(\r\n              $t(\"TXT_CODE_system_instance.autoStart\", {\r\n                name: instance.config.nickname,\r\n                uuid: instance.instanceUuid\r\n              })\r\n            );\r\n          })\r\n          .catch((reason) => {\r\n            logger.error(\r\n              $t(\"TXT_CODE_system_instance.autoStartErr\", {\r\n                name: instance.config.nickname,\r\n                uuid: instance.instanceUuid,\r\n                reason: reason\r\n              })\r\n            );\r\n          });\r\n      }\r\n    });\r\n  }\r\n\r\n  // init all instances from local files\r\n  loadInstances() {\r\n    const instanceConfigs = StorageSubsystem.list(\"InstanceConfig\");\r\n    instanceConfigs.forEach((uuid) => {\r\n      if (uuid === this.GLOBAL_INSTANCE_UUID) return;\r\n      try {\r\n        const instanceConfig = StorageSubsystem.load(\"InstanceConfig\", InstanceConfig, uuid);\r\n        const instance = new Instance(uuid, instanceConfig);\r\n\r\n        // Fix BUG, reset state\r\n        instanceConfig.eventTask.ignore = false;\r\n\r\n        // All instances are all function schedulers\r\n        instance\r\n          .forceExec(new FunctionDispatcher())\r\n          .then((v) => {})\r\n          .catch((v) => {});\r\n        this.addInstance(instance);\r\n      } catch (error: any) {\r\n        logger.error(\r\n          $t(\"TXT_CODE_system_instance.readInstanceFailed\", { uuid: uuid, error: error.message })\r\n        );\r\n        logger.error($t(\"TXT_CODE_system_instance.checkConf\", { uuid: uuid }));\r\n      }\r\n    });\r\n\r\n    this.createInstance(\r\n      {\r\n        nickname: this.GLOBAL_INSTANCE,\r\n        cwd: \"/\",\r\n        startCommand: os.platform() === \"win32\" ? \"cmd.exe\" : \"bash\",\r\n        stopCommand: \"^c\",\r\n        ie: \"utf-8\",\r\n        oe: \"utf-8\",\r\n        type: Instance.TYPE_UNIVERSAL,\r\n        processType: \"general\"\r\n      },\r\n      false,\r\n      this.GLOBAL_INSTANCE_UUID\r\n    );\r\n\r\n    // handle autostart\r\n    this.autoStart();\r\n  }\r\n\r\n  createInstance(cfg: any, persistence = true, uuid?: string) {\r\n    const newUuid = uuid || v4().replace(/-/gim, \"\");\r\n    const instance = new Instance(newUuid, new InstanceConfig());\r\n    // Instance working directory verification and automatic creation\r\n    if (!cfg.cwd || cfg.cwd === \".\") {\r\n      cfg.cwd = path.normalize(`${INSTANCE_DATA_DIR}/${instance.instanceUuid}`);\r\n    }\r\n    if (!fs.existsSync(cfg.cwd)) fs.mkdirsSync(cfg.cwd);\r\n    // Set the default input and output encoding\r\n    cfg.ie = cfg.oe = cfg.fileCode = \"utf8\";\r\n    // Build and initialize the type from the parameters\r\n\r\n    instance.parameters(cfg, persistence);\r\n    instance.forceExec(new FunctionDispatcher());\r\n    this.addInstance(instance);\r\n    return instance;\r\n  }\r\n\r\n  addInstance(instance: Instance) {\r\n    if (instance.instanceUuid == null) throw new Error($t(\"TXT_CODE_system_instance.uuidEmpty\"));\r\n    if (this.instances.has(instance.instanceUuid)) {\r\n      throw new Error(`The application instance ${instance.instanceUuid} already exists.`);\r\n    }\r\n    this.instances.set(instance.instanceUuid, instance);\r\n    // Dynamically monitor the newly added instance output stream and pass it to its own event stream\r\n    instance.on(\"data\", (...arr) => {\r\n      this.emit(\"data\", instance.instanceUuid, ...arr);\r\n    });\r\n    instance.on(\"exit\", (...arr) => {\r\n      this.emit(\r\n        \"exit\",\r\n        {\r\n          instanceUuid: instance.instanceUuid,\r\n          instanceName: instance.config.nickname\r\n        },\r\n        ...arr\r\n      );\r\n    });\r\n    instance.on(\"open\", (...arr) => {\r\n      this.emit(\r\n        \"open\",\r\n        {\r\n          instanceUuid: instance.instanceUuid,\r\n          instanceName: instance.config.nickname\r\n        },\r\n        ...arr\r\n      );\r\n    });\r\n    instance.on(\"failure\", (...arr) => {\r\n      this.emit(\r\n        \"failure\",\r\n        {\r\n          instanceUuid: instance.instanceUuid,\r\n          instanceName: instance.config.nickname\r\n        },\r\n        ...arr\r\n      );\r\n    });\r\n  }\r\n\r\n  removeInstance(instanceUuid: string, deleteFile: boolean) {\r\n    const instance = this.getInstance(instanceUuid);\r\n    if (instance) {\r\n      if (instance.status() !== Instance.STATUS_STOP) throw new Error($t(\"TXT_CODE_fb547313\"));\r\n      instance.destroy();\r\n      this.instances.delete(instanceUuid);\r\n      StorageSubsystem.delete(\"InstanceConfig\", instanceUuid);\r\n      InstanceControl.deleteInstanceAllTask(instanceUuid);\r\n      if (deleteFile) fs.remove(instance.config.cwd, (err) => {});\r\n      return true;\r\n    }\r\n    throw new Error($t(\"TXT_CODE_3bfb9e04\"));\r\n  }\r\n\r\n  forward(targetInstanceUuid: string, socket: Socket) {\r\n    try {\r\n      this.instanceStream.requestForward(socket, targetInstanceUuid);\r\n    } catch (err) {}\r\n  }\r\n\r\n  stopForward(targetInstanceUuid: string, socket: Socket) {\r\n    try {\r\n      const instance = this.getInstance(targetInstanceUuid);\r\n      if (!instance) throw new Error($t(\"TXT_CODE_3bfb9e04\"));\r\n      instance.watchers.delete(socket.id);\r\n      this.instanceStream.cannelForward(socket, targetInstanceUuid);\r\n    } catch (err) {}\r\n  }\r\n\r\n  forEachForward(instanceUuid: string, callback: (socket: Socket) => void) {\r\n    this.instanceStream.forwardViaCallback(instanceUuid, (_socket: Socket) => {\r\n      callback(_socket);\r\n    });\r\n  }\r\n\r\n  getInstance(instanceUuid: string) {\r\n    return this.instances.get(instanceUuid);\r\n  }\r\n\r\n  getQueryMapWrapper() {\r\n    return new QueryMapWrapper(this.instances);\r\n  }\r\n\r\n  exists(instanceUuid: string) {\r\n    return this.instances.has(instanceUuid);\r\n  }\r\n\r\n  async exit() {\r\n    let promises = [];\r\n    for (const iterator of this.instances) {\r\n      const instance = iterator[1];\r\n      if (instance.status() != Instance.STATUS_STOP) {\r\n        logger.info(\r\n          `Instance ${instance.config.nickname} (${instance.instanceUuid}) is running or busy, and is being forced to end.`\r\n        );\r\n        promises.push(\r\n          instance.execCommand(new KillCommand()).then(() => {\r\n            if (!this.isGlobalInstance(instance))\r\n              StorageSubsystem.store(\"InstanceConfig\", instance.instanceUuid, instance.config);\r\n            logger.info(\r\n              `Instance ${instance.config.nickname} (${instance.instanceUuid}) saved successfully.`\r\n            );\r\n          })\r\n        );\r\n      }\r\n    }\r\n    await Promise.all(promises);\r\n  }\r\n\r\n  getInstances() {\r\n    let newArr = new Array<Instance>();\r\n    this.instances.forEach((instance) => {\r\n      if (!this.isGlobalInstance(instance)) newArr.push(instance);\r\n    });\r\n    newArr = newArr.sort((a, b) => (a.config.nickname > a.config.nickname ? 1 : -1));\r\n    return newArr;\r\n  }\r\n\r\n  isGlobalInstance(instance: Instance) {\r\n    return (\r\n      instance.instanceUuid === this.GLOBAL_INSTANCE_UUID ||\r\n      instance.config.nickname === this.GLOBAL_INSTANCE\r\n    );\r\n  }\r\n}\r\n\r\nexport default new InstanceSubsystem();\r\n","import { $t } from \"../i18n\";\r\nimport schedule from \"node-schedule\";\r\nimport InstanceSubsystem from \"./system_instance\";\r\nimport StorageSubsystem from \"../common/system_storage\";\r\nimport logger from \"./log\";\r\nimport StartCommand from \"../entity/commands/start\";\r\nimport StopCommand from \"../entity/commands/stop\";\r\nimport SendCommand from \"../entity/commands/cmd\";\r\nimport RestartCommand from \"../entity/commands/restart\";\r\nimport KillCommand from \"../entity/commands/kill\";\r\nimport FileManager from \"./system_file\";\r\n\r\n// Scheduled task configuration item interface\r\ninterface IScheduleTask {\r\n  instanceUuid: string;\r\n  name: string;\r\n  count: number;\r\n  time: string;\r\n  action: string;\r\n  payload: string;\r\n  type: number;\r\n}\r\n\r\n// Scheduled task timer/periodic task interface\r\ninterface IScheduleJob {\r\n  cancel: Function;\r\n}\r\n\r\n// @Entity\r\n// Schedule task configuration data entity class\r\nclass TaskConfig implements IScheduleTask {\r\n  instanceUuid = \"\";\r\n  name: string = \"\";\r\n  count: number = 1;\r\n  time: string = \"\";\r\n  action: string = \"\";\r\n  payload: string = \"\";\r\n  type: number = 1;\r\n}\r\n\r\nclass IntervalJob implements IScheduleJob {\r\n  public job: number = 0;\r\n\r\n  constructor(private callback: Function, public time: number) {\r\n    this.job = setInterval(callback, time * 1000);\r\n  }\r\n\r\n  cancel() {\r\n    clearInterval(this.job);\r\n  }\r\n}\r\n\r\n// Scheduled task instance class\r\nclass Task {\r\n  constructor(public config: TaskConfig, public job?: IScheduleJob) {}\r\n}\r\n\r\nclass InstanceControlSubsystem {\r\n  public readonly taskMap = new Map<string, Array<Task>>();\r\n  public readonly taskJobMap = new Map<string, schedule.Job>();\r\n\r\n  constructor() {\r\n    // Initialize all persistent data and load into memory one by one\r\n    StorageSubsystem.list(\"TaskConfig\").forEach((uuid) => {\r\n      const config = StorageSubsystem.load(\"TaskConfig\", TaskConfig, uuid) as TaskConfig;\r\n      try {\r\n        this.registerScheduleJob(config, false);\r\n      } catch (error: any) {\r\n        // Some scheduled tasks may be left, but the upper limit will not change\r\n        // Ignore the scheduled task registration at startup\r\n      }\r\n    });\r\n  }\r\n\r\n  public registerScheduleJob(task: IScheduleTask, needStore = true) {\r\n    const key = `${task.instanceUuid}`;\r\n    if (!this.taskMap.has(key)) {\r\n      this.taskMap.set(key, []);\r\n    }\r\n    const registeredTask = this.taskMap.get(key);\r\n    if (registeredTask && registeredTask?.length >= 8)\r\n      throw new Error($t(\"TXT_CODE_system_instance_control.execLimit\"));\r\n    if (!this.checkTask(key, task.name))\r\n      throw new Error($t(\"TXT_CODE_system_instance_control.existRepeatTask\"));\r\n    if (!FileManager.checkFileName(task.name))\r\n      throw new Error($t(\"TXT_CODE_system_instance_control.illegalName\"));\r\n    if (needStore)\r\n      logger.info(\r\n        $t(\"TXT_CODE_system_instance_control.crateTask\", {\r\n          name: task.name,\r\n          task: JSON.stringify(task)\r\n        })\r\n      );\r\n\r\n    let job: IScheduleJob;\r\n\r\n    // min interval check\r\n    if (task.type === 1) {\r\n      let internalTime = Number(task.time);\r\n      if (isNaN(internalTime) || internalTime < 1) internalTime = 1;\r\n\r\n      // task.type=1: Time interval scheduled task, implemented with built-in timer\r\n      job = new IntervalJob(() => {\r\n        this.action(task);\r\n        if (task.count === -1) return;\r\n        if (task.count === 1) {\r\n          job.cancel();\r\n          this.deleteTask(key, task.name);\r\n        } else {\r\n          task.count--;\r\n          this.updateTaskConfig(key, task.name, task);\r\n        }\r\n      }, internalTime);\r\n    } else {\r\n      // Expression validity check: 8 19 14 * * 1,2,3,4\r\n      const timeArray = task.time.split(\" \");\r\n      const checkIndex = [0, 1, 2];\r\n      checkIndex.forEach((item) => {\r\n        if (isNaN(Number(timeArray[item])) && Number(timeArray[item]) >= 0) {\r\n          throw new Error(\r\n            $t(\"TXT_CODE_system_instance_control.crateTaskErr\", {\r\n              name: task.name,\r\n              timeArray: timeArray\r\n            })\r\n          );\r\n        }\r\n      });\r\n      // task.type=2: Specify time-based scheduled tasks, implemented by node-schedule library\r\n      job = schedule.scheduleJob(task.time, () => {\r\n        this.action(task);\r\n        if (task.count === -1) return;\r\n        if (task.count === 1) {\r\n          job.cancel();\r\n          this.deleteTask(key, task.name);\r\n        } else {\r\n          task.count--;\r\n          this.updateTaskConfig(key, task.name, task);\r\n        }\r\n      });\r\n    }\r\n    const newTask = new Task(task, job);\r\n    this.taskMap.get(key)?.push(newTask);\r\n    if (needStore) {\r\n      StorageSubsystem.store(\"TaskConfig\", `${key}_${newTask.config.name}`, newTask.config);\r\n    }\r\n    if (needStore)\r\n      logger.info($t(\"TXT_CODE_system_instance_control.crateSuccess\", { name: task.name }));\r\n  }\r\n\r\n  public listScheduleJob(instanceUuid: string) {\r\n    const key = `${instanceUuid}`;\r\n    const arr = this.taskMap.get(key) || [];\r\n    const res: IScheduleTask[] = [];\r\n    arr.forEach((v) => {\r\n      res.push(v.config);\r\n    });\r\n    return res;\r\n  }\r\n\r\n  public async action(task: IScheduleTask) {\r\n    try {\r\n      const payload = task.payload;\r\n      const instanceUuid = task.instanceUuid;\r\n      const instance = InstanceSubsystem.getInstance(instanceUuid);\r\n      // If the instance has been deleted, it needs to be automatically destroyed\r\n      if (!instance) {\r\n        return this.deleteScheduleTask(task.instanceUuid, task.name);\r\n      }\r\n      const instanceStatus = instance.status();\r\n      // logger.info(`Execute scheduled task: ${task.name} ${task.action} ${task.time} ${task.count} `);\r\n      if (task.action === \"start\") {\r\n        if (instanceStatus === 0) {\r\n          return await instance.exec(new StartCommand(\"ScheduleJob\"));\r\n        }\r\n      }\r\n      if (task.action === \"stop\") {\r\n        if (instanceStatus === 3) {\r\n          return await instance.exec(new StopCommand());\r\n        }\r\n      }\r\n      if (task.action === \"restart\") {\r\n        if (instanceStatus === 3) {\r\n          return await instance.exec(new RestartCommand());\r\n        }\r\n      }\r\n      if (task.action === \"command\") {\r\n        if (instanceStatus === 3) {\r\n          return await instance.exec(new SendCommand(payload));\r\n        }\r\n      }\r\n      if (task.action === \"kill\") {\r\n        return await instance.exec(new KillCommand());\r\n      }\r\n    } catch (error: any) {\r\n      logger.error(\r\n        $t(\"TXT_CODE_system_instance_control.execCmdErr\", {\r\n          uuid: task.instanceUuid,\r\n          name: task.name,\r\n          error: error\r\n        })\r\n      );\r\n    }\r\n  }\r\n\r\n  public deleteInstanceAllTask(instanceUuid: string) {\r\n    const tasks = this.listScheduleJob(instanceUuid);\r\n    if (tasks)\r\n      tasks.forEach((v) => {\r\n        this.deleteScheduleTask(instanceUuid, v.name);\r\n      });\r\n  }\r\n\r\n  public deleteScheduleTask(instanceUuid: string, name: string) {\r\n    const key = `${instanceUuid}`;\r\n    this.deleteTask(key, name);\r\n  }\r\n\r\n  private deleteTask(key: string, name: string) {\r\n    this.taskMap.get(key)?.forEach((v, index, arr) => {\r\n      if (v?.config?.name === name) {\r\n        v?.job?.cancel();\r\n        arr.splice(index, 1);\r\n      }\r\n    });\r\n    StorageSubsystem.delete(\"TaskConfig\", `${key}_${name}`);\r\n  }\r\n\r\n  private checkTask(key: string, name: string) {\r\n    let f = true;\r\n    this.taskMap?.get(key)?.forEach((v, index, arr) => {\r\n      if (v.config.name === name) f = false;\r\n    });\r\n    return f;\r\n  }\r\n\r\n  private updateTaskConfig(key: string, name: string, data: IScheduleTask) {\r\n    const list = this.taskMap.get(key);\r\n    for (const index in list) {\r\n      const t = list[index as any];\r\n      if (t.config.name === name) {\r\n        list[index as any].config = data;\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  private checkScheduledTaskLimit(instanceUuid: string) {\r\n    for (const iterator of this.taskMap) {\r\n    }\r\n  }\r\n}\r\n\r\nexport default new InstanceControlSubsystem();\r\n","import { systemInfo } from \"common\";\r\n\r\n// Visual data subsystem: responsible for collecting system data and event data, and providing some methods to display them\r\nclass LineQueue<T> {\r\n  private readonly arr = new Array<T>();\r\n\r\n  constructor(public readonly maxSize: number, defaultValue: T) {\r\n    for (let index = 0; index < maxSize; index++) {\r\n      this.arr.push(defaultValue);\r\n    }\r\n  }\r\n\r\n  push(data: T) {\r\n    if (this.arr.length < this.maxSize) {\r\n      this.arr.push(data);\r\n    } else {\r\n      this.arr.shift();\r\n      this.arr.push(data);\r\n    }\r\n  }\r\n\r\n  getArray() {\r\n    return this.arr;\r\n  }\r\n}\r\n\r\ninterface ISystemChartInfo {\r\n  cpu: number;\r\n  mem: number;\r\n}\r\n\r\nclass VisualDataSubsystem {\r\n  public readonly countMap: Map<string, number> = new Map<string, number>();\r\n\r\n  public readonly systemChart = new LineQueue<ISystemChartInfo>(200, { cpu: 0, mem: 0 });\r\n\r\n  private requestCount = 0;\r\n\r\n  constructor() {\r\n    setInterval(() => {\r\n      const info = systemInfo();\r\n      if (info) {\r\n        this.systemChart.push({\r\n          cpu: Number((info.cpuUsage * 100).toFixed(0)),\r\n          mem: Number((info.memUsage * 100).toFixed(0))\r\n        });\r\n      } else {\r\n        this.systemChart.push({\r\n          cpu: 0,\r\n          mem: 0\r\n        });\r\n      }\r\n    }, 1000 * 3);\r\n  }\r\n\r\n  addRequestCount() {\r\n    this.requestCount++;\r\n  }\r\n\r\n  getSystemChartArray() {\r\n    return this.systemChart.getArray();\r\n  }\r\n\r\n  // Trigger counting event\r\n  emitCountEvent(eventName: string) {\r\n    const v = this.countMap.get(eventName);\r\n    if (v) {\r\n      this.countMap.set(eventName, v + 1);\r\n    } else {\r\n      this.countMap.set(eventName, 1);\r\n    }\r\n  }\r\n\r\n  // Trigger counting event\r\n  eventCount(eventName: string) {\r\n    return this.countMap.get(eventName);\r\n  }\r\n\r\n  // Trigger log event\r\n  emitLogEvent(eventName: string, source: any) {\r\n    const time = new Date().toLocaleString();\r\n  }\r\n}\r\n\r\nexport default new VisualDataSubsystem();\r\n","import { $t } from \"../i18n\";\r\nimport * as fs from \"fs-extra\";\r\nimport { GlobalVariable } from \"common\";\r\nimport logger from \"./log\";\r\n\r\nconst PACKAGE_JSON = \"package.json\";\r\n\r\nexport function initVersionManager() {\r\n  try {\r\n    GlobalVariable.set(\"version\", \"Unknown\");\r\n    if (fs.existsSync(PACKAGE_JSON)) {\r\n      const data: any = JSON.parse(fs.readFileSync(PACKAGE_JSON, { encoding: \"utf-8\" }));\r\n      if (data.version) {\r\n        GlobalVariable.set(\"version\", data.version);\r\n      }\r\n    }\r\n  } catch (error: any) {\r\n    logger.error($t(\"TXT_CODE_version.versionDetectErr\"), error);\r\n  }\r\n}\r\n\r\nexport function getVersion() {\r\n  return GlobalVariable.get(\"version\", \"Unknown\");\r\n}\r\n","import StorageSubsystem from \"../common/system_storage\";\r\nimport logger from \"./log\";\r\nimport { t } from \"i18next\";\r\n\r\nfunction readCategoryConfig(configCategory: string, callback: (config: any) => boolean) {\r\n  const configPaths = StorageSubsystem.readDir(configCategory);\r\n  for (const configPath of configPaths) {\r\n    try {\r\n      const config = JSON.parse(StorageSubsystem.readFile(configPath));\r\n      if (callback(config)) {\r\n        logger.info(t(\"TXT_CODE_6b2a9cab\"), configPath);\r\n        StorageSubsystem.writeFile(configPath, JSON.stringify(config, null, 4));\r\n      }\r\n    } catch (error: any) {\r\n      logger.error(t(\"TXT_CODE_fb75aba9\"), error);\r\n    }\r\n  }\r\n}\r\n\r\nfunction refactorInstanceConfig(config: any) {\r\n  if (typeof config.endTime === \"string\") {\r\n    config.endTime = new Date(config.endTime).getTime();\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction detectConfig() {\r\n  readCategoryConfig(\"InstanceConfig\", refactorInstanceConfig);\r\n}\r\n\r\nexport default { detectConfig };\r\n","import formidable from \"formidable\";\r\nimport fs from \"fs-extra\";\r\n\r\nexport function checkFileName(fileName: string) {\r\n  const blackKeys = [\"/\", \"\\\\\", \"|\", \"?\", \"*\", \">\", \"<\", \";\", '\"'];\r\n  for (const ch of blackKeys) {\r\n    if (fileName.includes(ch)) return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nexport function clearUploadFiles(file?: formidable.File | formidable.File[]) {\r\n  if (!file) return;\r\n  if (file instanceof Array) {\r\n    file.forEach((v) => {\r\n      fs.remove(v.filepath, () => {});\r\n    });\r\n  } else {\r\n    fs.remove(file.filepath, () => {});\r\n  }\r\n}\r\n","module.exports = require(\"@iarna/toml\");","module.exports = require(\"@koa/router\");","module.exports = require(\"axios\");","module.exports = require(\"dockerode\");","module.exports = require(\"events\");","module.exports = require(\"fs-extra\");","module.exports = require(\"i18next\");","module.exports = require(\"iconv-lite\");","module.exports = require(\"koa\");","module.exports = require(\"koa-body-patch\");","module.exports = require(\"koa-send\");","module.exports = require(\"log4js\");","module.exports = require(\"module-alias/register\");","module.exports = require(\"node-disk-info\");","module.exports = require(\"node-schedule\");","module.exports = require(\"os-utils\");","module.exports = require(\"pidusage\");","module.exports = require(\"properties\");","module.exports = require(\"rcon-srcds\");","module.exports = require(\"socket.io\");","module.exports = require(\"uuid\");","module.exports = require(\"yaml\");","module.exports = require(\"child_process\");","module.exports = require(\"fs\");","module.exports = require(\"http\");","module.exports = require(\"net\");","module.exports = require(\"os\");","module.exports = require(\"path\");","module.exports = require(\"readline\");","module.exports = require(\"stream\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/app.ts\");\n",""],"names":[],"sourceRoot":""}